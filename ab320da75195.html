<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>从0搭建一个Vue3+Ts+Pinia+Vue-Router+Eslint+Prettier项目</title>
    <script type="module" crossorigin="" src="/assets/app-I7hi7fN_.js"></script>
    <link rel="stylesheet" crossorigin="" href="/assets/app-wnGglYIs.css">
  <link rel="modulepreload" crossorigin="" href="/assets/从0搭建一个Vue3-Ts-Pinia-Vue-Router-Eslint-Prettier项目-C10IA-Ye.js"><meta property="og:title" content="从0搭建一个Vue3+Ts+Pinia+Vue-Router+Eslint+Prettier项目"><meta name="twitter:title" content="从0搭建一个Vue3+Ts+Pinia+Vue-Router+Eslint+Prettier项目"></head>
  <body>
    <div id="app" data-server-rendered="true"><div class="mujika" min-h="100vh" flex="~ col" bg="[--mygo-c-bg-alt]"><header class="mujika-header" flex="~ shrink-0" px-4="" h="70px" bg="[var(--mygo-c-bg)]" items-center="" justify-between="" data-v-c1947e25=""><a href="/" class="" flex="" gap-4="" items-center="" data-v-c1947e25=""><img w="40px" aspect-ratio-square="" src="/logo.svg" alt="恋の歌的logo" data-v-c1947e25=""></a><div data-v-c1947e25=""><div p-1="" flex="" gap-1="" rounded="6px" bg="[var(--mygo-c-bg-alt)]" data-v-c1947e25=""><!--[--><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="bg-[var(--mygo-c-bg)]" title="自动" data-v-c1947e25=""><!--[-->Auto<!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="日间" data-v-c1947e25=""><!--[--><i class="i-ri:sun-line" data-v-c1947e25=""></i><!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="夜间" data-v-c1947e25=""><!--[--><i class="i-ri:moon-line" data-v-c1947e25=""></i><!--]--></div><!--]--></div></div></header><main class="mujika-home" flex="grow" mx="auto" min-h="0" p-2="" w-full="" un-2xl:w="[calc(96rem-var(--spacing)*2)]"><div flex="" gap-2="" items-start=""><div flex="~ col grow" gap-2="" min-w-0=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="~ col" mb-4="" gap-4=""><h1 break-all="" text="34px center">从0搭建一个Vue3+Ts+Pinia+Vue-Router+Eslint+Prettier项目</h1></div><div flex="~ col" gap-3="" text="[var(--mygo-c-text-2)]"><div flex="~ wrap" gap-3="" justify-center=""><!----><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar"></i><span un-hidden="" lg:inline="">发表于</span><span pl-1="">2022-08-20 15:09</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar-check"></i><span un-hidden="" lg:inline="">更新于</span><span pl-1="">2023-02-13 18:28</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:folder"></i><span un-hidden="" lg:inline="">分类于</span><!--[--><a pl-1="" href="/category/编程">编程</a><!--]--></div></div><div flex="~ wrap" gap-3="" justify-center=""><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:file-word"></i><span un-hidden="" lg:inline="">总字数</span><span pl-1="">3.3K</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:clock"></i><span un-hidden="" lg:inline="">阅读时长 ≈</span><span pl-1="">12 分钟</span></div></div></div><div class="mujika-doc-content"><!--[--><div class="kan-doc"><h1 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言">🔗</a></h1><p>感觉许久没发帖子了，最近使用了 <code>Vue3 + Ts</code> 来写公司的一个项目</p><p>正好记录一下这个过程，方便以后没搞懂可以回过头来查看，毕竟我这记忆力，离老年痴呆应该是不远了😂</p><h1 id="正文" tabindex="-1">正文 <a class="header-anchor" href="#正文">🔗</a></h1><p>最先开始，我们直接使用 <code>Vite</code> 脚手架创建一个 <code>Vue3 + Ts</code> 的项目</p><p>然后我们在这个项目上进行添砖加瓦</p><h2 id="创建-vue3-ts-项目" tabindex="-1">创建 Vue3 + Ts 项目 <a class="header-anchor" href="#创建-vue3-ts-项目">🔗</a></h2><p><code>Vite</code> 文档地址 <a href="https://vitejs.dev/guide/#scaffolding-your-first-vite-project" target="_blank" rel="noopener">Scaffolding Your First Vite Project</a></p><p>这里由于我们使用的是 <code>pnpm</code> 包管理工具，所以执行 <code>pnpm create vite</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201629891.avif" alt=""></p><p>输入项目名，选择 <code>vue</code> 和 <code>vue-ts</code> 即可，然后我们就成功创建了一个最简单的 <code>Vue3 + Ts</code> 的项目</p><p>然后我们进入项目执行 <code>pnpm i</code> 安装依赖</p><p>到这一步还是相当简单的，我们可以查看下项目的结构</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201805116.avif" alt=""></p><h2 id="引入-pinia-和-vue-router" tabindex="-1">引入 Pinia 和 Vue-Router <a class="header-anchor" href="#引入-pinia-和-vue-router">🔗</a></h2><p><code>Pinia</code> 作为 <code>Vue3</code> 官方的全局状态管理库，使用上更加方便，对比 <code>Vuex</code> 来说拥有更好的类型推断，以及简单的 <code>Api</code> 导出</p><p><code>Vue-Router 4</code> 是 <code>Vue3</code> 官方的路由库，相对于 <code>React</code> 的许许多多的路由实现，<code>Vue</code> 的选择就只有 <code>Vue-Router</code> ，毕竟是官方的，遇到问题也容易找到解决办法</p><p>安装 <code>Vue-Router</code> 很简单，直接执行 <code>pnpm add vue-router</code> 即可， 安装 <code>Pinia</code> 只需执行 <code>pnpm add pinia</code></p><p>然后我们需要把它安装到 <code>Vue</code> 上</p><p>默认情况下的 <code>main.ts</code> 长下面这样</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201807808.avif" alt=""></p><p>这时候我们需要先修改下目录结构，增加 <code>router</code> 和 <code>store</code> 两个文件夹</p><p>并且分别在这两个文件夹下面建一个 <code>index.ts</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201809932.avif" alt=""></p><p>之后我们来编写 <code>store</code> 下面的 <code>index.ts</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201811983.avif" alt=""></p><p>接着我们编写 <code>router</code> 下面的 <code>index.ts</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201814942.avif" alt=""></p><p>然后我们修改下 <code>main.ts</code> 的代码</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201819421.avif" alt=""></p><p>然后我们可以执行 <code>pnpm run dev</code> 看一下</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201821765.avif" alt=""></p><p>这时候我们发现 <code>Vue-Router</code> 报了一个警告，意思就是没有设置 <code>/</code> 对应的路由</p><p>我们可以把默认的 <code>HelloWorld</code> 组件作为路由映射出去</p><p>先修改 <code>App.vue</code> ，使用 <code>RouterView</code> 来定义一个路由入口</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201824307.avif" alt=""></p><p>然后我们添加一个路由</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201825324.avif" alt=""></p><p>这样子这个警告就会消失了，当然，这只是为了演示如何设置路由而已，实际情况下可能会比较复杂</p><p><code>Vue-Router</code> 使用起来和在 <code>Vue2</code> 其实差不多，基本上是一模一样</p><p>这里写下 <code>Pinia</code> 的使用</p><p>对于很多的网站，我们都是要记录登录状态和当前登录用户的信息的，这个就可以用中心状态管理来做</p><p>我们新建一个 <code>useLoginStore.ts</code> （这里写的代码有点长，就不截图了…</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> defineStore</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">pinia</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> computed</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> reactive</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> toRefs</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">vue</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">useLoginStore</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> defineStore</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">LoginStore</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#666666;--s-light:#999999;"> ()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">state</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> reactive</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;{</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    loginUser</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Record</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">, </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">any</span><span style="--s-dark:#666666;--s-light:#999999;">&gt; | </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">null</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }&gt;({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    loginUser</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">null</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">isLogin</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> computed</span><span style="--s-dark:#666666;--s-light:#999999;">(()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> state</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">loginUser</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> !== null</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  const </span><span style="--s-dark:#80A665;--s-light:#59873A;">loginAction</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> async </span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // 这里是模拟登录</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">res</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> await</span><span style="--s-dark:#B8A965;--s-light:#998418;"> Promise</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">resolve</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">lwf</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      email</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">xxx@qq.com</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    });</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    state</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">loginUser</span><span style="--s-dark:#666666;--s-light:#999999;"> = {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">res</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      email</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">res</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">email</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">  return</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    ...</span><span style="--s-dark:#80A665;--s-light:#59873A;">toRefs</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">state</span><span style="--s-dark:#666666;--s-light:#999999;">),</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    isLogin</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    loginAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> default</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> useLoginStore</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span></code></pre><p>虽然 <code>Pinia</code> 也可以写成和 <code>Vuex</code> 一样，但是我觉得还是不够优雅，我还是更喜欢这种 <code>setup</code> 写法，没有 <code>this</code> 干扰</p><p>然后我们可以写个简答的登录页，新建一个 <code>Login.vue</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-html"><span class="line"><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">script</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> setup</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> lang</span><span style="--s-dark:#666666;--s-light:#999999;">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">ts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> reactive</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">vue</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> useLoginStore</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">./store/useLoginStore</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> loginStore</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> useLoginStore</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> model</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> reactive</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  username</span><span style="--s-dark:#666666;--s-light:#999999;">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> ""</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  password</span><span style="--s-dark:#666666;--s-light:#999999;">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> ""</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const</span><span style="--s-dark:#80A665;--s-light:#59873A;"> login</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#666666;--s-light:#999999;"> ()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">  try</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    loginStore</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">loginAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">model</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> model</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">password</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> catch</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // 处理错误</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">};</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">&lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">script</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">template</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">div</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">是否登录: {{ loginStore.isLogin }}</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">div</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">input</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> type</span><span style="--s-dark:#666666;--s-light:#999999;">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">text</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> v-model</span><span style="--s-dark:#666666;--s-light:#999999;">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">model.username</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;"> /&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">br</span><span style="--s-dark:#666666;--s-light:#999999;"> /&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">input</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> type</span><span style="--s-dark:#666666;--s-light:#999999;">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">text</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> v-model</span><span style="--s-dark:#666666;--s-light:#999999;">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">model.password</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;"> /&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">br</span><span style="--s-dark:#666666;--s-light:#999999;"> /&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  &lt;</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">button</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> @click</span><span style="--s-dark:#666666;--s-light:#999999;">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">login</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">登录</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">button</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">&lt;/</span><span style="--s-dark:#4D9375;--s-light:#1E754F;">template</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span></span></code></pre><p>注册到路由中</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201839187.avif" alt=""></p><p>打开 <code>http://localhost:5173/login</code> 就可以看到效果</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201840206.avif" alt=""></p><p>当然这里不写账号密码是没问题的，只是用来做个例子，随便输入然后点击登录，<code>isLogin</code> 为 <code>true</code> 了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201845768.avif" alt=""></p><p>我们可以用 <code>dev-tools</code> 来查看 <code>Pinia</code> 的状态</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201847042.avif" alt=""></p><h2 id="引入-naive-ui-组件库" tabindex="-1">引入 Naive-UI 组件库 <a class="header-anchor" href="#引入-naive-ui-组件库">🔗</a></h2><p>一般而言做一些 <code>ToB</code> 的系统，基本上都不会有 <code>UI</code> 图的，要求的就是一个成型快，所以需要一个组件库来帮助我们开发</p><p>我个人还是比较喜欢 <code>Naive-UI</code> 这个组件库的，<code>Ant-Design</code> 和 <code>Element-UI</code> 其实也不错，看个人喜好吧</p><p>这里我们直接使用 <code>pnpm add naive-ui</code> 安装</p><p><code>Naive-UI</code> 默认就支持 <code>tree-shaking</code> ，所以我们只需要在需要用到的时候引入相应组件即可</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201901501.avif" alt=""></p><p>这里我们引入一个 <code>Button</code> 组件，刷新页面就可以看到效果了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208201902324.avif" alt=""></p><h2 id="引入-unplugin-auto-import-和-unplugin-vue-components" tabindex="-1">引入 unplugin-auto-import 和 unplugin-vue-components <a class="header-anchor" href="#引入-unplugin-auto-import-和-unplugin-vue-components">🔗</a></h2><p>每次我们写页面很多时候都需要引入 <code>reactive</code>, <code>ref</code>, <code>watchEffect</code> 等函数，一旦还引用了其他的资源</p><p>那么 <code>&lt;script setup&gt;</code> 部分看起来就会比较乱，一坨的 <code>import { } from vue</code></p><p>为了解决这个问题，大神 <code>antfd</code> 开发了 <code>unplugin-auto-import</code> 的插件，支持 <code>vite</code>, <code>rollup</code>, <code>webpack</code>，非常的牛逼</p><p>使用这个插件，我们就不用写重复的 <code>import</code> 语句了</p><p>使用 <code>pnpm add unplugin-auto-import -D</code> 安装</p><p>然后修改 <code>vite.config.ts</code> 文件</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202123317.avif" alt=""></p><p>注意，这里我们主要配置两个属性，一个是 <code>imports</code> ，一个是 <code>dts</code></p><p><code>imports</code> 用来表明我们需要全局注册的 <code>import</code> 语句</p><p>我们可以点进去看 <code>imports</code> 的类型，支持的自动导入是非常多的</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">declare const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">presets</span><span style="--s-dark:#666666;--s-light:#999999;">: {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">    ahooks</span><span style="--s-dark:#666666;--s-light:#999999;">: () =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@nuxtjs/composition-api</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@vue/composition-api</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@vueuse/core</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: () =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@vueuse/math</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: () =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@vueuse/head</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    mobx</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">mobx-react-lite</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    pinia</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    preact</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    quasar</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    react</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">react-router</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">react-router-dom</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">react-i18next</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    svelte</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">svelte/animate</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">svelte/easing</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">svelte/motion</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">svelte/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">svelte/transition</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">vee-validate</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    vitepress</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">vue-demi</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">vue-i18n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">vue-router</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    vue</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">vue/macros</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    vuex</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    vitest</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">uni-app</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">solid-js</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@solidjs/router</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">solid-app-router</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    jotai</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    '</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">jotai/utils</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">'</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    recoil</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">ImportsMap</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">};</span></span></code></pre><p>这样子我们使用相关的 <code>api</code> 了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202134868.avif" alt=""></p><p>导出的 <code>api</code> 列表我们可以查看 <code>src/auto-import.d.ts</code></p><p>当然，由于我们使用的是 <code>TypeScript</code> ，所以不报错的功劳是这个 <code>src/auto-import.d.ts</code> 文件</p><p>默认情况下是有生成 <code>d.ts</code> 文件的，但是不是在 <code>src</code> 目录下，这会导致一个问题</p><p>因为 <code>tsconfig.json</code> 并没有识别这个 <code>d.ts</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202150886.avif" alt=""></p><p>当然你也可以不设置 <code>dts</code> 属性，然后把 <code>auto-import.d.ts</code> 加入到 <code>tsconfig.json</code> 的 <code>includes</code> 属性中</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-json5"><span class="line"><span style="--s-dark:#666666;--s-light:#999999;">{</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">  "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">include</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">:</span><span style="--s-dark:#666666;--s-light:#999999;"> [</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">auto-import.d.ts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">src/**/*.ts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">src/**/*.d.ts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">src/**/*.tsx</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">src/**/*.vue</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">"</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  ]</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>这样也可以顺利识别了</p><p>同样，由于我们使用组件库，每个页面也需要引入很多的组件库组件，一旦引入很多代码看起来也会很杂</p><p>所以大神又开发了 <code>unplugin-vue-components</code> 插件，它能够全局导出组件库组件，而且是支持 tree-shaking 的</p><p>使用 <code>pnpm add unplugin-vue-components -D</code> 安装</p><p>然后继续修改 <code>vite.config.ts</code> 文件</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202200338.avif" alt=""></p><p>这里配置了 <code>resolvers</code> 和 <code>dts</code> ，<code>dts</code> 的作用和上个插件一样</p><p><code>resolvers</code> 配置了需要自动导入的组件库，这里我们使用了 <code>Naive-UI</code> ，所以使用 <code>NaiveUiResolver</code> ，主流的 <code>UI</code> 都能支持，比如 <code>Ant Design</code> ， <code>Element-UI</code> 等</p><p>默认情况下啊，他还会把 <code>src/components</code> 下的组件也设为自动导入</p><p>可以打开 <code>src/components.d.ts</code> 文件查看，发现 <code>HelloWorld</code> 和 <code>NButton</code> 已经被注册了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202209676.avif" alt=""></p><p>tips：如果你使用的是 <code>pnpm</code> ，那么此时会出现一个问题，虽然已经有 <code>d.ts</code> 文件了，但是 <code>vue</code> 文件并没有类型提示</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202212376.avif" alt=""></p><p>这是由于生成的 <code>d.ts</code> 是在 <code>@vue/runtime-core</code> 模块下的，但是 <code>pnpm</code> 并不会存在幻影依赖，在 <code>node_modules</code> 下不会扁平依赖</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202220068.avif" alt=""></p><p>所以该 <code>d.ts</code> 就无效了，可以把 <code>@vue/runtime-core</code> 改成 <code>vue</code> 这时候你会发现提示就有了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202217226.avif" alt=""></p><p>但是由于这个文件是自动生成的，如果有新的组件需要生成定义，那么又会被插件改成 <code>@vue/runtime-core</code></p><p>这时候我们就要用 <code>.npmrc</code> 来告诉 <code>pnpm</code> 把 <code>@vue/runtime-core</code> 提升到 <code>node_modules</code> 目录下</p><p>我们在项目根目录下建一个 <code>.npmrc</code> 文件</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-text"><span class="line"><span># 修复 pnpm 安装无法获得提示问题</span></span>
<span class="line"><span># issue https://github.com/antfu/unplugin-vue-components/issues/406</span></span>
<span class="line"><span># 提升 @vue/runtime-core 这个依赖到 node_modules 下</span></span>
<span class="line"><span>public-hoist-pattern[]=@vue/runtime-core</span></span></code></pre><p>然后我们重新运行 <code>pnpm i</code> ，这时候 <code>@vue/runtime-core</code> 就在 <code>node_modules</code> 下了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202224824.avif" alt=""></p><p>这时候就可以正确的识别类型了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202226833.avif" alt=""></p><h2 id="引入-axios" tabindex="-1">引入 Axios <a class="header-anchor" href="#引入-axios">🔗</a></h2><p>基本上创建项目都需要 <code>Axios</code> 来作为 <code>http</code> 请求库</p><p>当然，如果是单纯的引入其实不难，这里主要是写一下我的封装</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211439914.avif" alt=""></p><p>这里的 <code>baseURL</code> 参数主要看后端接口，像我司不搞跨域配置的，就需要我在 <code>Vite</code> 中开启一个 <code>proxy</code> 来代理接口，然后对 <code>api</code> 进行转发</p><p>拦截器主要是返回实体数据，不然每次都要 <code>res.data.data</code> 来取数据还是比较麻烦的，以及处理错误请求等</p><p>这个要根据具体情况来配置，当然，对于 <code>TypeScript</code> ，我们自然希望能够有完整的类型提示</p><p>所以我们可以封装下四个方法，这里以 <code>get</code> 举例</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211447228.avif" alt=""></p><p>然后我们可以写对应的 <code>api</code> ，比如获取用户列表</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211453695.avif" alt=""></p><p>这样子引入 <code>getUserListApi</code> 这个 <code>api</code> 执行就能有完整的类型提示了</p><p>请求参数</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211454343.avif" alt=""></p><p>返回结果</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211454751.avif" alt=""></p><h2 id="引入-eslint-和-prettier-和-editorconfig" tabindex="-1">引入 Eslint 和 Prettier 和 EditorConfig <a class="header-anchor" href="#引入-eslint-和-prettier-和-editorconfig">🔗</a></h2><p>前面的配置基本上都是功能类的，现在我们需要配置 <code>Eslint</code> 和 <code>Prettier</code> 来保证代码格式和代码质量</p><p>代码格式和代码质量是相当重要的，因为我看过公司之前的项目，那个代码看的我真的是头皮发麻，感到不适</p><p>但是没办法，该往上加功能还是要加的…</p><p>执行 <code>pnpm add eslint prettier -D</code> 安装这两个库</p><p><code>prettier</code> 使用默认配置即可，这里主要是配置 <code>eslint</code></p><p>创建 <code>.eslintrc.json</code> 和 <code>.eslintignore</code> 两个文件</p><p>其中 <code>.eslintignore</code> 要排除 <code>node_modules</code> 以及 <code>src/auto-import.d.ts</code> 和 <code>src/component.d.ts</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202258323.avif" alt=""></p><p>因为 <code>prettier</code> 默认情况下使用双引号的，而这两个 <code>d.ts</code> 都是用单引号的，所以我们避免去格式化这几个文件</p><p>在<a href="https://staging-cn.vuejs.org/guide/scaling-up/tooling.html#linting" target="_blank" rel="noopener">官方文档</a>中，提示我们可以使用 <code>eslint-plugin-vue</code> 这个插件，所以我们安装上它，然后配置 <code>.eslintrc.json</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202325146.avif" alt=""></p><p>接着我们可以执行 <code>eslint src/App.vue</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202326089.avif" alt=""></p><p>可以看到 <code>eslint</code> 正确地提示了问题</p><p>我们用 <code>prettier</code> 格式化 <code>App.vue</code> ，但是问题并没有消失，这是因为 <code>eslint</code> 的规则和 <code>prettier</code> 冲突了</p><p>所以我们需要解决 <code>eslint</code> 和 <code>prettier</code> 的冲突</p><p>安装 <code>eslint-config-prettier</code> ，这个配置能够让关掉 <code>eslint</code> 中和 <code>prettier</code> 冲突的规则，修改配置文件如下：</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202348980.avif" alt=""></p><p>这时候我们执行 <code>eslint src/App.vue</code> 就不会提示错误了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202349083.avif" alt=""></p><p>冲突解决之后，还有一个问题，就是 <code>eslint</code> 它不报 <code>prettier</code> 的错误</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202354833.avif" alt=""></p><p>这里我们使用了单引号，但是 <code>eslint</code> 没报错，接下来，我们就需要让 <code>eslint</code> 在格式不符合 <code>prettier</code> 的情况下报相关的错误</p><p>安装 <code>eslint-plugin-prettier</code> ，修改配置文件如下</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202357309.avif" alt=""></p><p>现在 <code>eslint</code> 就能正确地报错了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/20/202208202359369.avif" alt=""></p><p>当然，我们可以直接把配置修改为如下，等价于上边配置的 <code>eslint-plugin-prettier</code> 和 <code>eslint-config-prettier</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208210004132.avif" alt=""></p><p>当然，<code>eslint-plugin-prettier</code> 使用了 <code>vue-eslint-parser</code> 来解析 <code>vue</code> 文件，对于其他文件，会使用默认的 <code>espree</code> 解析器来解析</p><p>如果想替换其他解析器，必须在 <code>parserOptions</code> 下设置 <code>parser</code> ，而不能在根下设置，不然 <code>vue-eslint-parser</code> 会失效，这里官方的文档也有说明</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211147398.avif" alt=""></p><p><code>VSCode</code> 安装 <code>Eslint</code> ， <code>Prettier</code> 插件</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211154467.avif" alt=""></p><p>然后我们打开 <code>settings.json</code> ，配置保存的时候自动使用 <code>eslint</code> 格式化</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211157649.avif" alt=""></p><p>最后我们通过 <code>.editorconfig</code> 文件来设置一些编辑器的规则</p><p>主要是为了防止不同的 <code>ide</code> 会有不同的设置，比如换行符号，从而影响编码</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211511516.avif" alt=""></p><h2 id="引入-husky-和-lint-staged" tabindex="-1">引入 husky 和 lint-staged <a class="header-anchor" href="#引入-husky-和-lint-staged">🔗</a></h2><p>虽然设置了代码格式化，但是很多时候项目并不是一个人在开发，是很多人协同合作</p><p>你不能要求别人每次提交代码之前都执行一次 <code>eslint</code> ，同时这对于自己来说也很麻烦</p><p>所以我们需要使用 <code>git</code> 的 <code>pre-commit</code> 钩子配合 <code>lint-staged</code> 来对暂存区的文件进行自动格式化</p><p>执行 <code>pnpm add husky lint-staged -D</code> 安装这两个依赖</p><p><code>husky</code> 需要该项目为 <code>git</code> 仓库，所以需要 <code>git init</code> 初始化，然后执行 <code>pnpx husky install</code> 开启钩子功能</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211211628.avif" alt=""></p><p>然后执行 <code>pnpx husky add .husky/pre-commit "pnpm run lint-staged"</code> 添加 <code>pre-commit</code> 钩子</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211216930.avif" alt=""></p><p>这里记得要在 <code>package.json</code> 中添加相应的 <code>script</code></p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211217161.avif" alt=""></p><p>然后我们在 <code>package.json</code> 中添加 <code>lint-staged</code> 的配置</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211222852.avif" alt=""></p><p>然后我们可以测试一下，我们修改下 <code>main.ts</code> 代码</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211230971.avif" alt=""></p><p><code>git add</code> 之后提交，可以看到自动格式化了</p><p><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/08/21/202208211233279.avif" alt=""></p><h1 id="后记" tabindex="-1">后记 <a class="header-anchor" href="#后记">🔗</a></h1><p>到此我们基本上就搭建了一个功能比较完备的项目了，当然，可操作的地方还有很多</p><p>比如 <code>git commit</code> 规范，打包前 <code>eslint</code> 检查，代码分割等</p><p>这些以后在慢慢写吧，不急，慢慢来，细水长流嘛</p><p>相关的仓库已经上传到我的 <code>git</code> 上了，有需要的直接拉下来删除 <code>.git</code> ，再初始化 <code>git</code> 即可作为一个不错的模板项目</p><p>仓库地址：<a href="https://github.com/Dedicatus546/vue3-ts-template" target="_blank" rel="noopener">Dedicatus546 / vue3-ts-template</a></p></div><!--]--></div><div flex="~ wrap" text="[var(--mygo-c-text-2)]" mt-8="" gap-4="" justify-center=""><!--[--><div>#Vue3</div><div>#Vite</div><div>#TypeScript</div><div>#Eslint</div><div>#Prettier</div><div>#Vue-Router</div><div>#Pinia</div><div>#husky</div><div>#lint-staged</div><!--]--></div><!--]--></div></div><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex=""><a href="/faf19ae1e3f6" class=""><i class="i-mi:chevron-left" mr-1=""></i><span>lint-staged 原理浅析</span></a><a href="/992fb248bc26" class="" ml-auto=""><span>2022年7月新番个人推荐</span><i class="i-mi:chevron-right" ml-1=""></i></a></div><!--]--></div></div><!--[--><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-eedc551d="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="" gap-4="" items-start="" data-v-eedc551d=""><div flex="~ shrink-0" bg="[var(--mygo-c-bg-alt)]" rounded-6px="" w-60px="" aspect-ratio-square="" items-center="" justify-center="" data-v-eedc551d=""><i text-40px="" text="[#999]" class="i-fa6-regular:user" data-v-eedc551d=""></i></div><div flex="~ col grow" gap-4="" data-v-eedc551d=""><textarea disabled="" placeholder="万水千山总是情，留下评论行不行" class="mujika-git-talk-textarea" un-disabled:cursor-not-allowed="" p-4="" outline-0="" data-v-eedc551d=""></textarea><div flex="" items-start="" justify-between="" data-v-eedc551d=""><a target="_blank" href="https://guides.github.com/features/mastering-markdown/" data-v-eedc551d=""> 支持 Markdown 语法 </a><button class="mujika-git-talk-button" cursor-pointer="" data-v-eedc551d=""> 点击登录 </button></div></div></div><!--]--></div></div><!----><!--]--></div><aside class="mujika-aside" w="280px" flex="~ col shrink-0" top-2="" sticky="" max-h="[calc(100vh-var(--spacing)*4)]" un-hidden="" lg:block=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" flex="~ col" gap-4="" data-v-7ac4adc5=""><!--[--><div p="4 b-0" flex-shrink-0="">文章目录</div><div p="4 t-0" flex-grow="" min-h-0="" overflow-y-auto=""><!----></div><!--]--></div></aside><!--teleport start--><!--teleport end--></div></main><footer class="mujika-footer" px-4="" py-6="" bg="[var(--mygo-c-bg)]" flex="~ col shrink-0" gap-2="" items-center="" data-v-d1d7a153=""><div flex="" items-center="" data-v-d1d7a153=""><span data-v-d1d7a153="">Power by&nbsp;</span><i class="i-logos:vue" data-v-d1d7a153=""></i><span data-v-d1d7a153="">&nbsp;+&nbsp;</span><i class="i-logos:vitejs" data-v-d1d7a153=""></i></div><div text-center="" data-v-d1d7a153=""><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-d1d7a153=""> CC BY-NC-SA 4.0 </a> 2021 - PRESENT © Dedicatus545 </div><div text="[var(--mygo-c-text-2)]" text-center="" data-v-d1d7a153=""> 如果我和狗一样有尾巴的话，一定会藏不住这份喜悦，而尾巴一直摇个不停吧。 </div></footer></div></div>
  

</body></html>