<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/logo.svg"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Vue Router è·¯ç”±è§£æåŸç†æµ…æ</title><script type="importmap">{"imports":{"vue":"https://esm.sh/vue","vue-router":"https://esm.sh/vue-router","pinia":"https://esm.sh/pinia","@vueuse/core":"https://esm.sh/@vueuse/core","@vueuse/components":"https://esm.sh/@vueuse/components","@vueuse/router":"https://esm.sh/@vueuse/router","date-fns":"https://esm.sh/date-fns","nprogress":"https://esm.sh/nprogress","octokit":"https://esm.sh/octokit","pinia-plugin-persistedstate":"https://esm.sh/pinia-plugin-persistedstate","vue-router-better-scroller":"https://esm.sh/vue-router-better-scroller"}}</script><script type="module" async="" crossorigin="" src="/assets/app-C4XuqRXg.js"></script><link rel="stylesheet" crossorigin="" href="/assets/app-DgCMeXmb.css"><link rel="modulepreload" crossorigin="" href="/assets/Vue-Router-è·¯ç”±è§£æåŸç†æµ…æ-CKUTqzCH.js"><meta property="og:title" content="Vue Router è·¯ç”±è§£æåŸç†æµ…æ"><meta name="twitter:title" content="Vue Router è·¯ç”±è§£æåŸç†æµ…æ"></head><body><div id="app" data-server-rendered="true"><div class="mujika" min-h="100vh" flex="~ col" bg="[--mygo-c-bg-alt]"><header class="mujika-header" flex="~ shrink-0" px-4="" h="70px" bg="[var(--mygo-c-bg)]" items-center="" justify-between="" data-v-c1947e25=""><a href="/" class="" flex="" gap-4="" items-center="" data-v-c1947e25=""><img w="40px" aspect-ratio-square="" src="/logo.svg" alt="æ‹ã®æ­Œçš„logo" data-v-c1947e25=""></a><div data-v-c1947e25=""><div p-1="" flex="" gap-1="" rounded="6px" bg="[var(--mygo-c-bg-alt)]" data-v-c1947e25=""><!--[--><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="bg-[var(--mygo-c-bg)]" title="è‡ªåŠ¨" data-v-c1947e25=""><!--[-->Auto<!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="æ—¥é—´" data-v-c1947e25=""><!--[--><i class="i-ri:sun-line" data-v-c1947e25=""></i><!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="å¤œé—´" data-v-c1947e25=""><!--[--><i class="i-ri:moon-line" data-v-c1947e25=""></i><!--]--></div><!--]--></div></div></header><main class="mujika-home" flex="grow" mx="auto" min-h="0" p-2="" w-full="" un-2xl:w="[calc(96rem-var(--spacing)*2)]"><div flex="" gap-2="" items-start=""><div flex="~ col grow" gap-2="" min-w-0=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="~ col" mb-4="" gap-4=""><h1 break-all="" text="34px center">Vue Router è·¯ç”±è§£æåŸç†æµ…æ</h1></div><div flex="~ col" gap-3="" text="[var(--mygo-c-text-2)]"><div flex="~ wrap" gap-3="" justify-center=""><!----><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar"></i><span un-hidden="" lg:inline="">å‘è¡¨äº</span><span pl-1="">2022-09-25 18:24</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar-check"></i><span un-hidden="" lg:inline="">æ›´æ–°äº</span><span pl-1="">2023-02-13 18:28</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:folder"></i><span un-hidden="" lg:inline="">åˆ†ç±»äº</span><!--[--><a pl-1="" href="/category/ç¼–ç¨‹">ç¼–ç¨‹</a><!--]--></div></div><div flex="~ wrap" gap-3="" justify-center=""><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:file-word"></i><span un-hidden="" lg:inline="">æ€»å­—æ•°</span><span pl-1="">3.9K</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:clock"></i><span un-hidden="" lg:inline="">é˜…è¯»æ—¶é•¿ â‰ˆ</span><span pl-1="">14 åˆ†é’Ÿ</span></div></div></div><div class="mujika-doc-content"><!--[--><div class="kan-doc"><h1 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€">ğŸ”—</a></h1><p>æœ€è¿‘è¢«é—®åˆ° <code>Vue Router</code> çš„è·¯ç”±åŒ¹é…çš„ä¸€äº›é—®é¢˜</p><p>æ‰€ä»¥è¿™æ¬¡å†™å†™åœ¨ <code>Vue Router@3</code> å’Œ <code>Vue Router@4</code> ä¸­çš„è·¯ç”±åŒ¹é…ç®—æ³•</p><h1 id="æ­£æ–‡" tabindex="-1">æ­£æ–‡ <a class="header-anchor" href="#æ­£æ–‡">ğŸ”—</a></h1><p><code>Vue Router</code> æ˜¯ <code>Vue</code> çš„å®˜æ–¹çš„è·¯ç”±åº“</p><p>å¯¹äº <code>Vue2</code> é…å¥—çš„ç‰ˆæœ¬æ˜¯ <code>Vue Router@3</code> ï¼Œè€Œ <code>Vue3</code> é…å¥—çš„ç‰ˆæœ¬åˆ™æ˜¯ <code>Vue Router@4</code></p><p>ä¸ç®¡æ˜¯å“ªä¸ªç‰ˆæœ¬ï¼Œ<code>Vue Router</code> å¯¹äºè·¯ç”±çš„è§£æçš„æœ¬è´¨éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯æŠŠ <code>path</code> å‚æ•°è§£ææˆä¸€ä¸ªæ­£åˆ™å¯¹è±¡</p><p>åœ¨ <code>Vue Router@3</code> ä¸­ï¼Œä½¿ç”¨äº† <code>path-to-regexp</code> è¿™ä¸ªåº“æ¥å°† <code>path</code> è½¬æˆ <code>regexp</code></p><p>è¿™ç‚¹æˆ‘ä»¬å¯ä»¥ä»å®˜æ–¹æ–‡æ¡£å¾—çŸ¥ <a href="https://v3.router.vuejs.org/zh/guide/essentials/dynamic-matching.html#%E9%AB%98%E7%BA%A7%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener">Vue Router@3 åŸºç¡€/åŠ¨æ€è·¯ç”±åŒ¹é…/é«˜çº§åŒ¹é…æ¨¡å¼</a></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/18/202209181114812.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/18/202209181114812.avif" alt=""></a></p><p>è€Œåœ¨ <code>Vue Router@4</code> ä¸­ï¼Œä½¿ç”¨äº†è‡ªå·±çš„åŒ¹é…ç®—æ³•ï¼Œæ–‡æ¡£ä¸Šæç¤ºæ˜¯â€œçµæ„Ÿæ¥æºäº <code>express</code> â€ <a href="https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#%E9%AB%98%E7%BA%A7%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener">Vue Router@4 åŸºç¡€/åŠ¨æ€è·¯ç”±åŒ¹é…/é«˜çº§åŒ¹é…æ¨¡å¼</a></p><p><code>express</code> æ˜¯ä¸€ä¸ª <code>node</code> ä¸Šçš„ç®€å•çš„ <code>web</code> æ¡†æ¶ï¼Œå¯ä»¥å¿«é€Ÿçš„æ­å»ºä¸€ä¸ª <code>web</code> æœåŠ¡å™¨ï¼Œå®ƒçš„è·¯ç”±å¯¼èˆªæ”¯æŒå¤æ‚çš„åŒ¹é…æ¨¡å¼</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/18/202209181333128.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/18/202209181333128.avif" alt=""></a></p><p>æ‰€ä»¥æˆ‘ä»¬ä¼šä» <code>Vue Router</code> è¿™ä¸¤ç§åŒ¹é…æ–¹å¼æ¥æŸ¥çœ‹å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«</p><h2 id="vue-router-3-åŒ¹é…ç®—æ³•-path-to-regexp" tabindex="-1">Vue Router@3 åŒ¹é…ç®—æ³• path-to-regexp <a class="header-anchor" href="#vue-router-3-åŒ¹é…ç®—æ³•-path-to-regexp">ğŸ”—</a></h2><p>è¯¥åº“æä¾›äº†å­—ç¬¦ä¸²è½¬æ­£åˆ™çš„èƒ½åŠ›ï¼Œç›®å‰ç”¨äº <code>Vue Router@3</code> çš„ç‰ˆæœ¬ï¼Œä»“åº“åœ°å€ï¼š <a href="https://github.com/pillarjs/path-to-regexp/tree/master" target="_blank" rel="noopener">pillarjs / path-to-regexp</a></p><p>å®ƒçš„æºç æ„æˆéå¸¸ç®€å•ï¼Œå°±ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨ <code>src</code> ä¸‹çš„ <code>index.ts</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222243732.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222243732.avif" alt=""></a></p><p>å¯¹äºæºä»£ç ï¼Œå…¶å®ä¸»è¦å°±æ˜¯ä¸‰ä¸ªå‡½æ•°</p><ul><li><code>lexer</code></li><li><code>parse</code></li><li><code>tokensToRegexp</code></li></ul><h3 id="lexer" tabindex="-1">lexer <a class="header-anchor" href="#lexer">ğŸ”—</a></h3><p>åœ¨æºç ä¸­ï¼Œå¯¹äºä¸€ä¸ª <code>path</code> ï¼Œæœ€å…ˆæˆ‘ä»¬éœ€è¦ç»™ä»–è½¬æˆ <code>LexToken</code> ç±»å‹ï¼Œè¯¥ç±»å‹å®šä¹‰å¦‚ä¸‹ï¼š</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222245951.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222245951.avif" alt=""></a></p><p>å…¶ä¸­ <code>type</code> ä¸ºè¯¥ <code>LexToken</code> ç±»å‹ï¼Œ <code>index</code> ä¸ºèµ·å§‹ç´¢å¼•ï¼Œ <code>value</code> ä¸ºå¯¹åº”çš„å€¼</p><p><code>lexer</code> å‡½æ•°ä¼šå»éå† <code>path</code> ï¼Œå¯¹äºæ¯ä¸ªå­—ç¬¦æˆ–è€…å­—ç¬¦ä¸²ï¼Œéƒ½æœ‰å…¶å¯¹åº”çš„ <code>type</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">function</span><span style="--s-dark:#80A665;--s-light:#59873A"> lexer</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> LexToken</span><span style="--s-dark:#666666;--s-light:#999999">[]</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">tokens</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LexToken</span><span style="--s-dark:#666666;--s-light:#999999">[] =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  while</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ä¿®é¥°ç¬¦ï¼Œè¿™é‡ŒåªåŒ¹é…è·¯å¾„å‚æ•°åé™„å¸¦çš„ä¿®é¥°ç¬¦ï¼Œ() å†…çš„æ­£åˆ™çš„ *+? ä¸ä¼šèµ°è¿™é‡Œçš„é€»è¾‘ï¼Œä¼šèµ°ä¸‹é¢åˆ¤æ–­æ­£åˆ™çš„é€»è¾‘</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">*</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">+</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">MODIFIER</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">] });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // è½¬ä¹‰å­—ç¬¦ï¼Œå¯¹äºæŸäº›å­—ç¬¦ï¼Œå¯èƒ½ä¼šå’Œè§£æäº§ç”Ÿå†²çªï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ \\ æ¥è¡¨æ˜ä¹‹åçš„å­—ç¬¦æ˜¯è½¬ä¹‰è¿‡åçš„ï¼Œä¸è¦å»è§£æ</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ¯”å¦‚å¯¹äºå¸¦å‚æ•°çš„è·¯å¾„ï¼Œ/foo?a=1 å¦‚æœç›´æ¥ä¼ å…¥ï¼ŒæŠ¥é”™ï¼Œå¿…é¡»ä¼ å…¥ä¸º /foo\\?a=1</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\\</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">ESCAPED_CHAR</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">] });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // è‡ªå®šä¹‰å‰åç¼€èµ·å§‹</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">{</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">OPEN</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">] });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // è‡ªå®šä¹‰å‰åç¼€ç»“æŸ</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">CLOSE</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">] });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // è·¯å¾„å‚æ•°è§£æ</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // ...</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">      </span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">NAME</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999"> });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ­£åˆ™</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // ...</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">PATTERN</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#666666;--s-light:#999999"> });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // å…¶ä»–å­—ç¬¦</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">CHAR</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">] });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // ç»“æŸ</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({ </span><span style="--s-dark:#B8A965;--s-light:#998418">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">END</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">index</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">, </span><span style="--s-dark:#B8A965;--s-light:#998418">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#666666;--s-light:#999999"> });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>å¯¹äºä¿®é¥°ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹ä¾‹å­ï¼ˆè¿™é‡Œæˆ‘è‡ªè¡Œæ‰“åŒ…å¯¼å‡ºäº† <code>lexer</code> è¿™ä¸ªå‡½æ•°ï¼Œæºæ–‡ä»¶æ˜¯æ²¡æœ‰å¯¼å‡ºè¿™ä¸ªå‡½æ•°çš„</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">lexer</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">lexer</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\\</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span></code></pre><p>æ‰§è¡Œä¹‹åå¾—åˆ°å¦‚ä¸‹ç»“æœ</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222352537.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222352537.avif" alt=""></a></p><p>å¯¹äºä¿®é¥°ç¬¦æ¥è¯´ï¼Œå®ƒæ˜¯æœ‰åŠŸèƒ½çš„ï¼Œå‚æ•°æ•°é‡å¯ä»¥ä½¿ç”¨ <code>?</code> æ¥è¡¨ç¤º <code>0</code> æˆ– <code>1</code> ä¸ª</p><p>æ¯”å¦‚ <code>/:foo?</code> ä»£è¡¨ <code>foo</code> è¿™ä¸ªå‚æ•°å¯ä»¥æ˜¯æœ‰ï¼Œä¹Ÿå¯ä»¥æ˜¯æ²¡æœ‰</p><p>è€Œå¯¹äºè½¬ä¹‰å­—ç¬¦ï¼Œå®ƒå°±åªæ˜¯ä¸€ä¸ªå•çº¯çš„å­—ç¬¦è€Œå·²ï¼Œåªæ˜¯ä¸ºäº†é˜²æ­¢è¢«å½“æˆä¿®é¥°ç¬¦</p><p>æ¯”å¦‚ <code>/foo\\?a=1</code> è¿™é‡Œçš„ <code>?</code> å°±åªæ˜¯è¡¨ç¤ºä¸€ä¸ªå•çº¯çš„å­—ç¬¦è€Œå·²ï¼Œæ‰€ä»¥éœ€è¦ç»™å®ƒè½¬ä¹‰</p><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬çœç•¥äº†ä¸€äº›é€»è¾‘ï¼Œå…¶ä¸­å¯¹äºè·¯å¾„å‚æ•°çš„è§£æä¸º</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> name</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> j</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> i</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  while</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> code</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">charCodeAt</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // `0-9`</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 48</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> &amp;&amp;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> code</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 57</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // `A-Z`</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 65</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> &amp;&amp;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> code</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 90</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // `a-z`</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 97</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> &amp;&amp;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> code</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;=</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 122</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // `_`</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      code</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 95</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    )</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      name</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    break</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> throw</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> TypeError</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Missing parameter name at </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">i</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span><span style="--s-dark:#B8A965;--s-light:#998418"> type</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">NAME</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#B8A965;--s-light:#998418"> index</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> i</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#B8A965;--s-light:#998418"> value</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> name</span><span style="--s-dark:#666666;--s-light:#999999"> });</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  i</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> j</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>è¿™æ®µé€»è¾‘æˆ‘è§‰å¾—å¾ˆç®€å•ï¼Œå¤§å®¶åº”è¯¥éƒ½èƒ½çœ‹æ‡‚ï¼Œå°±æ˜¯æŠŠ <code>:</code> åé¢çš„ <code>[a-zA-z0-9_]</code> çš„å­—ç¬¦å½“æˆåå­—</p><p>æ¯”å¦‚æˆ‘ä»¬è¾“å…¥ <code>/:pathName</code> ï¼Œé‚£ä¹ˆè§£æå¦‚ä¸‹ï¼š</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/24/202209242218471.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/24/202209242218471.avif" alt=""></a></p><p>å¯¹äºæ­£åˆ™ï¼Œè§£æçš„ä»£ç ä¸º</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> count</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> pattern</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> j</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> i</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    throw</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> TypeError</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Pattern cannot start with "?" at </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">j</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  while</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\\</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      pattern</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      count</span><span style="--s-dark:#CB7676;--s-light:#AB5959">--</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">count</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">        j</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">        break</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      count</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">        throw</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> TypeError</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Capturing groups are not allowed at </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">j</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    pattern</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> str</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">j</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">count</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> throw</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> TypeError</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Unbalanced pattern at </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">i</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> throw</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> TypeError</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Missing pattern at </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">i</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span><span style="--s-dark:#B8A965;--s-light:#998418"> type</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">PATTERN</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#B8A965;--s-light:#998418"> index</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> i</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#B8A965;--s-light:#998418"> value</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> pattern</span><span style="--s-dark:#666666;--s-light:#999999"> });</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  i</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> j</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>è¿™ä¸ªé€»è¾‘ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯è·å–æ‹¬å·ä¹‹é—´çš„å†…å®¹ï¼Œé¡ºä¾¿åšä¸€äº›éæ³•åˆ¤æ–­ï¼Œæ¯”å¦‚å¦‚æœå†™äº†æ‹¬å·ï¼Œä½†æ˜¯æ­£åˆ™é•¿åº¦ä¸º <code>0</code> çš„è¯é‚£ä¹ˆæŠ¥é”™</p><p>ä»¥åŠæ­£åˆ™å¦‚æœä»¥ <code>?</code> å¼€å¤´ï¼Œé‚£ä¹ˆä¹ŸæŠ¥é”™</p><p>æˆ‘ä»¬è¾“å…¥ <code>/([0-9]{0,3})</code> ï¼Œé‚£ä¹ˆè¾“å‡ºå¦‚ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/24/202209242233254.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/24/202209242233254.avif" alt=""></a></p><p>å¯¹äº <code>{}</code> è¿™ä¸ªåŒ¹é…ï¼Œç°åœ¨æˆ‘ä»¬åªéœ€è¦çŸ¥é“å®ƒåšäº†ä¸ªæ ‡è®°å³å¯</p><p>ç»è¿‡ä¸Šé¢çš„åˆ†æä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç° <code>lexer</code> åªæ˜¯æ ‡è®°åˆ†å‰²ç±»å‹è€Œå·²ï¼Œä»¥åŠå¯¹ç±»å‹æœ¬èº«è¿›è¡Œä¸€äº›ç®€å•çš„éæ³•åˆ¤æ–­</p><p>å¯¹äºæŸä¸ªç±»å‹çš„å‰åé™åˆ¶å¹¶æ²¡æœ‰åˆ¤æ–­ï¼Œè¿™æ˜¯ä¹‹åçš„ <code>parse</code> å‡½æ•°çš„æ ¸å¿ƒé€»è¾‘</p><h3 id="parse" tabindex="-1">parse <a class="header-anchor" href="#parse">ğŸ”—</a></h3><p>è¿™ä¸ªæ­¥éª¤ä¼šæ ¹æ® <code>lexer</code> ç”Ÿæˆçš„ <code>LexToken</code> åˆ—è¡¨æ¥ç”Ÿæˆ <code>Token</code> åˆ—è¡¨ï¼Œ <code>Token</code> çš„ç±»å‹å¦‚ä¸‹ï¼š</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222252144.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/22/202209222252144.avif" alt=""></a></p><p>å…¶ä¸­ <code>string</code> å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æ²¡æœ‰å•çº¯çš„ä¸€ä¸ªè·¯å¾„è€Œå·²ï¼Œå’Œè·¯å¾„å‚æ•°å’Œæ­£åˆ™éƒ½æ²¡æœ‰å…³ç³»</p><p>è€Œ <code>Key</code> åˆ™æ˜¯æ¯ä¸ªå¤æ‚è·¯å¾„çš„è¡¨ç¤º</p><p><code>parse</code> çš„ç²¾ç®€ä»£ç å¦‚ä¸‹</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> function</span><span style="--s-dark:#80A665;--s-light:#59873A"> parse</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> options</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">ParseOptions</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {}):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> Token</span><span style="--s-dark:#666666;--s-light:#999999">[]</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">tokens</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> lexer</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">str</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#666666;--s-light:#999999">{</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> prefixes</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999"> }</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> options</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">defaultPattern</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">[^</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#80A665;--s-light:#59873A">escapeString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959">options</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">delimiter </span><span style="--s-dark:#CB7676;--s-light:#AB5959">||</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">/#?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">]+?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">result</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Token</span><span style="--s-dark:#666666;--s-light:#999999">[] =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#80A665;--s-light:#59873A">tryConsume</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LexToken</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">type</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">]):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> |</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined </span><span style="--s-dark:#666666;--s-light:#999999">=&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#80A665;--s-light:#59873A">mustConsume</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LexToken</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">type</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">]):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#80A665;--s-light:#59873A">consumeText</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> ():</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  };</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  while</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>ç¬¬ä¸€è¡Œï¼Œä½¿ç”¨ <code>lexer(path)</code> æ¥è·å– <code>LexToken</code> åˆ—è¡¨ï¼Œæ¥ä¸‹æ¥å°±æ ¹æ®è¿™ä¸ª <code>LexToken</code> åˆ—è¡¨æ¥ç”Ÿæˆ <code>Token</code> åˆ—è¡¨</p><p><code>prefixes</code> è¡¨æ˜äº†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»€ä¹ˆå­—ç¬¦æ¥åˆ†å‰²è·¯å¾„ï¼Œè¿™é‡Œé»˜è®¤æ˜¯ <code>.</code> æˆ–è€… <code>/</code></p><p><code>defaultPattern</code> è¡¨æ˜é»˜è®¤çš„è·¯å¾„å‚æ•°åŒ¹é…çš„è§„åˆ™ï¼Œæ²¡é”™ï¼Œé»˜è®¤è·¯å¾„å‚æ•°å¦‚æœä¸å†™æ­£åˆ™çš„è¯ï¼Œå®ƒæ˜¯ä¼šé»˜è®¤è®¾ç½®ä¸€ä¸ªæ­£åˆ™çš„</p><p>æˆ‘ä»¬æ‰§è¡Œ <code>parse("/:foo")</code> ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209250005653.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209250005653.avif" alt=""></a></p><p>è¿™é‡Œé»˜è®¤çš„æ­£åˆ™èµ·å§‹å°±æ˜¯ <code>/[^/#?]+?/</code></p><p>å…¶ä¸­å‰é¢ä¸‰ä¸ªå‡½æ•° <code>tryConsume</code> ï¼Œ <code>mustConsume</code> ï¼Œ<code>consumeText</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#80A665;--s-light:#59873A">tryConsume</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LexToken</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">type</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">]):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> |</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined </span><span style="--s-dark:#666666;--s-light:#999999">=&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> &amp;&amp; </span><span style="--s-dark:#BD976A;--s-light:#B07D48">tokens</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">].</span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> === </span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">].</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">};</span></span></code></pre><p><code>tryConsume</code> çš„æ„æ€å°±æ˜¯æˆ‘ä»¬å°è¯•è·å–å½“å‰æŒ‡å‘çš„ <code>LexToken</code> ï¼Œå¦‚æœç¬¦åˆä¼ å…¥çš„ <code>LexToken</code> ç±»å‹ï¼Œè¿”å›å¯¹åº”çš„ <code>value</code> ï¼Œå¹¶ä¸”ç´¢å¼• <code>i</code> æŒ‡å‘ä¸‹ä¸€ä¸ª <code>LexToken</code> ï¼Œä¸ç¬¦åˆåˆ™ä¸è¿›è¡Œä»»ä½•æ“ä½œ</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#80A665;--s-light:#59873A">mustConsume</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LexToken</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">type</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">]):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">type</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !== undefined</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#666666;--s-light:#999999">{</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> type</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> nextType</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> index</span><span style="--s-dark:#666666;--s-light:#999999"> }</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  throw</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new </span><span style="--s-dark:#80A665;--s-light:#59873A">TypeError</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Unexpected </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">nextType</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959"> at </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">index</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">, expected </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">type</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">};</span></span></code></pre><p><code>mustConsume</code> æ„å‘³ç€å½“å‰æŒ‡å‘çš„ <code>LexToken</code> å¿…é¡»æ˜¯ç‰¹å®š <code>type</code> çš„ <code>LexToken</code> ï¼Œå¦åˆ™æŠ¥é”™</p><p>è¿™ä¸ªå‡½æ•°ä¸»è¦ç”¨äºåŒ¹é…ä¹‹å‰æˆ‘ä»¬è¯´è¿‡çš„ <code>{}</code> è‡ªå®šä¹‰å‰åç¼€çš„é€»è¾‘ï¼Œä»¥åŠåˆ¤æ–­ <code>END</code> ç±»å‹çš„ <code>LexToken</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#80A665;--s-light:#59873A">consumeText</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> ():</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">result</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999"> | </span><span style="--s-dark:#CB7676;--s-light:#AB5959">undefined</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  while</span><span style="--s-dark:#666666;--s-light:#999999"> ((</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">CHAR</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> || </span><span style="--s-dark:#80A665;--s-light:#59873A">tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">ESCAPED_CHAR</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)))</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    result</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> += </span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">};</span></span></code></pre><p><code>consumeText</code> åˆ™æ˜¯å°è¯•æ‹¼æ¥å½“å‰ä¸€æ®µè¿ç»­çš„ <code>CHAR</code> æˆ–è€… <code>ESCAPED_CHAR</code> ï¼Œå³ä¸€æ®µæ™®é€šçš„å­—ç¬¦ä¸²</p><p>æ¥ä¸‹æ¥å°±æ˜¯éå† <code>LexToken</code> åˆ—è¡¨çš„é€»è¾‘ï¼Œè¿™é‡Œæˆ‘ä»¬æ‹†åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ä¼šæ¯”è¾ƒå®¹æ˜“ç†è§£</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">while</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">char</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">CHAR</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">NAME</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">PATTERN</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // ç¬¬ä¸€éƒ¨åˆ†</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // åŒ¹é…å¯é€‰çš„è·¯å¾„å‚æ•°å’Œå¯é€‰çš„è·¯å¾„å‚æ•°æ­£åˆ™</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> pattern</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ... </span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // ç¬¬äºŒéƒ¨åˆ†</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // åŒ¹é…åŸå§‹çš„å­—ç¬¦æˆ–è€…è½¬ä¹‰è¿‡çš„å­—ç¬¦</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> || </span><span style="--s-dark:#80A665;--s-light:#59873A">tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">ESCAPED_CHAR</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    path</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">  </span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // ç¬¬ä¸‰éƒ¨åˆ†</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // åŒ¹é…è‡ªå®šä¹‰å‰åç¼€</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">open</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">OPEN</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">open</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ...</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // åŒ¹é…ç»“æŸç¬¦å·</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">  mustConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">END</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>å¯¹äºç¬¬ä¸€éƒ¨åˆ†ï¼ŒåŒ¹é…çš„æ˜¯å¯é€‰çš„è·¯å¾„å‚æ•°ï¼Œä»¥åŠå¯é€‰çš„è·¯å¾„å‚æ•°æ­£åˆ™</p><p>æ²¡é”™ï¼Œè¿™ä¸¤è€…éƒ½æ˜¯å¯é€‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰å¦‚ä¸‹çš„å†™æ³•</p><ul><li><code>/:foo</code></li><li><code>/(\\w+)</code></li><li><code>/:foo(\\w+)</code></li></ul><p>è¿™ä¸‰è€…è§£æçš„ç»“æœå¦‚ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251109131.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251109131.avif" alt=""></a></p><p>å¦‚æœæ²¡å†™è·¯å¾„å‚æ•°åï¼Œé‚£ä¹ˆå†…éƒ¨ä¼šèµ‹äºˆä¸€ä¸ªè‡ªå¢çš„ç´¢å¼•ï¼Œè¿™ä¸ªéƒ¨åˆ†çš„ä»£ç å¦‚ä¸‹</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> pattern</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // å‰ç¼€</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">prefix</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> || </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // å‰ç¼€å¿…é¡»æ˜¯ . æˆ–è€… / ï¼Œå¦åˆ™è¢«å½’åˆ°ä¸Šä¸€ä¸ª path ä¸­</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">prefixes</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">prefix</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    path</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> prefix</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    prefix</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æ¨å…¥ä¸Šä¸€ä¸ª path</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æ¨å…¥å½“å‰è·¯å¾„å‚æ•°</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // å¯é€‰è·¯å¾„å‚æ•°å</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // éå…·åä¸‹ä½¿ç”¨è‡ªå¢çš„ key æ¥è¡¨ç¤º</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    name</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> key</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    prefix</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    suffix</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // å¯é€‰è·¯å¾„å‚æ•°æ­£åˆ™</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    pattern</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> defaultPattern</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ˜¯å¦å­˜åœ¨ä¿®é¥°ç¬¦</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    modifier</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#80A665;--s-light:#59873A">tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">MODIFIER</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">) </span><span style="--s-dark:#CB7676;--s-light:#AB5959">||</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>å¯ä»¥ä»ä¸Šé¢çœ‹åˆ°ï¼Œå•æ˜¯è¿™ä¸€ä¸ªå¤§çš„ <code>if</code> å†…å°±æ’å…¥äº†ä¸¤ä¸ª <code>path</code></p><p>å…¶å®ä¸»è¦æ˜¯ä¸ºäº†åŒºåˆ«å‰ç¼€è¿™ä¸ªä¸œè¥¿ï¼Œå¯¹äº <code>/foo-:bar</code> è¿™ç§ï¼Œ <code>/foo-</code> å¹¶ä¸èƒ½ç§°ä¸º <code>:bar</code> çš„å‰ç¼€ï¼Œè€Œæ˜¯ä¸€ä¸ªå•ç‹¬çš„è·¯å¾„è€Œå·²ï¼Œè€Œ <code>:bar</code> ä¹Ÿæˆä¸ºäº†ä¸€ä¸ªå•ç‹¬çš„è·¯å¾„ï¼Œæ­¤æ—¶å®ƒçš„å‰ç¼€ä¸ºç©º</p><p>è€Œå¯¹äº <code>/:bar</code> è¿™ç§ï¼Œç”±äº <code>/</code> ä¸ºé»˜è®¤çš„å¯é€‰çš„å‰ç¼€ä¹‹ä¸€ï¼Œæ‰€ä»¥å¯ä»¥æˆä¸º <code>:bar</code> çš„å‰ç¼€</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> char</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> || </span><span style="--s-dark:#80A665;--s-light:#59873A">tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">ESCAPED_CHAR</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  path</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>ç¬¬äºŒéƒ¨åˆ†å°±æ¯”è¾ƒç®€å•äº†ï¼Œå¦‚æœå½“å‰çš„ <code>LexToken</code> æ˜¯æ™®é€šå­—ç¬¦æˆ–è€…è½¬ä¹‰å­—ç¬¦ï¼Œé‚£ä¹ˆç›´æ¥ç´¯åŠ åˆ° <code>path</code> ä¸Šå³å¯</p><p>æ³¨æ„ï¼Œè¿™é‡Œï¼ˆç¬¬ä¸€ä¸ª <code>if</code> å†…ï¼‰å¹¶æ²¡æœ‰ <code>push</code> æ“ä½œï¼Œå› ä¸ºåœ¨ <code>LexToken</code> ä¸­ï¼Œæ¯ä¸ªæ™®é€šå­—ç¬¦éƒ½æ˜¯ä¸€ä¸ª <code>CHAR</code> ç±»å‹çš„</p><p>åªæœ‰å½“å½“å‰çš„ <code>LexToken</code> ä¸æ˜¯ <code>CHAR</code> æˆ–è€… <code>ESCAPED_CHAR</code> æ—¶ï¼Œæ‰ä¼šèµ°åˆ°ç¬¬äºŒä¸ª <code>if</code> ï¼ŒæŠŠå½“å‰æ‹¼æ¥çš„ <code>path</code> æ”¾åˆ°ç»“æœæ•°ç»„ä¸­</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// å°è¯•åŒ¹é…è‡ªå®šä¹‰å‰ç¼€å¼€å§‹ï¼Œè¿™é‡Œä¸ºåŒ¹é…å·¦å¤§æ‹¬å· {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">open</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">OPEN</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">open</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // è·å–å‰ç¼€</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">prefix</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> consumeText</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // è·å–è·¯å¾„å‚æ•°åï¼Œå¯é€‰</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">NAME</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> || </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // è·å–è·¯å¾„å‚æ•°æ­£åˆ™ï¼Œå¯é€‰</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">PATTERN</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> || </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // è·å–åç¼€</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">suffix</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> consumeText</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // å¿…é¡»åŒ¹é…å³å¤§æ‹¬å· } æ¥ä½œä¸ºç»“æŸæ ‡å¿—</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">  mustConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">CLOSE</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    name</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> key</span><span style="--s-dark:#CB7676;--s-light:#AB5959">++</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">),</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    pattern</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">name</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> &amp;&amp;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !</span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> defaultPattern</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> pattern</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    prefix</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    suffix</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    modifier</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#80A665;--s-light:#59873A">tryConsume</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">MODIFIER</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">) </span><span style="--s-dark:#CB7676;--s-light:#AB5959">||</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>å‰é¢ç¬¬äºŒéƒ¨åˆ†æˆ‘ä»¬åˆ†æäº†å½“å‰çš„ <code>LexToken</code> ä¸æ˜¯ <code>CHAR</code> æˆ–è€… <code>ESCAPED_CHAR</code></p><p>é‚£ä¹ˆå½“èµ°åˆ°ç¬¬ä¸‰éƒ¨åˆ†æ—¶ï¼Œ<code>LexToken</code> çš„ç±»å‹åªèƒ½ä¸º <code>OPEN</code> æˆ–è€… <code>END</code> äº†</p><p>åœ¨ <code>if</code> å†…çš„é€»è¾‘å…¶å®å’Œç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯å·®ä¸å¤šçš„ï¼Œåªä¸è¿‡å¤šäº†å‰åç¼€çš„è§£æ</p><p>å¯¹äº <code>/{bar:foo-baz}</code> è¿™æ ·çš„è·¯å¾„ï¼Œå‰åç¼€åˆ†åˆ«ä¸º <code>bar</code> å’Œ <code>-baz</code> ï¼Œæ³¨æ„è¿™é‡Œæˆ‘ä»¬ç”¨ <code>-</code> æ¥è¡¨ç¤ºåç¼€çš„å¼€å§‹</p><p>å› ä¸ºåœ¨ <code>lexer</code> å‡½æ•°ä¸­æˆ‘ä»¬è¯´è¿‡ï¼Œè·¯å¾„å‚æ•°åä¼šåŒ¹é… <code>[0-9a-zA-z_]</code> çš„å­—ç¬¦</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251149997.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251149997.avif" alt=""></a></p><p>å¦‚æœä½ æƒ³è¯´ï¼Œä¸è¡Œï¼Œ<code>-</code> è¿™ä¸ªå¤ªä¸‘äº†ï¼Œä¸è¦è¿™ä¸ªï¼Œé‚£ä¹ˆæ­¤æ—¶å…¶å®æˆ‘ä»¬å¯ä»¥æ’å…¥ä¸€ä¸ªæ­£åˆ™ï¼Œè¿™æ ·å°±èƒ½æ­£ç¡®çš„è§£æäº†ï¼Œå³ <code>/{bar:foo(.*)baz}</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251151921.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251151921.avif" alt=""></a></p><h3 id="tokenstoregexp" tabindex="-1">tokensToRegexp <a class="header-anchor" href="#tokenstoregexp">ğŸ”—</a></h3><p>å½“æˆ‘ä»¬å¾—åˆ° <code>Token</code> åˆ—è¡¨ä¹‹åï¼Œ <code>tokensToRegexp</code> å°±ä¼šæŠŠ <code>Token</code> åˆ—è¡¨è½¬ä¸ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼</p><p>è¿™é‡Œæˆ‘ä»¬å…ˆå…³æ³¨è¿™ä¸ªå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªé…ç½®å‚æ•°ï¼Œæ§åˆ¶ä¸€äº›å˜é‡ï¼Œå¦‚ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251350857.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251350857.avif" alt=""></a></p><ul><li><code>sensitive</code> ä¸º <code>true</code> ï¼Œè¡¨ç¤ºåŒºåˆ†å¤§å°å†™ï¼Œå†…éƒ¨ä½¿ç”¨æ­£åˆ™çš„ <code>i</code> æ ‡å¿—</li><li><code>strict</code> ä¸º <code>true</code> ï¼Œè¡¨ç¤ºä¸å…è®¸å¯é€‰çš„å°¾éšåˆ†éš”ç¬¦ï¼Œå³ <code>/foo</code> ç”Ÿæˆçš„æ­£åˆ™æ— æ³•åŒ¹é… <code>/foo/</code> è·¯å¾„</li><li><code>start</code> å’Œ <code>end</code> ä¸º <code>true</code> ï¼Œè¡¨ç¤ºç”Ÿæˆçš„æ­£åˆ™é™å®šäº†è·¯å¾„çš„å¼€å§‹å’Œç»“æŸï¼Œå†…éƒ¨ä½¿ç”¨æ­£åˆ™çš„ <code>^</code> å’Œ <code>$</code></li><li><code>delimiter</code> ï¼ŒæŒ‡å®šå…·åå‚æ•°çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸º <code>/</code> ï¼Œ<code>?</code> å’Œ <code>#</code></li><li><code>endsWith</code> æŒ‡å®šè‡ªå®šä¹‰çš„ç»“æŸå­—ç¬¦ï¼Œä¼˜å…ˆçº§æ¯” <code>end = true</code> è¦é«˜ï¼Œå†…éƒ¨ä½¿ç”¨æ­£å‘å…ˆè¡Œæ–­è¨€ï¼Œå³ <code>(?=endsWith)</code></li><li><code>encode</code> ï¼ŒæŒ‡å®šå­—ç¬¦ä¸²åœ¨æ’å…¥æ­£åˆ™å‰çš„éœ€è¦åšçš„å¤„ç†ï¼Œé»˜è®¤ä¸º <code>x =&gt; x</code> ï¼Œå³ç›´æ¥è¿”å›æœ¬èº«</li><li><code>prefixes</code> ï¼ŒæŒ‡å®šè‡ªå®šä¹‰çš„å‰ç¼€åˆ—è¡¨ï¼Œé»˜è®¤ä¸º <code>.</code> å’Œ <code>/</code> è¿™ç‚¹æˆ‘ä»¬åœ¨ <code>parse</code> ä¸­è§è¿‡ç›¸å…³çš„é€»è¾‘äº†</li></ul><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹æºç ï¼Œä¸»è¦çš„é€»è¾‘å°±æ˜¯ä¸€ä¸ªéå† <code>Token</code> åˆ—è¡¨</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> function</span><span style="--s-dark:#80A665;--s-light:#59873A"> tokensToRegexp</span><span style="--s-dark:#666666;--s-light:#999999">(</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  tokens</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Token</span><span style="--s-dark:#666666;--s-light:#999999">[],</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  keys</span><span style="--s-dark:#CB7676;--s-light:#AB5959">?</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Key</span><span style="--s-dark:#666666;--s-light:#999999">[],</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  options</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">TokensToRegexpOptions</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {}</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#666666;--s-light:#999999">{</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    strict</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> false</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    start</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    end</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    encode</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">x</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> x</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    delimiter</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">/#?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    endsWith</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> options</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">endsWithRe</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">[</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#80A665;--s-light:#59873A">escapeString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959">endsWith</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">]|$</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">delimiterRe</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">[</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#80A665;--s-light:#59873A">escapeString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D;--s-light:#B56959">delimiter</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">]</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">route</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> start</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ? </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">^</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> : </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">  </span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ... æ ¸å¿ƒé€»è¾‘</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æœ«å°¾å¤„ç†</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">end</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> new</span><span style="--s-dark:#80A665;--s-light:#59873A"> RegExp</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">route</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#80A665;--s-light:#59873A"> flags</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">options</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>è¿™é‡Œ <code>for</code> å†…éƒ¨å°±æ˜¯ç”Ÿæˆ <code>route</code> å­—ç¬¦ä¸²çš„æ ¸å¿ƒé€»è¾‘ï¼Œç„¶åæœ€åä½¿ç”¨ <code>new RegExp(route, flags(options))</code> æ¥ç”Ÿæˆä¸€ä¸ªæ­£åˆ™å¹¶è¿”å›</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">typeof</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> token</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">string</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // å¦‚æœæ˜¯ç®€å•å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆç›´æ¥è½¬ä¹‰æ‹¼æ¥å³å¯</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#80A665;--s-light:#59873A"> escapeString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">encode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // å¾—åˆ°å‰åç¼€</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">prefix</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> escapeString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">encode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">prefix</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">suffix</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> escapeString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">encode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">suffix</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // å­˜åœ¨è·¯å¾„å‚æ•°æ­£åˆ™æƒ…å†µä¸‹</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">pattern</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">keys</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> keys</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // å­˜åœ¨å‰ç¼€æˆ–è€…åç¼€</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">prefix</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> suffix</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">        </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">        // + è¡¨ç¤º 1 ä¸ªæˆ–å¤šä¸ª</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">        // * è¡¨ç¤º 0 ä¸ªæˆ–å¤šä¸ª</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">        // ? è¡¨ç¤º 0 ä¸ª æˆ– 1 ä¸ª</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">        if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">modifier</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">+</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">modifier</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">*</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">          const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">mod</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">modifier</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> === </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">*</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ? </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> : </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">          // è¿™é‡Œæ¯”è¾ƒå·§å¦™ï¼Œä½¿ç”¨äº† * å’Œ ? æ¥æ¨¡æ‹Ÿ + å’Œ * çš„æƒ…å†µ</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">          // æ¯”å¦‚å¯¹äº /{foo-:bar-baz}* ï¼Œ ç”¨ (-bazfoo-:bar)* æ¥é‡å¤ä¸­é—´çš„éƒ¨åˆ†</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">          route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">prefix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">((?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">pattern</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)(?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">suffix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">prefix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">pattern</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">))*)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">suffix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">mod</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">        }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">          // å¯¹äº ? çš„æƒ…å†µï¼Œåªéœ€ç›´æ¥åœ¨æœ«å°¾åŠ ä¸Š ? å³å¯</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">          route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">prefix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">pattern</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">suffix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">modifier</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">        }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">        // ä¸å­˜åœ¨å‰åç¼€ï¼Œåªéœ€ç®€å•çš„æ·»åŠ ä¿®é¥°ç¬¦å³å¯</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">        if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">modifier</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">+</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">modifier</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">*</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">          route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">((?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">pattern</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">modifier</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">        }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">          route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">pattern</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">modifier</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">        }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34"> </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ä¸å­˜åœ¨è·¯å¾„å‚æ•°æ­£åˆ™æƒ…å†µä¸‹ï¼Œç›´æ¥ç”Ÿæˆå³å¯</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">prefix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">suffix</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">token</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#C98A7D;--s-light:#B56959">modifier</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// å¦‚æœè®¾ç½®äº†æœ«å°¾æ£€æµ‹</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">end</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ éœ€è¦å…ˆåŠ ä¸Š `[\/#\?]?` å†åŠ ä¸Š $ æˆ–è€…è®¾ç½®çš„ç»“å°¾å­—ç¬¦ä¸²</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">strict</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">delimiterRe</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !</span><span style="--s-dark:#BD976A;--s-light:#B07D48">options</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">endsWith</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">$</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?=</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">endsWithRe</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æ²¡æœ‰è®¾ç½®æœ«å°¾æ£€æµ‹</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æ‰¾åˆ°æœ€åä¸€ä¸ª Token</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">endToken</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> tokens</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">tokens</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> - </span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34">  </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æœ«å°¾ Token æ˜¯å¦å­˜åœ¨åˆ†éš”ç¬¦</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">isEndDelimited</span><span style="--s-dark:#666666;--s-light:#999999"> =</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    typeof </span><span style="--s-dark:#BD976A;--s-light:#B07D48">endToken</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> === </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">string</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">      ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> delimiterRe</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">endToken</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">endToken</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">])</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">      :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> endToken</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> undefined</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // éä¸¥æ ¼æ¨¡å¼ä¸‹å¯åŒ¹é…å¯é€‰çš„å°¾éšåˆ†éš”ç¬¦</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">strict</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?:</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">delimiterRe</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?=</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">endsWithRe</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">))?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æœ«å°¾ Token ä¸å­˜åœ¨åˆ†éš”ç¬¦ï¼Œä½¿ç”¨æ­£å‘å…ˆè¡Œæ–­è¨€ç¡®ä¿ç»“å°¾æœ‰åˆ†éš”ç¬¦ä»¥åŠé…ç½®çš„ç‰¹å®šå°¾éšç¬¦</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">isEndDelimited</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    route</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">(?=</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">delimiterRe</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">|</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">endsWithRe</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">)</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><h2 id="vue-router-4-åŒ¹é…ç®—æ³•" tabindex="-1">Vue Router@4 åŒ¹é…ç®—æ³• <a class="header-anchor" href="#vue-router-4-åŒ¹é…ç®—æ³•">ğŸ”—</a></h2><p><code>Vue Router@4</code> ä½¿ç”¨äº†è‡ªå·±å†™çš„ä¸€å¥—è·¯å¾„è½¬æ­£åˆ™çš„ç®—æ³•ï¼Œå¹¶ä¸”åŠ å…¥äº†è·¯å¾„çš„ <code>Rank</code> åˆ†æ’è¡Œ</p><p>ä¸Šé¢æˆ‘ä»¬è¯´è¿‡è¿™ä¸ªçµæ„Ÿæ¥è‡ª <code>express</code> ï¼Œé‚£ä¹ˆ <code>express</code> ä½¿ç”¨äº†ä»€ä¹ˆç®—æ³•å‘¢ï¼Ÿç¿»å¼€ <code>express</code> çš„ <code>package.json</code> ï¼Œå…¶å®ä½¿ç”¨çš„å°±æ˜¯ä¸Šé¢æˆ‘ä»¬è¯´è¿‡çš„ <code>path-to-regexp</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251739397.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251739397.avif" alt=""></a></p><p>ä¸è¿‡ <code>express</code> ä½¿ç”¨çš„æ˜¯ <code>0.1.x</code> çš„ç‰ˆæœ¬ï¼Œé‚£ä¸ªç‰ˆæœ¬åªå¯¼å‡ºäº† <code>pathToRegexp</code> è¿™ä¸ªå‡½æ•°ï¼Œè€Œä¸”å®ç°ä¸Šå’Œç›®å‰çš„æœ€æ–°ç‰ˆæœ¬ä¹Ÿæœ‰åŒºåˆ«ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹çœ‹</p><p>åœ¨ <code>Vue Router@3</code> ä¸­ï¼Œå¯¹è·¯å¾„çš„åŒ¹é…åŸºäºç¼–å†™çš„é¡ºåºï¼Œå³ä¼ å…¥ <code>routes</code> çš„æ•°ç»„å†…å…ƒç´ çš„é¡ºåºï¼Œå®ƒä¼šæŒ‰ç…§é¡ºåºä¸€ä¸ªä¸ªåŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œé‚£ä¹ˆç›´æ¥è¿”å›å¯¹åº”çš„ç»„ä»¶</p><p>å½“è·¯ç”±å°‘çš„æ—¶å€™å¯èƒ½è¿˜è¡Œï¼Œä½†æ˜¯ä¸€æ—¦è·¯ç”±è§„åˆ™å¤šäº†èµ·æ¥ï¼Œæœ‰æ—¶å€™å¾ˆå®¹æ˜“å‡ºç°å†™äº†è·¯ç”±æ²¡ç”Ÿæ•ˆçš„æƒ…å†µäº†</p><p>è€Œ <code>Vue Router@4</code> å¼•å…¥äº†è·¯å¾„ <code>Rank</code> åˆ†è¿™ä¸€ä¸ªç‰¹æ€§ï¼Œå¯¹äºæ¯ä¸ª <code>path</code> è·¯å¾„ï¼Œå®ƒéƒ½æœ‰ä¸€ä¸ª <code>Rank</code> åˆ†ï¼Œè¶Šè¯¦ç»†è¶Šå¤æ‚çš„è·¯å¾„çš„ <code>Rank</code> åˆ†å°±è¶Šé«˜</p><p>å³ä½¿ä½ æŠŠè¿™ä¸ªå¤æ‚çš„è·¯å¾„å†™åœ¨äº† <code>Rank</code> åˆ†ä½äºè¯¥è·¯å¾„çš„è·¯å¾„åé¢ï¼Œä¹Ÿèƒ½å¤Ÿæ­£ç¡®çš„è¿›è¡ŒåŒ¹é…</p><p>å¯¹äºè·¯å¾„è½¬æ­£åˆ™ï¼Œå…¶å® <code>Vue-Router@3</code> å’Œ <code>Vue-Router@4</code> ä»æ–¹æ³•ä¸Šçœ‹å¹¶æ²¡æœ‰å·®å¾ˆå¤šï¼Œéƒ½æ˜¯å…ˆè½¬æˆ <code>Token</code> ï¼Œç„¶åå†æ ¹æ® <code>Token</code> æ¥ç”Ÿæˆæ­£åˆ™ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±ä¸å±•å¼€äº†</p><p>è¿™é‡Œä¸»è¦è®²è®² <code>Vue-Router@4</code> çš„ <code>Rank</code> åˆ†è®¡ç®—ï¼Œæºç ä¸­å®šä¹‰äº†ä¸€äº›å¾—åˆ†è§„åˆ™</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251802242.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251802242.avif" alt=""></a></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ ¹è·¯å¾„å¾—åˆ† <code>90</code> åˆ†ï¼Œè·¯å¾„å‚æ•°å¾—åˆ† <code>20</code> åˆ†ï¼Œä»¥åŠä¸€äº›æ¯”è¾ƒä½çš„å‚æ•°çš„å¾—åˆ†</p><p>é€šè¿‡è¿™äº›å¾—åˆ†ï¼Œå†…éƒ¨å°±èƒ½æ’åºè¿™äº›è§„åˆ™ï¼Œä»è€Œä»¥ä»å¾—åˆ†é«˜åˆ°å¾—åˆ†ä½çš„é¡ºåºè¿›è¡ŒåŒ¹é…</p><p>å®˜æ–¹ä¹Ÿç»™å‡ºäº†ä¸€ä¸ªå¯ä»¥åœ¨çº¿ç¼–å†™è·¯ç”±çš„æµ‹è¯•ç½‘ç«™ï¼Œ<a href="https://paths.esm.dev/?p=AAMsIPQgYAEL9lNgQAECUgPgDIFiDgCg#" target="_blank" rel="noopener">ç‚¹æˆ‘ç›´è¾¾</a></p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä¾‹å­ï¼Œå³ <code>/:name(abc)</code> å’Œ <code>/:path</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251812214.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/09/25/202209251812214.avif" alt=""></a></p><p>å¯ä»¥çœ‹å‡ºä¸¤è€…çš„å¾—åˆ†æ˜¯æœ‰åŒºåˆ«çš„ï¼ŒæŒ‡å®šäº†è·¯å¾„å‚æ•°æ­£åˆ™çš„è·¯ç”±å¾—åˆ†è¦é«˜ï¼Œåœ¨å³ä¾§ä¼šæ¯”è¾ƒ <code>Rank</code> åˆ†ä»é«˜åˆ°ä½æ’åº</p><p>æ­¤æ—¶æµ‹è¯• <code>/abc</code> é‚£ä¹ˆ <code>/:name(abc)</code> å°†ä¼šåŒ¹é… ï¼Œè€Œ <code>path</code> ä¼šè¢«å¿½ç•¥ï¼Œå³ä½¿æŠŠå®ƒå†™åœ¨äº† <code>/:name(abc)</code> çš„å‰é¢</p><h1 id="åè®°" tabindex="-1">åè®° <a class="header-anchor" href="#åè®°">ğŸ”—</a></h1><p>æ˜¯è°é—®çš„æˆ‘è¿™ä¸ªé—®é¢˜å‘¢ï¼Œåˆæˆ–è€…è¯´æ²¡äººé—®è¿‡æˆ‘è¿™ä¸ªé—®é¢˜</p><p>è¿˜è¦å­¦ä¹ çš„ä¸œè¥¿è¿˜æœ‰å¾ˆå¤šï¼ŒåŠ æ²¹å§~</p></div><!--]--></div><div flex="~ wrap" text="[var(--mygo-c-text-2)]" mt-8="" gap-4="" justify-center=""><!--[--><div>#Vue Router</div><div>#Vue</div><!--]--></div><!--]--></div></div><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="~ wrap" gap-4=""><a href="/cc09bd22d963" class="" truncate="" title="2022å¹´10æœˆæ–°ç•ªä¸ªäººæ¨è"><i class="i-mi:chevron-left" mr-1=""></i><span>2022å¹´10æœˆæ–°ç•ªä¸ªäººæ¨è</span></a><a href="/369554860891" class="" ml-auto="" truncate="" title="å¦‚ä½•æµç•…çš„ä½¿ç”¨åœ¨ Vue3 ä¸­ä½¿ç”¨ TypeScript"><span>å¦‚ä½•æµç•…çš„ä½¿ç”¨åœ¨ Vue3 ä¸­ä½¿ç”¨ TypeScript</span><i class="i-mi:chevron-right" ml-1=""></i></a></div><!--]--></div></div><!--[--><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-a68bfdd1="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="" gap-4="" items-start="" data-v-a68bfdd1=""><div flex="~ shrink-0" bg="[var(--mygo-c-bg-alt)]" rounded-6px="" w-60px="" aspect-ratio-square="" items-center="" justify-center="" data-v-a68bfdd1=""><i text-40px="" text="[#999]" class="i-fa6-regular:user" data-v-a68bfdd1=""></i></div><div flex="~ col grow" gap-2="" lg:gap-4="" data-v-a68bfdd1=""><textarea disabled="" placeholder="ä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼Œç•™ä¸‹è¯„è®ºè¡Œä¸è¡Œ" class="mujika-git-talk-textarea" un-disabled:cursor-not-allowed="" p-2="" outline-0="" lg:p-4="" data-v-a68bfdd1=""></textarea><div flex="" items-start="" data-v-a68bfdd1=""><a target="_blank" href="https://guides.github.com/features/mastering-markdown/" data-v-a68bfdd1="">æ”¯æŒ Markdown è¯­æ³•</a><div ml-auto="" data-v-a68bfdd1=""></div><!----><button class="mujika-button" data-v-a68bfdd1="" data-v-15330f5f=""><!--[--><!--]--><!--[-->ç‚¹å‡»ç™»å½•<!--]--></button></div></div></div><!--]--></div></div><!----><!--]--></div><aside class="mujika-aside" w="280px" flex="~ col shrink-0" top-2="" sticky="" max-h="[calc(100vh-var(--spacing)*4)]" un-hidden="" lg:block=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" flex="~ col" gap-4="" data-v-7ac4adc5=""><!--[--><div p="4 b-0" flex-shrink-0="">æ–‡ç« ç›®å½•</div><div p="4 t-0" flex-grow="" min-h-0="" overflow-y-auto=""><!----></div><!--]--></div></aside><!--teleport start--><!--teleport end--></div></main><footer class="mujika-footer" px-4="" py-6="" bg="[var(--mygo-c-bg)]" flex="~ col shrink-0" gap-2="" items-center="" data-v-d1d7a153=""><div flex="" items-center="" data-v-d1d7a153=""><span data-v-d1d7a153="">Power by&nbsp;</span><i class="i-logos:vue" data-v-d1d7a153=""></i><span data-v-d1d7a153="">&nbsp;+&nbsp;</span><i class="i-logos:vitejs" data-v-d1d7a153=""></i></div><div text-center="" data-v-d1d7a153=""><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-d1d7a153="">CC BY-NC-SA 4.0 </a>2021 - PRESENT Â© Dedicatus545</div><div text="[var(--mygo-c-text-2)]" text-center="" data-v-d1d7a153="">å¦‚æœæˆ‘å’Œç‹—ä¸€æ ·æœ‰å°¾å·´çš„è¯ï¼Œä¸€å®šä¼šè—ä¸ä½è¿™ä»½å–œæ‚¦ï¼Œè€Œå°¾å·´ä¸€ç›´æ‘‡ä¸ªä¸åœå§ã€‚</div></footer></div></div></body></html>