---
title: 2021æ±‡é‡æ ¡æ‹›ç¬”è¯•é¢˜æ€»ç»“
key: 1600007636date: 2020-09-13 22:33:56
updated: 2023-02-13 18:28:43
tags:
 - JavaScript
 - å‰ç«¯ç¬”è¯•é¢˜
categories:
 - ç¬”è¯•
---


# å‰è¨€

åŒç­åŒå­¦å®ä¹ æŠŠæˆ‘å†…æ¨è¿›å»äº†...

<!-- more -->

# é¢˜ç›®

å†™ä¸‹ä¸€äº›æ¯”è¾ƒæœ‰æ„æ€çš„é¢˜ç›®

## æ‰“å¼€ä¸€ä¸ªåœ°å€åˆ°ä¸€ä¸ªç½‘é¡µçš„è¿‡ç¨‹

è¿™é‡Œå°±æŠŠè‡ªå·±çš„ç†è§£å†™å‡ºæ¥ï¼ŒåŒ…æ‹¬

- DNSçš„åŸŸååˆ°IPçš„è½¬æ¢ï¼ˆè¿™é‡Œè¯´äº†ä¸‹æœ¬åœ°çš„DNSç¼“å­˜ï¼Œä»¥åŠhostæ–‡ä»¶ï¼Œä»¥åŠDNSçš„è¿­ä»£æŸ¥è¯¢å’Œé€’å½’æŸ¥è¯¢ï¼‰
- HTTPçš„æŠ¥æ–‡æ ¼å¼ï¼ˆè¿™é‡Œè¯´äº†ä¸‹æŠ¥æ–‡åˆ†ä¸ºå“åº”å’Œè¯·æ±‚ï¼ŒHTTPçš„è¯·æ±‚æ–¹æ³•ï¼Œç„¶åè¯´äº†ç‚¹ç¼“å­˜çš„é¦–éƒ¨ï¼‰
- ä¸‰æ¬¡æ¡æ‰‹ï¼ˆè®²äº†ä¸‹å‘é€çš„æŠ¥æ–‡æ ¼å¼ï¼Œå°±æ˜¯ACKï¼ŒSYNæ€ä¹ˆå‘è¿‡æ¥å‘è¿‡å»ï¼‰
- åŸºäºTCP/IPçš„åè®®æ ˆï¼ˆè¿™é‡Œè¯´äº†ä¸‹æ•°æ®ä»HTTPå±‚å¦‚ä½•ä¸€æ­¥æ­¥ä¸‹ä¼ åˆ°ç‰©ç†å±‚ï¼‰
- æµè§ˆå™¨çš„æ¸²æŸ“ï¼ˆè¿™é‡Œç®€å•çš„è¯´äº†ä¸‹ï¼ŒæŠŠæ–‡æ¡£æ ‘å’ŒCSSOMæ ‘åˆå¹¶ä¸ºæ¸²æŸ“æ ‘ç„¶åäº¤ç»™æµè§ˆå™¨çš„æ¸²æŸ“å¼•æ“æ¸²æŸ“ï¼Œjsç”±jså¼•æ“è¿›è¡Œè§£æï¼‰

å†™äº†å°2000å­—å§ï¼Œå¯èƒ½è¿˜æ˜¯è¯´çš„å¤ªçš®æ¯›äº†...

## `display: none;` å’Œ `visibility: hidden;` çš„åŒºåˆ«ï¼Œä»¥åŠé€‚ç”¨èŒƒå›´

è¿™é‡Œå†™äº†ä¸‹`display: none`æ­¤æ—¶ä¸åœ¨æ¸²æŸ“æ ‘é‡Œé¢äº†

è€Œ`visibility: none`åªæ˜¯å˜å¾—é€æ˜äº†ï¼Œå°±åƒä¸€å—100%é€æ˜çš„ç»ç’ƒæ”¾åœ¨ä½ çœ¼å‰ï¼Œè™½ç„¶çœ‹ä¸è§ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯åœ¨é‚£é‡Œ

å»ç½‘ä¸Šçœ‹äº†çœ‹ï¼Œå‘ç°è¿˜æœ‰ä»¥ä¸‹ä¸åŒç‚¹ï¼ŒåŠ ä¸Š`opacity: 0`ä¸€èµ·åˆ†æï¼Œè¿™ä¸ªè¡¨ç¤ºä¸é€æ˜åº¦ä¸º0ï¼Œä¹Ÿå°±æ˜¯å®Œå…¨é€æ˜

- `visibility: hidden`å…·æœ‰ç»§æ‰¿æ€§ï¼Œå­å…ƒç´ å¦‚æœé‡æ–°è®¾ç½®`visibility`ä¸º`visible`é‚£ä¹ˆè¿˜æ˜¯å¯ä»¥çœ‹è§çš„ï¼Œè€Œ`display: none`æ²¡æœ‰ç»§æ‰¿æ€§

![](https://s1.ax1x.com/2020/09/16/w2txPK.png)

ä¸Šé¢æˆ‘ç»™`header`è®¾ç½®äº†`visibility: none`å¹¶ä¸”ç»™`header`çš„å­å…ƒç´ `h1`è®¾ç½®äº†`visibility: visible`ï¼Œ`h1`è¿˜æ˜¯å¯ä»¥çœ‹è§ï¼Œå¹¶ä¸”æ­¤æ—¶æ ‡é¢˜ä¸‹é¢çš„ä¿¡æ¯æ ä¾ç„¶å æ®ç€åŸæ¥çš„ä½ç½®ï¼Œå¹¶æ²¡æœ‰å‡ºç°åå¡Œï¼Œ
`post-meta`è¿˜æ˜¯å æ®ç€å¸ƒå±€çš„éƒ¨åˆ†,è€Œ`display: none`å¹¶æ²¡æœ‰ç»§æ‰¿å±æ€§ï¼Œå¹¶ä¸”åå¡Œäº†ï¼Œè§ä¸‹å›¾

![](https://s1.ax1x.com/2020/09/16/w26PED.png)

## ç¼–å†™ä¸€ä¸ª`avg`è¯·æ±‚å¹³å‡å€¼çš„å‡½æ•°

```text
è¾“å…¥
avg(1, 2, 3, 4, 5);     // 3
avg(5, null, -5);       // 0
avg('1.0', false, 1, true, 1, 'A', 1, 'B', 1, 'C');     // è¾“å‡º0.5
avg(0.1, 0.2);          // 0.15, è€Œä¸æ˜¯0.15000000000002
```

emmm è¿™é¢˜å‰ä¸‰ä¸ªè¿˜å¥½ï¼Œæ˜¯ä¸€äº›åˆ¤æ–­è€Œå·²

ä½†æ˜¯ç¬¬å››ä¸ªæˆ‘åªæ˜¯çŸ¥é“è¿™ç§æƒ…å†µï¼Œå› ä¸ºåªè¦æ˜¯ä½¿ç”¨äº†IEEE754è®¡æ•°çš„éƒ½ä¼šæœ‰è¿™ç§æƒ…å†µ

å¯ä»¥è¾“å‡º0.1å’Œ0.2çš„äºŒè¿›åˆ¶æ¥çœ‹çœ‹

```javascript
console.log((0.1).toString(2));
console.log((0.2).toString(2));
```

å‘ç°ç”±äºIEEE754å‚¨å­˜æ ¼å¼çš„é—®é¢˜ï¼Œ0.1å’Œ0.2å¹¶ä¸èƒ½å®Œå…¨çš„è¡¨ç¤ºï¼Œæ˜¯è¢«æˆªæ–­è¿‡çš„

![](https://s1.ax1x.com/2020/09/13/wBE09s.png)

è¿™å¯ä»¥è®¿é—®ä¸‹é¢ç½‘ç«™æ¥äº†è§£

- [Floating Point Math](https://0.30000000000000004.com/#ada)
- [Floating-point arithmetic - Wikipedia](https://en.wikipedia.org/wiki/Floating-point_arithmetic#Internal_representation)

IEEE754ä¸­ä½¿ç”¨äº†64ä½åŒç²¾åº¦æ¥å­˜æ•°å­—ï¼Œ11ä¸ªæ•°å­—ä½ï¼ˆæŒ‡æ•°åŸŸï¼‰ï¼Œ52ä¸ªæŒ‡æ•°ä½ï¼ˆå°¾æ•°åŸŸï¼‰ï¼Œå…¶ä¸­1ä¸ªç¬¦å·ä½ï¼Œ

![](https://s1.ax1x.com/2020/09/16/w24fC8.png)

è®¡ç®—å…¬å¼å¦‚å›¾æ‰€ç¤º

è¿™é¢˜æˆ‘å‚»é€¼çš„å°½ç„¶æƒ³ç”¨æ–°ç‰¹æ€§å¤§æ•°å»è§£å†³ï¼Œä½†æ˜¯æˆ‘åªæ˜¯ç®€å•ä½¿ç”¨è¿‡è€Œå·²ï¼Œå¹¶æ²¡æœ‰äº†è§£é€å½»ï¼Œå¯¼è‡´å†™äº†ä¸ªé€šä¸è¿‡çš„ä»£ç 
å¹¶ä¸çŸ¥é“å¤§æ•°åªèƒ½ç”¨äºæ•´æ•°ğŸ˜‚ğŸ˜‚ğŸ˜‚ğŸ˜‚

```javascript
function avg(...args) {
  const toString = Object.prototype.toString;
  args = args.filter(item => item !== null || item !== undefined)     // ä»ç¬¬äºŒæ¡å¼å­çœ‹å‡ºnullåº”è¯¥ç®—è¿›å…ƒç´ çš„ä¸ªæ•°ä¸­ï¼Œæ‰€ä»¥è¦è¿‡æ»¤æ‰ï¼ˆé¡ºä¾¿ä¹ŸæŠŠundefinedï¼Œè™½ç„¶æ²¡æœ‰æåˆ°ï¼‰
            .map(item => toString.call(item) === '[object String]' ? 0 : item)    // ä»ç¬¬ä¸‰æ¡å¼å­çœ‹å‡ºå­—ç¬¦ä¸²åº”è¯¥çœ‹æˆ0
            .map(item => BigInt(item));       // è¿™ä¸ªæˆ‘æ˜¯æƒ³é’ˆå¯¹ç¬¬å››æ¡çš„ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°è£…äº†ä¸ªå¤§é€¼ï¼Œæ²¡è£…æˆğŸ˜‚ğŸ˜‚ğŸ˜‚ğŸ˜‚
  const sum = args.reduce((pre, val) => pre + val, 0);
  return sum / BigInt(args.length);
}
```

å¤§æ•°ä¸æ”¯æŒå°æ•°ï¼Œé€šè¿‡è½¬æ¢ä¼šæŠ¥é”™

![](https://s1.ax1x.com/2020/09/16/w2caQI.png)

æ‰€ä»¥æˆ‘ç­”çš„ä»£ç ï¼Œå®Œå…¨æ˜¯é”™è¯¯çš„...

è¿™å‡ å¤©æƒ³äº†æƒ³ï¼Œä¹ŸæŸ¥äº†æŸ¥ç½‘ä¸Šçš„è§£å†³åŠæ³•ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯é€šè¿‡ä¸¤æ•°ç›¸å‡ï¼Œç„¶åå°äº`Number.EPSILON`è¿™ä¸ªå€¼ï¼Œå°±å½“ä½œä¸¤è€…ç›¸ç­‰

ä½†æ˜¯è¿™ä¸ªé€»è¾‘ä¸å…·æœ‰æ™®é€‚æ€§ï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„ä»£ç 

```javascript
function eq(n1, n2) {
  return Math.abs(n1 - n2) <= Number.EPSILON;
}

console.log(eq(0.1 + 0.2, 0.3));    // true
console.log(eq(1.1 + 2.2, 3.3));    // false
```

æœäº†å¾ˆä¹…ï¼ŒæŠ˜ä¸­çš„æ–¹æ³•æ˜¯å…ˆæ”¾å¤§æ•°å­—ï¼Œç„¶åè®¡ç®—å®Œå†ç¼©å°ï¼Œåªæœ‰è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒé è°±

```javascript
function avg(...args) {
  args = args.filter(item => item !== null || item !== undefined)
      .map(item => toString.call(item) === '[object String]' ? 0 : item)
      .map(item => Number(item))
      .map(item => item * 10000);   // æ”¾å¤§10000å€
  const sum = args.reduce((pre, cur) => pre + val, 0);
  return sum / args.length / 10000;   // ç¼©å°10000å€
}
```

æµ‹è¯•ä¸‹

![](https://s1.ax1x.com/2020/09/16/w2ItfK.png)

å¾ˆå¥½çš„è§£å†³äº†é¢˜ç›®çš„é—®é¢˜ï¼Œé¢å‘ç­”æ¡ˆç¼–ç¨‹ï¼Œå“ˆå“ˆå“ˆå“ˆğŸ˜‚ğŸ˜‚ğŸ˜‚

å½“ç„¶ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿæ²¡æœ‰æ™®é€‚æ€§ï¼Œ

å¦‚æœæ”¾å¤§ä¹‹åä¾ç„¶å‡ºç°äº†åƒ `.1 + .2` ä¾ç„¶ä¼šå‡ºç°è®¡ç®—è¯¯å·®

![](https://s1.ax1x.com/2020/09/16/w2IXX4.png)

å¦‚æœæ˜¯é¡¹ç›®ä¸Šçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨`Mathjs`è¿™ä¸ªåº“ï¼Œè¿™ä¸ªåº“æ”¯æŒå¼ºå¤§çš„è®¡ç®—è¡¨è¾¾å¼

é¡¹ç›®åœ°å€ï¼š[josdejong/mathjs](https://github.com/josdejong/mathjs)

æ ·ä¾‹ä»£ç ï¼Œæ¥è‡ªé¡¹ç›®çš„`README`

```javascript
import {
  atan2, chain, derivative, e, evaluate, log, pi, pow, round, sqrt
} from 'mathjs'

// functions and constants
round(e, 3)                    // 2.718
atan2(3, -3) / pi              // 0.75
log(10000, 10)                 // 4
sqrt(-4)                       // 2i
pow([[-1, 2], [3, 1]], 2)      // [[7, 0], [0, 7]]
derivative('x^2 + x', 'x')     // 2 * x + 1

// expressions
evaluate('12 / (2.3 + 0.7)')   // 4
evaluate('12.7 cm to inch')    // 5 inch
evaluate('sin(45 deg) ^ 2')    // 0.5
evaluate('9 / 3 + 2i')         // 3 + 2i
evaluate('det([-1, 2; 3, 1])') // -7

// chaining
chain(3)
    .add(4)
    .multiply(2)
    .done()  // 14
```

æŸ¥èµ„æ–™çš„æ—¶å€™è¿˜çœ‹åˆ°äº†JSå…³äºDecimalçš„ææ¡ˆï¼Œè¿™ä¸ªå¯ä»¥çœ‹

[tc39/proposal-decimal](https://github.com/tc39/proposal-decimal)

æ„Ÿè§‰å¾ˆæ£’ï¼Œé€šè¿‡ä½¿ç”¨ç‰¹å®šçš„åç¼€`m`æ¥æ ‡æ˜ï¼ˆå¤§æ•°æ˜¯`n`ï¼‰ï¼Œç„¶åå¯ä»¥è¿›è¡Œå®‰å…¨çš„è®¡ç®—

```javascript
function calculateBill(items, tax) {
  let total = 0m;
  for (let {price, count} of items) {
    total += price * BigDecimal(count);
  }
  return BigDecimal.round(total * (1m + tax),
                          {maximumFractionDigits: 2, round: "up"});
}

let items = [{price: 1.25m, count: 5}, {price: 5m, count: 1}];
let tax = .0735m;
console.log(calculateBill(items, tax));
```

ç›®å‰å¤„äºææ¡ˆ1ï¼Œæ„Ÿè§‰ä¸ç”¨å¾ˆä¹…å°±èƒ½ä½¿ç”¨åˆ°å’Œå¤§æ•°ç›¸ä¼¼çš„ç‰¹æ€§äº†

JSä¸€å®šä¼šè¶Šæ¥è¶Šå¥½çš„~~

# åè®°

å¤šææé¢è¯•ï¼Œç§¯ç´¯é¢è¯•é¢˜ç›®