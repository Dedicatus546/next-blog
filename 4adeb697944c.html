<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/logo.svg"><meta name="viewport" content="width=device-width,initial-scale=1"><title>JSå¦‚ä½•è§£æURLçš„å‚æ•°ï¼Ÿ</title><script type="importmap">{"imports":{"vue":"https://esm.sh/vue","vue-router":"https://esm.sh/vue-router","pinia":"https://esm.sh/pinia","@vueuse/core":"https://esm.sh/@vueuse/core","@vueuse/components":"https://esm.sh/@vueuse/components","@vueuse/router":"https://esm.sh/@vueuse/router","date-fns":"https://esm.sh/date-fns","nprogress":"https://esm.sh/nprogress","octokit":"https://esm.sh/octokit","pinia-plugin-persistedstate":"https://esm.sh/pinia-plugin-persistedstate","vue-router-better-scroller":"https://esm.sh/vue-router-better-scroller"}}</script><script type="module" async="" crossorigin="" src="/assets/app-CGnJzz9B.js"></script><link rel="stylesheet" crossorigin="" href="/assets/app-tWEfGeAP.css"><link rel="modulepreload" crossorigin="" href="/assets/JSå¦‚ä½•è§£æURLçš„å‚æ•°ï¼Ÿ-B0WSgZZv.js"><meta property="og:title" content="JSå¦‚ä½•è§£æURLçš„å‚æ•°ï¼Ÿ"><meta name="twitter:title" content="JSå¦‚ä½•è§£æURLçš„å‚æ•°ï¼Ÿ"></head><body><div id="app" data-server-rendered="true"><div class="mujika" min-h="100vh" flex="~ col" bg="[--mygo-c-bg-alt]"><header class="mujika-header" flex="~ shrink-0" px-4="" h="70px" bg="[var(--mygo-c-bg)]" items-center="" justify-between="" data-v-c1947e25=""><a href="/" class="" flex="" gap-4="" items-center="" data-v-c1947e25=""><img w="40px" aspect-ratio-square="" src="/logo.svg" alt="æ‹ã®æ­Œçš„logo" data-v-c1947e25=""></a><div data-v-c1947e25=""><div p-1="" flex="" gap-1="" rounded="6px" bg="[var(--mygo-c-bg-alt)]" data-v-c1947e25=""><!--[--><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="bg-[var(--mygo-c-bg)]" title="è‡ªåŠ¨" data-v-c1947e25=""><!--[-->Auto<!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="æ—¥é—´" data-v-c1947e25=""><!--[--><i class="i-ri:sun-line" data-v-c1947e25=""></i><!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="å¤œé—´" data-v-c1947e25=""><!--[--><i class="i-ri:moon-line" data-v-c1947e25=""></i><!--]--></div><!--]--></div></div></header><main class="mujika-home" flex="grow" mx="auto" min-h="0" p-2="" w-full="" un-2xl:w="[calc(96rem-var(--spacing)*2)]"><div flex="" gap-2="" items-start=""><div flex="~ col grow" gap-2="" min-w-0=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="~ col" mb-4="" gap-4=""><h1 break-all="" text="34px center">JSå¦‚ä½•è§£æURLçš„å‚æ•°ï¼Ÿ</h1></div><div flex="~ col" gap-3="" text="[var(--mygo-c-text-2)]"><div flex="~ wrap" gap-3="" justify-center=""><!----><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar"></i><span un-hidden="" lg:inline="">å‘è¡¨äº</span><span pl-1="">2020-10-18 14:19</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar-check"></i><span un-hidden="" lg:inline="">æ›´æ–°äº</span><span pl-1="">2023-02-13 18:28</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:folder"></i><span un-hidden="" lg:inline="">åˆ†ç±»äº</span><!--[--><a pl-1="" href="/category/ç¼–ç¨‹">ç¼–ç¨‹</a><!--]--></div></div><div flex="~ wrap" gap-3="" justify-center=""><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:file-word"></i><span un-hidden="" lg:inline="">æ€»å­—æ•°</span><span pl-1="">2.0K</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:clock"></i><span un-hidden="" lg:inline="">é˜…è¯»æ—¶é•¿ â‰ˆ</span><span pl-1="">7 åˆ†é’Ÿ</span></div></div></div><div class="mujika-doc-content"><!--[--><div class="kan-doc"><p><code>JavaScript</code>å¦‚ä½•è§£æ<code>URL</code>çš„å‚æ•°ï¼Ÿ</p><h1 id="url-è§£æ" tabindex="-1">URL è§£æ <a class="header-anchor" href="#url-è§£æ">ğŸ”—</a></h1><p>åœ¨<code>3.0</code>ç‰ˆæœ¬çš„<code>Router</code>ä¸­ï¼Œæœ‰ä¸¤ä¸ªæ ¸å¿ƒçš„å‡½æ•°æ¥å¤„ç†<code>URL</code>ï¼Œå¦‚ä¸‹ï¼š</p><ul><li><code>parseURL</code> é¢„å¤„ç†æ•´ä¸ª<code>URL</code>åœ°å€ï¼Œç„¶åæŠŠå‚æ•°éƒ¨åˆ†ä¼ ç»™ä¸‹é¢è¿™ä¸ªå‡½æ•°æ¥å¤„ç†ï¼›</li><li><code>parseQuery</code> å¤„ç†<code>URL</code>ä¸­çš„å‚æ•°éƒ¨åˆ†ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚</li></ul><p>å¯ä»¥è‡ªå·±æŠŠä»“åº“æ‹‰ä¸‹æ¥ï¼Œè¿™æ ·çœ‹èµ·æ¥æ›´æ–¹ä¾¿</p><blockquote><p><a href="https://github.com/vuejs/vue-router-next" target="_blank" rel="noopener"><code>vuejs</code>/<code>vue-router-next</code></a></p></blockquote><h1 id="parseurl" tabindex="-1">parseURL <a class="header-anchor" href="#parseurl">ğŸ”—</a></h1><p>æ‰¾åˆ°<code>src</code>ä¸‹é¢çš„<code>location.ts</code>ï¼š</p><p><img src="https://i.loli.net/2020/10/18/7hFPs2JvDrYE8fQ.png" alt=""></p><p>æ‰“å¼€æ‰¾åˆ°é‡Œé¢çš„<code>parseURL</code>ï¼š</p><p><img src="https://i.loli.net/2020/10/18/lH3Mnu6A1x7CGZD.png" alt=""></p><p>å®Œæ•´çš„<code>ts</code>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> function</span><span style="--s-dark:#80A665;--s-light:#59873A"> parseURL</span><span style="--s-dark:#666666;--s-light:#999999">(</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">  parseQuery</span><span style="--s-dark:#666666;--s-light:#999999">: (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">search</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LocationQuery</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  location</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  currentLocation</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">/</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> LocationNormalized</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999"> | </span><span style="--s-dark:#CB7676;--s-light:#AB5959">undefined</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    query</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LocationQuery</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {},</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    searchString</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    hash</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // Could use URL and URLSearchParams but IE 11 doesn't support it</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchPos</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">hashPos</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">#</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ? </span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> : </span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchPos</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    searchString</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      searchPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      hashPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> hashPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    );</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    query</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> parseQuery</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchString</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">hashPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> hashPos</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // keep the # character</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    hash</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">hashPos</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // no search and no query</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> resolveRelativePath</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !=</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> currentLocation</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // empty path means a relative query or hash `?foo=f`, `#thing`</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    fullPath</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchString</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> &amp;&amp;</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">) </span><span style="--s-dark:#CB7676;--s-light:#AB5959">+</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchString</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> hash</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    path</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    query</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    hash</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>ç”±äºåªå…³æ³¨å¦‚ä½•è§£æå‚æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°æœ‰äº›åœ°æ–¹å¿½ç•¥ã€‚</p><p>å…ˆçœ‹çœ‹å‚æ•°ï¼š</p><ul><li><p><code>parseQuery</code>ä¸€ä¸ªè§£æå‚æ•°çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä½¿å¾—è§£æå˜æˆå¯é…ç½®çš„ï¼Œä¸‹æ–‡çš„<code>parseQuery</code>ä¸ºä¸€ä¸ªå®ç°ï¼›</p></li><li><p><code>location</code>ä¸€ä¸ªç½‘å€ï¼Œæ¯”å¦‚è¿™ä¸ªå¸–å­çš„åœ°å€ï¼š <code>http://localhost:4000/2020/10/18/JS%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90URL%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%9F/</code></p></li><li><p><code>currentLocation</code>å’Œè§£æè¿‡ç¨‹æ— å…³ï¼Œä¸ç”¨åœ¨æ„å®ƒçš„æ„æ€ã€‚</p></li></ul><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchPos</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> hashPos</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">#</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span></code></pre><p>å…ˆåˆ¤æ–­äº†ç½‘å€<code>location</code>ä¸­<code>?</code>çš„ç´¢å¼•ä»¥åŠ<code>#</code>çš„ç´¢å¼•ï¼Œ<code>#</code>çš„ç´¢å¼•ä»<code>?</code>ä¹‹åå¼€å§‹æ‰¾ã€‚</p><p><code>#</code>ä¹‹åçš„å­—ç¬¦ï¼ˆåŒ…æ‹¬æœ¬èº«ï¼‰éƒ½ä¸åº”è¯¥ä½œä¸ºåœ°å€æŸ¥è¯¢å‚æ•°çš„ä¸€éƒ¨åˆ†ã€‚</p><p>æ¯”å¦‚<code>?id=1001&amp;name=#lwf</code>ï¼Œè¿™é‡Œçš„åœ°å€æŸ¥è¯¢å‚æ•°åº”è¯¥åªæœ‰<code>?id=1001&amp;name=</code>ï¼Œè€Œä¸æ˜¯<code>?id=1001&amp;name=#lwf</code>ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchPos</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  searchString</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    searchPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    hashPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> hashPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  );</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  query</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> parseQuery</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchString</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>å¦‚æœå­˜åœ¨<code>?</code>ï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨å‚æ•°ï¼ˆå› ä¸ºå¯èƒ½å°±åªæœ‰ä¸€ä¸ª<code>?</code>å­˜åœ¨ï¼Œæ­¤æ—¶æŸ¥è¯¢å‚æ•°å°±ä¸ºç©ºï¼‰ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchPos</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span></code></pre><p>æˆªå–<code>?</code>å‰é¢çš„éƒ¨åˆ†ï¼Œå’Œè§£ææ²¡ä»€ä¹ˆå…³ç³»ï¼Œå…ˆä¸ç”¨ç®¡ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">searchString</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  searchPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  hashPos</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> hashPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> location</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">);</span></span></code></pre><p>æŠŠ<code>?</code>ï¼ˆä¸åŒ…æ‹¬æœ¬èº«ï¼Œå› ä¸ºæ­¤æ—¶èµ·å§‹ç´¢å¼•ä¸º<code>searchPos + 1</code>ï¼‰å’Œ<code>#</code>ï¼ˆå¦‚æœå­˜åœ¨ï¼Œä¸åŒ…æ‹¬æœ¬èº«ï¼Œä¸å­˜åœ¨ï¼Œæˆªå–åˆ°åœ°å€æœ«å°¾ï¼‰ä¹‹é—´çš„å­—ç¬¦ä¸²æˆªå–å‡ºæ¥ã€‚</p><p>ç„¶åæ‰§è¡Œ<code>parseQuery</code>å‡½æ•°ï¼Œä¸‹é¢çš„è¿‡ç¨‹å’Œè§£æå‚æ•°å°±æ²¡ä»€ä¹ˆå…³ç³»äº†ï¼Œå¯ä»¥æ¥ç€çœ‹<code>parseQuery</code>å‡½æ•°ã€‚</p><h1 id="parsequery" tabindex="-1">parseQuery <a class="header-anchor" href="#parsequery">ğŸ”—</a></h1><p>æ‰¾åˆ°<code>src</code>ä¸‹é¢çš„<code>query.ts</code>ï¼š</p><p><img src="https://i.loli.net/2020/10/18/bkmCGHqXW62PJrV.png" alt=""></p><p>ç„¶åæ‰“å¼€æ‰¾åˆ°é‡Œé¢çš„<code>parseQuery</code>å‡½æ•°ï¼Œå°±æ˜¯<code>URL</code>åœ°å€å‚æ•°è§£æçš„æ ¸å¿ƒå‡½æ•°ã€‚</p><p><img src="https://i.loli.net/2020/10/18/uOsNxLbQVqAi684.png" alt=""></p><p>å®Œæ•´çš„<code>ts</code>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> function</span><span style="--s-dark:#80A665;--s-light:#59873A"> parseQuery</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">search</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> LocationQuery</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">query</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">LocationQuery</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {};</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // avoid creating an object with an empty key and empty value</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // because of split('&amp;')</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">search</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> search</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">hasLeadingIM</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> search</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> === </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchParams</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">hasLeadingIM</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ? </span><span style="--s-dark:#BD976A;--s-light:#B07D48">search</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> : </span><span style="--s-dark:#BD976A;--s-light:#B07D48">search</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">&amp;</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> i</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParams</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ++</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchParam</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParams</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // allow the = character</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">eqPos</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParam</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> decode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">eqPos</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ? </span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchParam</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> : </span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchParam</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> eqPos</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> eqPos</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ? null : </span><span style="--s-dark:#80A665;--s-light:#59873A">decode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchParam</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">eqPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> + </span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> in</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // an extra variable for ts types</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">      let </span><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">Array</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">isArray</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999">))</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">        currentValue</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [</span><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      }</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      currentValue</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>å¯ä»¥å…ˆçœ‹å®ƒçš„è¾“å…¥å‚æ•°</p><ul><li><code>search</code>éœ€è¦è§£æçš„ç”¨äºæœç´¢å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚<code>?id=1&amp;name=lwf</code>è¿™ç§çš„</li></ul><p>è¿”å›çš„å‚æ•°ä¸ºç±»å‹ä¸º<code>LocationQuery</code>çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥æ‰¾åˆ°å®ƒçš„å®šä¹‰ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> type</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> LocationQuery</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> Record</span><span style="--s-dark:#666666;--s-light:#999999">&lt;</span></span>
<span class="line"><span style="--s-dark:#5DA994;--s-light:#2E8F82">  string</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#5DA994;--s-light:#2E8F82">  LocationQueryValue</span><span style="--s-dark:#666666;--s-light:#999999"> |</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> LocationQueryValue</span><span style="--s-dark:#666666;--s-light:#999999">[]</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> type</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> LocationQueryValue</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> |</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span></code></pre><p>ä¹Ÿå°±æ˜¯è¿”å›ä¸€ä¸ªæ™®é€šçš„å­—é¢å¯¹è±¡ï¼Œä¸è¿‡å±æ€§çš„å€¼ä¸ºå­—ç¬¦ä¸²æˆ–è€…<code>null</code>æˆ–è€…æ˜¯è¿™ä¸¤è€…ç»„æˆçš„æ•°ç»„</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">search</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ||</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> search</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span></code></pre><p>é¦–å…ˆåˆ¤æ–­äº†ä¼ å…¥å­—ç¬¦ä¸²çš„ç‰¹æ®Šæƒ…å†µï¼Œç©ºå­—ç¬¦ä¸²å’Œå•ä¸ªé—®å·ä¸ç”¨ç»§ç»­è¿è¡Œä¸‹å»ï¼Œç›´æ¥è¿”å›ç©ºçš„å¯¹è±¡å³å¯ã€‚</p><p>åœ¨è¿™å¥è¯çš„ä¸Šé¢æœ‰ä¸€è¡Œæ³¨é‡Šï¼š</p><blockquote><p>avoid creating an object with an empty key and empty value because of split('&amp;')</p></blockquote><p>æ„æ€æ˜¯è¿™ä¸ªåˆ¤æ–­ä¸ºäº†é¿å…ç”±äº<code>split('&amp;')</code>äº§ç”Ÿé”®åä¸ºç©ºé”®å€¼ä¹Ÿä¸ºç©ºçš„æŸ¥è¯¢å‚æ•°çš„æƒ…å†µï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><p>å…ˆä¸æ€¥ï¼Œæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> hasLeadingIM</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> search</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">?</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParams</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">hasLeadingIM</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> search</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> search</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">&amp;</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span></code></pre><p>åˆ¤æ–­äº†å¼€å¤´æ˜¯å¦ä¸º<code>?</code>ï¼ˆå†…ç½®æ–¹æ³•æœ‰<code>startWith</code>ä¹Ÿå¯ä»¥åˆ¤æ–­èµ·å§‹å­—ç¬¦ä¸²ï¼‰ã€‚</p><p>ç„¶åå¦‚æœå­˜åœ¨å°±å»æ‰è¿™ä¸ª<code>?</code>ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ<code>search.slice(1)</code>ã€‚</p><p>ç„¶åä»¥<code>&amp;</code>åˆ†å‰²å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ç°åœ¨ä¼ å…¥äº†<code>?id=1001&amp;name=lwf&amp;age=13</code>ã€‚</p><p>è¿è¡Œåˆ°è¿™é‡Œ<code>searchParams</code>çš„å€¼ä¸º<code>['id=1001','name=lwf','age=13']</code>ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> i</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> i</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParams</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ++</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>æ¥ä¸‹æ¥æ˜¯å¯¹<code>searchParams</code>çš„ä¸€ä¸ªå¾ªç¯ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParam</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParams</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">i</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> eqPos</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParam</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">indexOf</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">=</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span></code></pre><p><code>searchParam</code>å˜é‡æ²¡å•¥å¥½è¯´çš„ï¼Œå°±æ˜¯<code>searchParams</code>æ•°ç»„å¾ªç¯çš„å½“å‰å€¼ã€‚</p><p><code>eqPos</code>ç¡®å®šäº†æ¯ä¸ªå­—ç¬¦ä¸²ä¸­<code>=</code>çš„ä½ç½®ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä¸º<code>-1</code>ï¼Œæ¯”å¦‚å‰é¢çš„<code>id=1001</code>ï¼Œé‚£ä¹ˆæ­¤æ—¶<code>eqPos</code>ä¸º<code>2</code>ã€‚</p><p>å¦‚æœåªæƒ³å•çº¯åˆ¤æ–­ç›®æ ‡å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨æºå­—ç¬¦ä¸²ä¸­ï¼Œä½¿ç”¨å­—ç¬¦ä¸²çš„<code>includes</code>æ–¹æ³•ä¼šæ›´å¥½ï¼ˆè¿”å›<code>true</code>æˆ–è€…<code>false</code>ï¼‰ï¼Œè¿™é‡Œä½¿ç”¨<code>indexOf</code>æ˜¯å› ä¸ºè¿”å›çš„ç´¢å¼•ä¹‹åè¦ç”¨åˆ°ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> key</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> decode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">eqPos</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParam</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> searchParam</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> eqPos</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> value</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> eqPos</span><span style="--s-dark:#666666;--s-light:#999999"> &lt;</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ?</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> :</span><span style="--s-dark:#80A665;--s-light:#59873A"> decode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">searchParam</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">slice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">eqPos</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span></code></pre><p><code>eqPos</code>å°äº<code>0</code>ï¼Œä¹Ÿå°±æ˜¯å‡ºç°äº†æŸäº›æ²¡æœ‰å€¼çš„å±æ€§åï¼Œæ¯”å¦‚<code>?id&amp;name=lwf</code>ï¼Œè¿™é‡Œçš„<code>id</code>å°±æ²¡æœ‰å¯¹åº”çš„å€¼ã€‚</p><p>å¦‚æœ<code>eqPos</code>å¤§äº<code>0</code>ï¼ˆå³å­˜åœ¨<code>=</code>ï¼‰ï¼Œé‚£ä¹ˆæŠŠå­—ç¬¦ä¸²åˆ†å‰²æˆä¸¤éƒ¨åˆ†ã€‚ã€‚</p><ul><li><code>searchParam.slice(0,eqPos)</code>åˆ†å‰²äº†<code>key</code>çš„éƒ¨åˆ†ï¼ˆ<code>slice</code>çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºéœ€è¦åˆ†å‰²çš„æœ«å°¾ï¼Œå¼€åŒºé—´ï¼Œä¹Ÿå°±æ˜¯ä¸åŒ…æ‹¬è¿™ä¸ªç´¢å¼•ï¼‰ï¼›</li><li><code>searchParam.slice(eqPos + 1)</code>åˆ†å‰²äº†<code>value</code>çš„éƒ¨åˆ†ï¼Œï¼ˆ<code>slice</code>ç¬¬äºŒä¸ªå‚æ•°é»˜è®¤å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯æˆªå–åˆ°æœ«å°¾ï¼‰ã€‚</li></ul><p>ç„¶åé€šè¿‡ä¸€ä¸ª<code>decode</code>æ¥å¯¹æ•°æ®è¿›è¡Œå¤„ç†ç„¶åä½¿ç”¨ï¼Œ<code>decode</code>å‡½æ•°å¦‚ä¸‹ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> function</span><span style="--s-dark:#80A665;--s-light:#59873A"> decode</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">text</span><span style="--s-dark:#666666;--s-light:#999999">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999"> | </span><span style="--s-dark:#5DA994;--s-light:#2E8F82">number</span><span style="--s-dark:#666666;--s-light:#999999">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82"> string</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  try</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#80A665;--s-light:#59873A"> decodeURIComponent</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">""</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> text</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> catch</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">err</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    __DEV__</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> &amp;&amp;</span><span style="--s-dark:#80A665;--s-light:#59873A"> warn</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">Error decoding "</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">text</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">". Using original value</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> ""</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> text</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p><code>decodeURIComponent</code>æ˜¯æµè§ˆå™¨å†…ç½®çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè¿˜åŸå·²ç»ç¼–ç è¿‡çš„å­—ç¬¦ä¸²ã€‚</p><p>æ¯”å¦‚<code></code>ï¼ˆç©ºæ ¼ï¼‰ä¼šè¢«ç¼–ç æˆ<code>%20</code>ã€‚</p><p>è¿™ä¸ªå¸–å­çš„åœ°å€ï¼š<code>/2020/10/18/JSå¦‚ä½•è§£æURLçš„å‚æ•°ï¼Ÿ/</code><br>ä¼šè¢«ç¼–ç æˆï¼š<code>/2020/10/18/JS%E5%A6%82%E4%BD%95%E8%A7%A3%E6%9E%90URL%E7%9A%84%E5%8F%82%E6%95%B0%EF%BC%9F/</code>ã€‚</p><p><code>decodeURIComponent</code>å‡½æ•°ä½œç”¨å°±æ˜¯è¿˜åŸæˆæœªç¼–ç å‰ï¼Œ<code>MDN</code>ä¸Šæœ‰è¯¦ç»†è®²ç¼–ç è¿™å—çš„ï¼š</p><blockquote><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/decodeURIComponent" target="_blank" rel="noopener">decodeURIComponent() - MDN web docs</a> &gt; <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent" target="_blank" rel="noopener">encodeURIComponent() - MDN web docs</a></p></blockquote><p><code>decode</code>å°è¯•è¿˜åŸç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå¤±è´¥å°±è¿”å›åŸæ¥çš„å­—ç¬¦ä¸²ã€‚</p><p>é‚£ä¹ˆåœ¨è¿™ä¸¤æ­¥ä¹‹åï¼Œæ¯”å¦‚<code>'id=1001'</code>å°±ä¼šå˜æˆ<code>key='id'</code>ä»¥åŠ<code>value='1001'</code>ã€‚</p><p>è€Œæ¯”å¦‚<code>'id'</code>è¿™ç§ï¼Œå°±ä¼šå˜æˆ<code>key='id'</code>ä»¥åŠ<code>value=null</code>ã€‚</p><p>å½“ç„¶ï¼Œæ­¤æ—¶è¿˜ä¼šå‡ºç°ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯<code>?=id&amp;name=lwf</code>ï¼Œæ­¤æ—¶<code>slice(0, 0)</code>è¿”å›äº†ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</p><p>ä¹Ÿå°±æ˜¯æ­¤æ—¶å˜æˆ<code>key=''</code>è€Œ<code>value='id'</code>ï¼Œä½†æ˜¯è¿™æ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºå­—é¢å¯¹è±¡æ”¯æŒä»¥ç©ºå­—ç¬¦ä¸²ä½œä¸ºå±æ€§åï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://i.loli.net/2020/10/18/zBaEO3JmNsIHeAo.png" alt=""></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> in</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // an extra variable for ts types</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> currentValue</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">Array</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">isArray</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999">))</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    currentValue</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [</span><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  currentValue</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ª<code>if-else</code>è¯­å¥ï¼Œåˆ¤æ–­äº†å½“å‰çš„<code>key</code>åœ¨ä¸åœ¨ç»“æœé›†<code>query</code>ä¸­ã€‚</p><p>ä¸ºä»€ä¹ˆè¦æ£€æµ‹ï¼Œå› ä¸ºæŸäº›æ—¶å€™å¯èƒ½å‡ºç°åŒåï¼Œä½†æ˜¯ä¸åŒå€¼çš„æƒ…å†µã€‚</p><p>æ¯”å¦‚<code>?id=1001&amp;name=lwf&amp;name=ghost</code>ã€‚</p><p>è¿™æ—¶é”®åä¸º<code>name</code>æœ‰ä¸¤ä¸ªå€¼ï¼š<code>lwf</code>å’Œ<code>ghost</code>ï¼Œå¤„ç†åŠæ³•å°±æ˜¯ä»¥ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨ç»“æœé›†ã€‚</p><p>åœ¨é”®åå­˜åœ¨çš„æ—¶å€™ï¼Œé€šè¿‡åˆ¤æ–­æ¥ä½¿å¾—è¯¥é”®åå¯¹åº”çš„å€¼è½¬ä¸ºæ•°ç»„ç„¶åæŠŠå½“å‰çš„å€¼å­˜è¿›å»ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> currentValue</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">Array</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">isArray</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999">))</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // ä¸æ˜¯æ•°ç»„å…ˆè½¬æˆä¸€ä¸ªæ•°ç»„</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  currentValue</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [</span><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// æŠŠå½“å‰å€¼pushè¿›å»</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">currentValue</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">value</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span></code></pre><p>ä¸è¿‡åœ¨åº”å¯¹ç›¸åŒé”®åç›¸åŒé”®å€¼æ—¶ï¼Œä¼šä½¿å¾—æ•°ç»„å­˜å…¥ç›¸åŒçš„å€¼ï¼Œæ„Ÿè§‰å¯ä»¥å»æä¸ª<code>PR</code>äº† ğŸ¤£ã€‚</p><p><img src="https://i.loli.net/2020/10/18/s7iE16HrhtKcXjZ.png" alt=""></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">query</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">key</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> value</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span></code></pre><p>ä¸å­˜åœ¨ç›¸åŒé”®åæƒ…å†µä¸‹ï¼Œç›´æ¥ä»¥è¯¥å€¼ä½œä¸ºé”®å€¼å³å¯ã€‚</p><p>å›åˆ°ä¹‹å‰é‚£ä¸ªæ³¨é‡Šï¼Œäº§ç”Ÿé”®åä¸ºç©ºé”®å€¼ä¹Ÿä¸ºç©ºçš„æŸ¥è¯¢å‚æ•°æ˜¯å¦‚ä½•å‘ç”Ÿçš„å‘¢ï¼Ÿ</p><p>å¦‚æœ<code>search</code>ä¸º<code>''</code>ï¼Œé‚£ä¹ˆåœ¨<code>split('&amp;')</code>æ‰§è¡Œä¹‹åï¼Œç»“æœä¸º<code>['']</code></p><p>æ¥ç€<code>key</code>å’Œ<code>value</code>çš„äº§ç”Ÿï¼Œç”±äºæ‰¾ä¸åˆ°<code>=</code>ï¼Œ<code>key</code>å°±ä¸º<code>''</code>ï¼Œè€Œ<code>value</code>å°±ä¸º<code>null</code>ï¼Œ</p><p>è¿”å›çš„å‚æ•°å°±å˜æˆäº†</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">query</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977">  ""</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> null</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">};</span></span></code></pre><p>è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰æ„ä¹‰çš„å‚æ•°å¯¹è±¡ï¼Œæ‰€ä»¥åŠ äº†åˆ¤æ–­é¿å…äº†è¿™ç§æƒ…å†µ</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> query</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span></code></pre><p>æœ€åå°±æ˜¯è¿”å›æ„å»ºå‡ºæ¥çš„<code>query</code>å¯¹è±¡</p><h1 id="åè®°" tabindex="-1">åè®° <a class="header-anchor" href="#åè®°">ğŸ”—</a></h1><p>æ€»ç»“èµ·æ¥æœ‰å‡ ä¸ªè¦ç‚¹ï¼š</p><ul><li>åœ°å€åˆ†å‰²ï¼Œ<code>?</code>å’Œ<code>#</code>ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼›</li><li><code>=</code>æ˜¯å¦å­˜åœ¨ï¼›</li><li>å¤š<code>value</code>å¤„ç†ï¼›</li><li>è§£ç ç¼–ç ã€‚</li></ul></div><!--]--></div><div flex="~ wrap" text="[var(--mygo-c-text-2)]" mt-8="" gap-4="" justify-center=""><!--[--><div>#JavaScript</div><div>#Vue</div><div>#Vue-Router</div><!--]--></div><!--]--></div></div><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex=""><a href="/085a4ad9e230" class=""><i class="i-mi:chevron-left" mr-1=""></i><span>Vuex@nextæºç è§£æ - storeç¯‡</span></a><a href="/80b586a52fc0" class="" ml-auto=""><span>2020å¹´è“æ¡¥æ¯é¢˜ç›®</span><i class="i-mi:chevron-right" ml-1=""></i></a></div><!--]--></div></div><!--[--><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-93b0ae89="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="" gap-4="" items-start="" data-v-93b0ae89=""><div flex="~ shrink-0" bg="[var(--mygo-c-bg-alt)]" rounded-6px="" w-60px="" aspect-ratio-square="" items-center="" justify-center="" data-v-93b0ae89=""><i text-40px="" text="[#999]" class="i-fa6-regular:user" data-v-93b0ae89=""></i></div><div flex="~ col grow" gap-4="" data-v-93b0ae89=""><textarea disabled="" placeholder="ä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼Œç•™ä¸‹è¯„è®ºè¡Œä¸è¡Œ" class="mujika-git-talk-textarea" un-disabled:cursor-not-allowed="" p-2="" outline-0="" lg:p-4="" data-v-93b0ae89=""></textarea><div flex="" items-start="" justify-between="" data-v-93b0ae89=""><a target="_blank" href="https://guides.github.com/features/mastering-markdown/" data-v-93b0ae89="">æ”¯æŒ Markdown è¯­æ³• </a><button class="mujika-git-talk-button" cursor-pointer="" data-v-93b0ae89="">ç‚¹å‡»ç™»å½•</button></div></div></div><!--]--></div></div><!----><!--]--></div><aside class="mujika-aside" w="280px" flex="~ col shrink-0" top-2="" sticky="" max-h="[calc(100vh-var(--spacing)*4)]" un-hidden="" lg:block=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" flex="~ col" gap-4="" data-v-7ac4adc5=""><!--[--><div p="4 b-0" flex-shrink-0="">æ–‡ç« ç›®å½•</div><div p="4 t-0" flex-grow="" min-h-0="" overflow-y-auto=""><!----></div><!--]--></div></aside><!--teleport start--><!--teleport end--></div></main><footer class="mujika-footer" px-4="" py-6="" bg="[var(--mygo-c-bg)]" flex="~ col shrink-0" gap-2="" items-center="" data-v-d1d7a153=""><div flex="" items-center="" data-v-d1d7a153=""><span data-v-d1d7a153="">Power by&nbsp;</span><i class="i-logos:vue" data-v-d1d7a153=""></i><span data-v-d1d7a153="">&nbsp;+&nbsp;</span><i class="i-logos:vitejs" data-v-d1d7a153=""></i></div><div text-center="" data-v-d1d7a153=""><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-d1d7a153="">CC BY-NC-SA 4.0 </a>2021 - PRESENT Â© Dedicatus545</div><div text="[var(--mygo-c-text-2)]" text-center="" data-v-d1d7a153="">å¦‚æœæˆ‘å’Œç‹—ä¸€æ ·æœ‰å°¾å·´çš„è¯ï¼Œä¸€å®šä¼šè—ä¸ä½è¿™ä»½å–œæ‚¦ï¼Œè€Œå°¾å·´ä¸€ç›´æ‘‡ä¸ªä¸åœå§ã€‚</div></footer></div></div></body></html>