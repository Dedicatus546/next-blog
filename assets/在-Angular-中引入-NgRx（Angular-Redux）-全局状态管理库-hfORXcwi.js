import{createElementBlock as n,openBlock as p,createStaticVNode as l}from"vue";import{c as t}from"./app-2Hgo7EZs.js";import"nprogress";import"pinia-plugin-persistedstate";import"vue-router";import"vue-router-better-scroller";import"@vueuse/core";import"@vueuse/components";import"@vueuse/router";import"octokit";import"pinia";import"date-fns";const e={class:"kan-doc"},E="åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“",x=1656899360,F="2022-07-04T09:49:20.000Z",b="2023-02-13T18:28:44.000Z",v=["Angular","Redux","RxJS","NgRx"],R=["ç¼–ç¨‹"],S=12917,w=[{property:"og:title",content:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“"},{name:"twitter:title",content:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“"}],j={__name:"åœ¨-Angular-ä¸­å¼•å…¥-NgRxï¼ˆAngular-Reduxï¼‰-å…¨å±€çŠ¶æ€ç®¡ç†åº“",setup(i,{expose:a}){return a({frontmatter:{title:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“",key:1656899360,date:"2022-07-04T09:49:20.000Z",updated:"2023-02-13T18:28:44.000Z",tags:["Angular","Redux","RxJS","NgRx"],categories:["ç¼–ç¨‹"],wordCount:12917,meta:[{property:"og:title",content:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“"},{name:"twitter:title",content:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“"}]}}),t({title:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“",meta:[{property:"og:title",content:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“"},{name:"twitter:title",content:"åœ¨ Angular ä¸­å¼•å…¥ NgRxï¼ˆAngular-Reduxï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“"}]}),(g,s)=>(p(),n("div",e,s[0]||(s[0]=[l(`<h1 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€">ğŸ”—</a></h1><p>åœ¨ <code>Angular</code> ä¸­å¼•å…¥ <code>NgRx</code>ï¼ˆ<code>Angular-Redux</code>ï¼‰ å…¨å±€çŠ¶æ€ç®¡ç†åº“</p><h1 id="æ­£æ–‡" tabindex="-1">æ­£æ–‡ <a class="header-anchor" href="#æ­£æ–‡">ğŸ”—</a></h1><p>åœ¨ä¹‹å‰æˆ‘ä»¬å†™è¿‡ <code>Redux</code> æºç è§£æ</p><ul><li>{% post_link Reduxæºç è§£è¯»-createStoreç¯‡ Reduxæºç è§£è¯» - createStoreç¯‡ %}</li><li>{% post_link Reduxæºç è§£è¯»-combineReducersç¯‡ Reduxæºç è§£è¯» - combineReducersç¯‡ %}</li><li>{% post_link Reduxæºç è§£è¯»-applyMiddlewareç¯‡ Reduxæºç è§£è¯» - applyMiddlewareç¯‡ %}</li><li>{% post_link Reduxæºç è§£è¯»-bindActionCreatorsç¯‡ï¼ˆå®Œç»“ï¼‰ Reduxæºç è§£è¯» - bindActionCreatorsç¯‡ï¼ˆå®Œç»“ï¼‰ %}</li></ul><p>åœ¨ <code>Redux</code> ä¸­ï¼Œæ ¸å¿ƒå°±æ˜¯ä¸‰ä¸ªæ¦‚å¿µï¼Œ <code>Action</code>, <code>Store</code>, <code>Reducer</code></p><p>é€šè¿‡ <code>dispatch</code> ï¼ˆåˆ†å‘ï¼‰ <code>Action</code> ç»™ <code>Reducer</code> ï¼Œ<code>Reducer</code> æ ¹æ® <code>Action</code> æ¥ç”Ÿæˆæ–°çš„çŠ¶æ€ï¼Œæ›´æ–°åˆ° <code>Store</code> ä¸­</p><p><code>Redux</code> æ˜¯æ¡†æ¶æ— å…³çš„ï¼Œåœ¨ <code>React</code> ä¸­æœ‰ç›¸å…³çš„ <code>React-Redux</code> åº“ï¼Œè€Œ <code>Angular</code> ä¹Ÿæœ‰ç›¸å…³çš„ <code>NgRx</code> åº“</p><p>è™½ç„¶åœ¨ <code>Angular</code> ä¸­ï¼Œå…¶å®ä¸æ˜¯ç‰¹åˆ«ä¾èµ–çŠ¶æ€ç®¡ç†ï¼Œæœ¬èº«çš„ <code>DI</code> åŠŸèƒ½å…¶å®å°±èƒ½å®ç°çŠ¶æ€ç®¡ç†</p><p>è™½ç„¶èƒ½å¤Ÿé€šè¿‡ <code>DI</code> æ¥å®ç°ï¼Œä½†æ˜¯å¯¹å¼‚æ­¥çš„å¤„ç†å¯èƒ½ä¸å°½äººæ„ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸€ä¸ªè§„èŒƒæ¥çº¦æŸä»£ç æ ¼å¼ï¼Œå¤šäººå¼€å‘ä¸‹å¯èƒ½å­˜åœ¨å¤šç§å†™æ³•çš„é—®é¢˜</p><p>ä¸ªäººè§‰å¾—ä½¿ç”¨ç±»åº“ï¼ˆä¸åªå±€é™äº <code>NgRx</code>ï¼‰çš„å¥½å¤„ä¸ä»…ä»…æ˜¯äº«å—ç±»åº“å¸¦æ¥çš„ <code>API</code> ï¼Œå¦ä¸€ä¸ªæ–¹é¢ç±»åº“ç»™äº†å†™æ³•ï¼Œä¿è¯äº†å¤šäººå¼€å‘ä¸‹ä»£ç çš„å¯ç»´æŠ¤æ€§</p><p>ä»¥ä¸‹ä»£ç ä¼šä»¥ç™»é™†æµç¨‹æ¥ä½œä¸ºä¾‹å­</p><h2 id="åˆ›å»º-action" tabindex="-1">åˆ›å»º Action <a class="header-anchor" href="#åˆ›å»º-action">ğŸ”—</a></h2><p>åœ¨ä½¿ç”¨ <code>NgRx</code> å‰ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥å®ƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>ng add @ngrx/store@latest</code></p><p>é€šè¿‡åŒ…åå¯çŸ¥ï¼Œ<code>NgRx</code> å…¶å®è¿˜æœ‰å…¶ä»–çš„æ¨¡å—ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬åªéœ€å¼•å…¥ <code>store</code> æ¨¡å—å³å¯ï¼Œå®ƒå°±å¯ä»¥å®Œæˆ <code>Redux</code> çš„æœ€åŸºæœ¬çš„åŠŸèƒ½</p><p><code>Action</code> ä»£è¡¨ä¸€ç»„åŠ¨ä½œï¼Œè¡¨æ˜æƒ³è¦å¹²ä»€ä¹ˆã€‚å®ƒå¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œå¦‚ä¸‹</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">action</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  type</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Action name</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  payload</span><span style="--s-dark:#666666;--s-light:#999999;">: {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ... è½½è·é™„å¸¦çš„å†…å®¹</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>å…¶ä¸­ <code>payload</code> å­—æ®µå¹¶ä¸æ˜¯å¿…è¦çš„ï¼Œä¹Ÿä¸æ˜¯å¿…é¡»ä¸ºå¯¹è±¡ï¼Œåªæ˜¯è®¾ä¸ºå¯¹è±¡å¯ä»¥ä¼ é€’æ›´å¤šçš„æ•°æ®è€Œå·²ï¼Œå®Œå…¨å¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ–è€…æ•°å­—ï¼Œæˆ–è€…å¸ƒå°”å€¼ç­‰åŸºæœ¬ç±»å‹</p><p>åœ¨ <code>NgRx</code> ä¸­ï¼Œæä¾›äº† <code>createAction</code> è¿™ä¸ª <code>API</code> æ¥ç»™æˆ‘ä»¬åˆ›å»º <code>Action</code> çš„å·¥å‚å¯¹è±¡</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// user.action.ts</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">[Action] login</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span></code></pre><p>è¿™æ ·å­ï¼Œæˆ‘ä»¬å°±åˆ›å»ºäº†ä¸€ä¸ª <code>loginAction</code> çš„å·¥å‚å‡½æ•° <code>createLoginAction</code></p><p>åªè¦æ‰§è¡Œ <code>createLoginAction()</code> æˆ‘ä»¬å°±èƒ½å¾—åˆ°ä¸€ä¸ª <code>Action</code> å¯¹è±¡äº†</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041537882.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041537882.avif" alt=""></a></p><p>å¯ä»¥çœ‹åˆ°ä»–åªæ˜¯ä¸€ä¸ªæ™®é€šçš„å­—é¢å¯¹è±¡</p><p>ä½¿ç”¨ <code>createAction</code> çš„å¥½å¤„æ˜¯è¯¥ <code>API</code> æä¾›äº†å®Œæ•´çš„ç±»å‹çº¦æŸ</p><p>è¿™é‡Œæˆ‘ä»¬åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªåªå«æœ‰ <code>type</code> å­—æ®µçš„ <code>Action</code> ï¼Œä½†å®é™…ä¸Šå¯¹äºç™»å½•æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¼ é€’ç”¨æˆ·çš„ç”¨æˆ·åï¼Œå¯†ç ç­‰ç­‰</p><p><code>createAction</code> çš„ç¬¬äºŒä¸ªå‚æ•°å…è®¸æˆ‘ä»¬æ‰§è¡Œä¸€ä¸ªå·¥å…·å‡½æ•°æ¥è¡¨æ˜ <code>payload</code> è½½è·ç±»å‹</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> props</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">  &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">[Action] login</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  props</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;{</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    password</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }&gt;()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">);</span></span></code></pre><p>æˆ‘å¯¹ç±»å‹ä½“æ“å…¶å®äº†è§£ä¸å¤šï¼Œç¡®å®æ˜¯éå¸¸ç¥å¥‡ï¼Œä¸æ‡‚ä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œä¸å½±å“æˆ‘ä»¬ç†è§£ä»£ç </p><p>åœ¨é™å®š <code>payload</code> è½½è·ç±»å‹ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡ <code>createLoginAction</code> åˆ›å»º <code>loginAction</code> æ—¶å°±è¦é€šè¿‡å‚æ•°æ¥ä¼ é€’è½½è·äº†</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041556801.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041556801.avif" alt=""></a></p><p>å¦‚æœä¸ä¼ é€’æ˜¯é€šè¿‡ä¸äº†ç±»å‹æ£€æŸ¥çš„ï¼Œä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥èƒ½å¤Ÿæé«˜ä»£ç çš„å¥å£®æ€§</p><p>æˆ‘ä»¬ä¼ å…¥è½½è·å¯¹è±¡ä¹‹åæ‰“å°è¯¥ <code>Action</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041558210.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041558210.avif" alt=""></a></p><p>å¯ä»¥å‘ç°è¿”å›çš„å¯¹è±¡å¹¶æ²¡æœ‰é€šè¿‡ <code>payload</code> å­—æ®µæ¥å­˜æ”¾è½½è·ï¼Œè€Œæ˜¯ç›´æ¥æ‰å¹³åˆ° <code>type</code> å±æ€§çš„å¯¹è±¡ä¸­</p><p>åè¿‡æ¥æ„å‘³ç€ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ <code>props</code> ä¸Šå¢åŠ  <code>type</code> å±æ€§ï¼Œä¼šæŠ¥é”™</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041601692.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/04/202207041601692.avif" alt=""></a></p><p>å¦‚æœæˆ‘ä»¬çœŸçš„å¿…é¡»ä½¿ç”¨åˆ° <code>type</code> å±æ€§æ¥è¡¨ç¤ºæŸäº›ä¿¡æ¯çš„è¯ï¼Œé‚£æˆ‘ä»¬åªèƒ½ä»¥åµŒå¥—çš„å½¢å¼æ¥åˆ›å»ºç»“æ„äº†ï¼Œæ¯”å¦‚ä½¿ç”¨ <code>payload</code> å­—æ®µæ¥å­˜æ”¾è½½è·</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> props</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">  &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">[Action] login</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  props</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;{</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    payload</span><span style="--s-dark:#666666;--s-light:#999999;">: {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      type</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">student</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;"> | </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">teacher</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      password</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }&gt;()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">);</span></span></code></pre><p>å½“ç„¶æˆ‘è§‰å¾—æ²¡æœ‰å¿…è¦ï¼Œä¿æŒå¯¹è±¡çš„ç®€æ´ï¼Œä¸è¦å‡ºç°è¿‡æ·±çš„åµŒå¥—æ‰æ˜¯ä¸€ä¸ªå¥½çš„ç¼–ç è¡Œä¸º</p><h2 id="åˆ›å»º-reducer" tabindex="-1">åˆ›å»º Reducer <a class="header-anchor" href="#åˆ›å»º-reducer">ğŸ”—</a></h2><p>æœ‰äº† <code>Action</code>ï¼Œ æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ª <code>Reducer</code> æ¥å¤„ç†è¿™äº› <code>Action</code>ï¼Œç„¶åè¿”å›æ–°çš„çŠ¶æ€</p><p>åœ¨ <code>Redux</code> ä½“ç³»ä¸­ï¼Œ <code>Reducer</code> çš„ä½œç”¨å…¶å®éå¸¸çš„ç®€å•ï¼Œä¼ å…¥ <code>State</code> å’Œ <code>Action</code> ï¼Œç„¶åè¿”å›æ–°çš„ <code>State</code> ï¼Œä»…æ­¤è€Œå·²</p><p>åœ¨ <code>NgRx</code> ä¸­ï¼Œ å’Œ <code>createAction</code> ä¸€æ ·ä¹Ÿå­˜åœ¨ <code>createReducer</code> è¿™ä¸ª <code>API</code> æ¥å¸®åŠ©æˆ‘ä»¬åˆ›å»º <code>Reducer</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// user.reducer.ts</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> createReducer</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> on</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userReducer</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createReducer</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    password</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  on</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">state</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;"> })</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      ...</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">state</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      password</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  })</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">);</span></span></code></pre><p>å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯é»˜è®¤åˆå§‹çš„ <code>State</code> ï¼Œæ¥ä¸‹æ¥çš„å‚æ•°éƒ½æ˜¯ä»¥è°ƒç”¨ <code>on</code> å‡½æ•°æ¥è¡¨æ˜åœ¨ä½•ç§ <code>Action</code> ä¸‹è¿›è¡Œç‰¹å®šçš„çŠ¶æ€æ›´æ–°</p><p><code>on</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸º <code>createAction</code> ç”Ÿæˆçš„å·¥å‚å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå›è°ƒï¼Œå›è°ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå½“å‰çš„çŠ¶æ€ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè½½è·</p><p>éœ€è¦è¿”å›æ–°çš„çŠ¶æ€ï¼Œè€Œè¿™ä¸ªæ–°çš„çŠ¶æ€ä¼šæ›´æ–°åˆ° <code>Store</code> ä¸­</p><p>è¿™ç§å†™æ³•æ›´åˆ©äºä»£ç çš„åˆ†å‰²ï¼Œåœ¨åŸç”Ÿçš„ <code>Redux</code> ä¸‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ <code>switch-case</code> è¯­å¥æ¥å®Œæˆ <code>Action type</code> çš„åˆ¤æ–­å’Œç›¸åº”çš„é€»è¾‘ï¼Œä»£ç ä¼šæ‰åœ¨ä¸€ä¸ªå‡½æ•°çš„å†…éƒ¨ï¼Œé€»è¾‘å¤æ‚ä¼šä½¿å¾—æ•´ä¸ªå‡½æ•°å˜å¾—å¤æ‚ï¼Œä¸åˆ©äºç»´æŠ¤</p><h2 id="åˆ›å»º-store" tabindex="-1">åˆ›å»º Store <a class="header-anchor" href="#åˆ›å»º-store">ğŸ”—</a></h2><p>åœ¨åˆ›å»ºå®Œ <code>Action</code> å’Œ <code>Reducer</code> ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å‘ <code>Angular</code> ä¸­æ³¨å…¥ <code>Store</code></p><p>æˆ‘ä»¬éœ€è¦åœ¨æ ¹æ¨¡å—ä¸­ä½¿ç”¨ <code>StoreModule.forRoot</code> æ¥æ³¨å…¥</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> StoreModule</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> userReducer</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">./user.reducer</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">@</span><span style="--s-dark:#80A665;--s-light:#59873A;">NgModule</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  imports</span><span style="--s-dark:#666666;--s-light:#999999;">: [</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    StoreModule</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">forRoot</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      user</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userReducer</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    })</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  ]</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">})</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> AppModule</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span></code></pre><h2 id="æ³¨å…¥-store" tabindex="-1">æ³¨å…¥ Store <a class="header-anchor" href="#æ³¨å…¥-store">ğŸ”—</a></h2><p>åœ¨å®Œæˆä»¥ä¸Šä¸‰ä¸ªæ­¥éª¤ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å†™ç•Œé¢äº†</p><p>ç”±äºæˆ‘ä»¬æ˜¯ä»¥ç™»å½•æµç¨‹ä¸ºä¾‹å­ï¼Œæˆ‘ä»¬å°±å†™ä¸ªç®€å•çš„ç™»å½•ç•Œé¢</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> Component</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@angular/core</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> FormBuilder</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@angular/forms</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">@</span><span style="--s-dark:#80A665;--s-light:#59873A;">Component</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  selector</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">\`</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">[app-index-login]</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">\`</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  template</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">\`</span></span>
<span class="line"><span style="--s-dark:#C98A7D;--s-light:#B56959;">    &lt;form class=&quot;login-form&quot; [formGroup]=&quot;loginFrom&quot; (ngSubmit)=&quot;submit()&quot;&gt;</span></span>
<span class="line"><span style="--s-dark:#C98A7D;--s-light:#B56959;">      &lt;input type=&quot;text&quot; formControlName=&quot;username&quot; /&gt;</span></span>
<span class="line"><span style="--s-dark:#C98A7D;--s-light:#B56959;">      &lt;br /&gt;</span></span>
<span class="line"><span style="--s-dark:#C98A7D;--s-light:#B56959;">      &lt;input type=&quot;password&quot; formControlName=&quot;password&quot; /&gt;</span></span>
<span class="line"><span style="--s-dark:#C98A7D;--s-light:#B56959;">      &lt;br /&gt;</span></span>
<span class="line"><span style="--s-dark:#C98A7D;--s-light:#B56959;">      &lt;button type=&quot;submit&quot;&gt;login&lt;/button&gt;</span></span>
<span class="line"><span style="--s-dark:#C98A7D;--s-light:#B56959;">    &lt;/form&gt;</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">  \`</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  styleUrls</span><span style="--s-dark:#666666;--s-light:#999999;">: [</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">./login.view.less</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">],</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">})</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> LoginView</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  loginFrom</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">fb</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">group</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">fb</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">control</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Par9uet</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">),</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    password</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">fb</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">control</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Par9uet</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">),</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> fb</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">FormBuilder</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  submit</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">loginFrom</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">getRawValue</span><span style="--s-dark:#666666;--s-light:#999999;">());</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>ç„¶åæˆ‘ä»¬ç‚¹å‡» <code>login</code> æŒ‰é’®æµ‹è¯•ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051101033.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051101033.avif" alt=""></a></p><p>å‘ç°æ²¡æœ‰é—®é¢˜</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ³¨å…¥ <code>Store</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> Component</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> OnDestroy</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> OnInit</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@angular/core</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> FormBuilder</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@angular/forms</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">./user.action</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> Store</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">@</span><span style="--s-dark:#80A665;--s-light:#59873A;">Component</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">})</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> LoginView</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> implements</span><span style="--s-dark:#80A665;--s-light:#59873A;"> OnInit</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#80A665;--s-light:#59873A;"> OnDestroy</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  loginFrom</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">fb</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">group</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">fb</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">control</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Par9uet</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">),</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    password</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">fb</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">control</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Par9uet</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">),</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> fb</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">FormBuilder</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // æ³¨å…¥ Store</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> store</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Store</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  )</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  submit</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#666666;--s-light:#999999;">{</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">loginForm</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">getRawValue</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    if</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> &amp;&amp;</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">      // åˆ†å‘ Action</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">      this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">store</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">dispatch</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">        createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">          username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">          password</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">        })</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      );</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  ngOnInit</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ä¸ºäº†èƒ½å¤Ÿè§‚å¯Ÿåˆ°å˜åŒ–ï¼Œè¿™é‡Œéœ€è¦è®¢é˜… Store</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">    this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">store</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      .</span><span style="--s-dark:#80A665;--s-light:#59873A;">pipe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#80A665;--s-light:#59873A;">takeUntil</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">destroy$</span><span style="--s-dark:#666666;--s-light:#999999;">))</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      .</span><span style="--s-dark:#80A665;--s-light:#59873A;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">val</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">val</span><span style="--s-dark:#666666;--s-light:#999999;">));</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  ngOnDestroy</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">    this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">destroy$</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">next</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">    this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">destroy$</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">complete</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>ç‚¹å‡»ä¹‹åæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ° <code>Store</code> å†…çš„å€¼ç¡®å®å‘ç”Ÿäº†å˜åŒ–</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051113980.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051113980.avif" alt=""></a></p><h2 id="ä½¿ç”¨-redux-æ‰©å±•" tabindex="-1">ä½¿ç”¨ Redux æ‰©å±• <a class="header-anchor" href="#ä½¿ç”¨-redux-æ‰©å±•">ğŸ”—</a></h2><p>å½“ç„¶ï¼Œå¦‚æœæ¯æ¬¡æˆ‘ä»¬æƒ³çœ‹ <code>Store</code> çš„å†…éƒ¨æƒ…å†µå°±å»å†™è¿™äº›æ ·æ¿ä»£ç çš„è¯ï¼Œå¤ªéº»çƒ¦äº†</p><p>æˆ‘ä»¬éœ€è¦æ›´åŠ æ–¹ä¾¿çš„å½¢å¼</p><p><code>NgRx</code> æä¾›äº†ä¸€ä¸ª <code>@ngrx/store-devtools</code> çš„æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—å¯ä»¥å’Œ <code>redux</code> çš„å®˜æ–¹æ‰©å±•é…åˆï¼Œåœ¨ <code>f12</code> ä¸‹æŸ¥çœ‹è¯¦ç»†çš„ä¿¡æ¯</p><p>é¦–å…ˆæˆ‘ä»¬è¦å®‰è£… <code>Redux</code> æ‰©å±•ï¼Œè¿™ä¸ªç›´æ¥åœ¨ <code>Chrome</code> ç½‘ä¸Šå•†åº—ä¸Šæœç´¢å³å¯æ‰¾åˆ°ï¼Œç¡®ä¿ <code>Redux</code> å®‰è£…åˆ° <code>Chrome</code> ä¸­</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051134566.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051134566.avif" alt=""></a></p><p>æ¥ç€å¼•å…¥ <code>@ngrx/store-devtools</code> ï¼Œæ§åˆ¶å°æ‰§è¡Œ <code>ng add @ngrx/store-devtools@latest</code></p><p>ç„¶ååœ¨æ ¹æ¨¡å—ä¸Šä½¿ç”¨ <code>StoreDevtoolsModule.instrument</code> æ³¨å†Œè¿™ä¸ªæ¨¡å—</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// ...</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> StoreModule</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> StoreDevtoolsModule</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store-devtools</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">@</span><span style="--s-dark:#80A665;--s-light:#59873A;">NgModule</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  imports</span><span style="--s-dark:#666666;--s-light:#999999;">: [</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    StoreModule</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">forRoot</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      user</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userReducer</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }),</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    StoreDevtoolsModule</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">instrument</span><span style="--s-dark:#666666;--s-light:#999999;">(),</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  ],</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">})</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> AppModule</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span></code></pre><p>å®Œæˆä¸Šé¢çš„æ“ä½œä¹‹åï¼Œæˆ‘ä»¬æ‰“å¼€ <code>Redux</code> æ‰©å±•çš„é¢æ¿ï¼Œå°±å¯ä»¥çœ‹åˆ°å†…éƒ¨çš„æƒ…å†µäº†ï¼ŒåŒ…æ‹¬ <code>Action</code> çš„åˆ†å‘æ—¶é—´çº¿ï¼Œ<code>Store</code> çš„çŠ¶æ€å˜åŒ–ç­‰ç­‰</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051142183.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051142183.avif" alt=""></a></p><h2 id="åˆ›å»º-effect-å‰¯ä½œç”¨" tabindex="-1">åˆ›å»º Effect å‰¯ä½œç”¨ <a class="header-anchor" href="#åˆ›å»º-effect-å‰¯ä½œç”¨">ğŸ”—</a></h2><p>åˆ°æ­¤ <code>Redux</code> æœ€åŸºæœ¬çš„åŠŸèƒ½æˆ‘ä»¬å·²ç»å®Œæˆäº†</p><p>å¯èƒ½æœ‰äººä¼šè¯´ï¼Œä½ ä¸æ˜¯è¯´è¿™æ˜¯ç™»å½•åŠŸèƒ½å—ï¼Œä½ æŠŠç”¨æˆ·åï¼Œå¯†ç æ”¾ <code>Store</code> é‡Œé¢æœ‰ä»€ä¹ˆç”¨ï¼Œè¿™ä¸æ˜¯è„±è£¤å­æ”¾å±å—</p><p>ç¡®å®ï¼Œç¡®å®æ˜¯è„±è£¤å­æ”¾å±</p><p>æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ”¹è¿›è¿™ä¸ªä¾‹å­</p><p>å¯¹äº <code>Store</code> é‡Œç”¨æˆ·çš„ä¿¡æ¯ï¼Œä¸€èˆ¬æˆ‘ä»¬æ˜¯ä¸å­˜ç”¨æˆ·åå¯†ç çš„ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ²¡æœ‰æ„ä¹‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬å­˜ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åçš„ä¿¡æ¯ï¼Œæ¯”å¦‚ <code>id</code>ï¼Œç”¨æˆ·åï¼Œé‚®ç®±ï¼Œç­¾åï¼Œæ‰‹æœºå·ç­‰ç­‰</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬æ”¹é€ ä¸‹ <code>Store</code> çš„æ ¼å¼</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// user.action.ts</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginSuccessAction</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">  &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">[Action] login success</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  props</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;{</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    id</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">number</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    email</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    sign</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }&gt;()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginFailureAction</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">  &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">[Action] login failure</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  props</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;{</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    errorMsg</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }&gt;()</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// user.reducer.ts</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userReducer</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createReducer</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    id</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">-</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">1</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    email</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">    sign</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  on</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginSuccessAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">state</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> id</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> email</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> sign</span><span style="--s-dark:#666666;--s-light:#999999;"> })</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      ...</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">state</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      id</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      email</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      sign</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }),</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  on</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginFailureAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">state</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> payload</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      id</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">-</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">1</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      email</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      sign</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  })</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">);</span></span></code></pre><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ²¡æœ‰ <code>createLoginAction</code> è¿™ä¸ªå·¥å‚äº†</p><p>æˆ‘ä»¬ä½¿ç”¨ <code>createLoginSuccessAction</code> æ¥ä»£è¡¨ç™»å½•æˆåŠŸï¼Œä½¿ç”¨ <code>createLoginFailureAction</code> ä»£è¡¨ç™»å½•å¤±è´¥</p><p>ç„¶åæˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªç™»å½•æ¥å£</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// user.api.ts</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> Injectable</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@angular/core</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> interval</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> map</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> take</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> throwError</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">rxjs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">@</span><span style="--s-dark:#80A665;--s-light:#59873A;">Injectable</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  providedIn</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">root</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">})</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> UserApi</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  login</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    password</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  ):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;{</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    id</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">number</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    email</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    sign</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">string</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    if</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Par9uet</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> &amp;&amp;</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Par9uet</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">      // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿæ¥å£</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">      return</span><span style="--s-dark:#80A665;--s-light:#59873A;"> interval</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">300</span><span style="--s-dark:#666666;--s-light:#999999;">).</span><span style="--s-dark:#80A665;--s-light:#59873A;">pipe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">        take</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">1</span><span style="--s-dark:#666666;--s-light:#999999;">),</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">        map</span><span style="--s-dark:#666666;--s-light:#999999;">(()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> ({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">          id</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">24</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">          username</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">Par9uet</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">          email</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">1607611087@qq.com</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">          sign</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">ç± ã®ä¸­ã«é³¥</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">        }))</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      );</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#80A665;--s-light:#59873A;"> throwError</span><span style="--s-dark:#666666;--s-light:#999999;">(()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> new</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">è´¦å·å¯†ç é”™è¯¯</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">));</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>æ”¹é€ ç»„ä»¶çš„ <code>submit</code> æ–¹æ³•</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> LoginView</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> fb</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">FormBuilder</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> store</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Store</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // æ³¨å…¥ API</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> userApi</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">UserApi</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  )</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  submit</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#666666;--s-light:#999999;">{</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">loginForm</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">getRawValue</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    if</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> &amp;&amp;</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">      this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userApi</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">login</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;">).</span><span style="--s-dark:#80A665;--s-light:#59873A;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">        next</span><span style="--s-dark:#666666;--s-light:#999999;">: (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userInfo</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; {</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">          this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">store</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">dispatch</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#80A665;--s-light:#59873A;">createLoginSuccessAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userInfo</span><span style="--s-dark:#666666;--s-light:#999999;">));</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">        },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">        error</span><span style="--s-dark:#666666;--s-light:#999999;">: (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Error</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; {</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">          this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">store</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">dispatch</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">            createLoginFailureAction</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">              errorMsg</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">message</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">            })</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">          );</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">        },</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>ç„¶åæˆ‘ä»¬åˆ·æ–°é¡µé¢ï¼Œæ‰“å¼€ <code>Redux</code> æ‰©å±•</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051532128.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051532128.avif" alt=""></a></p><p>å¯ä»¥çœ‹åˆ° <code>Store</code> è¢«æ­£ç¡®çš„åˆå§‹åŒ–äº†</p><p>ç„¶åæˆ‘ä»¬ç‚¹å‡»ç™»å½•ï¼Œè¿™æ—¶åœ¨ <code>300ms</code> ä¹‹åç™»å½•æˆåŠŸä¹‹åæ›´æ–°äº† <code>Store</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051533904.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051533904.avif" alt=""></a></p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨¡æ‹Ÿç™»å½•å¤±è´¥çš„æƒ…å†µï¼ˆè¿™é‡Œä¿®æ”¹ <code>password</code> ä¸º <code>abcd</code>ï¼Œè¿™æ · <code>login</code> ä¼šè¿”å›ä¸€ä¸ª <code>error</code> çš„ <code>Observable</code>ï¼‰</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051540825.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051540825.avif" alt=""></a></p><p>çœ‹èµ·æ¥è¿™ä¸ªæµç¨‹å·²ç»å¾ˆä¸é”™äº†</p><p>æˆ‘ä»¬åœ¨ <code>http</code> è¯·æ±‚ä¹‹åå»æ›´æ–° <code>Store</code> çŠ¶æ€</p><p>ä½†è¿™æœ‰ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œå°±æ˜¯ <code>UI</code> è€¦åˆäº†ä¸šåŠ¡é€»è¾‘ï¼Œè¿™é‡Œæ˜¯ <code>api</code> çš„è°ƒç”¨</p><p>å‡å¦‚ç°åœ¨æˆ‘ä»¬éœ€è¦å…¨å±€ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œåœ¨ <code>page1</code> å’Œ <code>page2</code> ä¸Šéƒ½å¯ä»¥å¯¹è¿™ä¸ªåˆ—è¡¨è¿›è¡Œæ›´æ–°</p><p>é‚£ä¹ˆæŒ‰ç…§ä¸Šé¢çš„é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸¤ä¸ªé¡µé¢ä¸­è°ƒç”¨ <code>api</code> ï¼Œç„¶ååœ¨ <code>api</code> æˆåŠŸè¿”å›çš„æ—¶å€™æ›´æ–°åˆ—è¡¨ï¼Œå¤±è´¥çš„æ—¶å€™æŠŠåˆ—è¡¨ç½®ç©º</p><p>ç†æƒ³çŠ¶æ€ä¸‹åº”è¯¥æ˜¯ <code>UI</code> æå‡ºï¼šâ€œæˆ‘è¦æ›´æ–°åˆ—è¡¨ï¼Œè‡³äºè¯¥æ€ä¹ˆæ›´æ–°ï¼Œæˆ‘ä¸ç®¡ã€‚â€</p><p>æ²¡é”™ï¼Œç™»å½•æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª <code>Action</code> ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥å‘å‡ºä¸€ä¸ª <code>Action</code> ï¼Œè¿™ä¸ª <code>Action</code> æ¥è°ƒç”¨ <code>api</code> è·å–æ•°æ®ï¼Œç„¶åæ›´æ–° <code>Store</code> ï¼Œè¿™æ ·å­æˆ‘ä»¬å°±æŠŠ <code>UI</code> å’Œä¸šåŠ¡åˆ†å‰²å¼€äº†</p><p>ä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ <code>Reducer</code> ä¸­ï¼Œåˆ†å‘ <code>Action</code> æ¥æ›´æ–° <code>Store</code> çš„è¡Œä¸ºæ˜¯åŒæ­¥çš„ï¼Œé‚£ä¹ˆåº”è¯¥å¦‚æœå»ç”Ÿæˆä¸€ä¸ªå¼‚æ­¥çš„æ“ä½œå‘¢</p><p>åœ¨å®˜æ–¹ <code>Redux</code> åº“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸­é—´ä»¶æ¥åŒ…è£… <code>dispatch</code> ï¼Œä½¿å…¶æ‹¥æœ‰å¼‚æ­¥çš„èƒ½åŠ›</p><p>è€Œåœ¨ <code>NgRx</code> ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>Effect</code> æ¥è¡¨æ˜ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæ›´å‡†ç¡®æ¥è¯´ï¼Œä½¿ç”¨ <code>Effect</code> æ¥è¡¨ç¤ºä¸€ä¸ªå‰¯ä½œç”¨</p><p>è¦ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ <code>NgRx</code> çš„ <code>Effect</code> æ¨¡å—ï¼Œæ§åˆ¶å°æ‰§è¡Œ <code>ng add @ngrx/effects@latest</code></p><p>ç°åœ¨æˆ‘ä»¬éœ€è¦ <code>dispatch</code> ä¸€ä¸ª <code>loginAction</code> ï¼Œè¿™ä¸ª <code>loginAction</code> ä¼šå»å‘å‡ºä¸€ä¸ªç™»å½•çš„è¯·æ±‚ï¼Œè¯·æ±‚æˆåŠŸå‘å‡º <code>loginSuccessAction</code>ï¼Œå¤±è´¥å‘å‡º <code>loginFailureAction</code></p><p>æˆ‘ä»¬éœ€è¦ä¸ºè¿™ä¸ª <code>Effect</code> ç¼–å†™ä¸€ä¸ªæœåŠ¡</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> Injectable</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@angular/core</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> UserApi</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">./user.api</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> Actions</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> createEffect</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> ofType</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/effects</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  createLoginFailureAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  createLoginSuccessAction</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">./user.action</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> catchError</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> map</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> mergeMap</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> of</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">rxjs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">@</span><span style="--s-dark:#80A665;--s-light:#59873A;">Injectable</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  providedIn</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">root</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">})</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> UserEffect</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  login$</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createEffect</span><span style="--s-dark:#666666;--s-light:#999999;">(()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">    this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">actions</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">pipe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">      ofType</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;">),</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">      mergeMap</span><span style="--s-dark:#666666;--s-light:#999999;">(({</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;"> })</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">        this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userApi</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">login</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;">).</span><span style="--s-dark:#80A665;--s-light:#59873A;">pipe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">          map</span><span style="--s-dark:#666666;--s-light:#999999;">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">user</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#80A665;--s-light:#59873A;"> createLoginSuccessAction</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">user</span><span style="--s-dark:#666666;--s-light:#999999;">)),</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">          catchError</span><span style="--s-dark:#666666;--s-light:#999999;">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">error</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Error</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">            of</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#80A665;--s-light:#59873A;">createLoginFailureAction</span><span style="--s-dark:#666666;--s-light:#999999;">({ </span><span style="--s-dark:#B8A965;--s-light:#998418;">errorMsg</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">error</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">message</span><span style="--s-dark:#666666;--s-light:#999999;"> }))</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">          )</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">        )</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      )</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    )</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  );</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> userApi</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">UserApi</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> actions</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Actions</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>createEffect</code> åˆ›å»ºäº†ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œä¼ å…¥äº†ä¸€ä¸ªå‡½æ•°</p><p>å‡½æ•°çš„å†…å®¹å…¶å®éå¸¸å®¹æ˜“ç†è§£ï¼Œ<code>ofType</code> æ˜¯ <code>NgRx</code> æä¾›çš„ç®¡é“æ“ä½œç¬¦ï¼Œä½¿ç”¨ <code>ofType</code> ç­›é€‰å‡º <code>loginAction</code> ï¼Œç„¶åä½¿ç”¨ <code>mergeMap</code> æ¥å‘èµ·è¯·æ±‚ï¼Œä½¿ç”¨ <code>map</code>ï¼Œ<code>catchError</code> æ¥è¿”å›æ¥ä¸‹æ¥è¦è§¦å‘çš„ <code>Action</code></p><p>ç„¶åæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ª <code>Effect</code> é€šè¿‡ <code>EffectsModule</code> æ³¨å…¥åˆ°è·Ÿæ¨¡å—ä¸­</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// ...</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> StoreModule</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> StoreDevtoolsModule</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/store-devtools</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> EffectsModule</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">@ngrx/effects</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">import</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> userReducer</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> from</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;"> &#39;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">./user.reducer</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&#39;</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">@</span><span style="--s-dark:#80A665;--s-light:#59873A;">NgModule</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">  imports</span><span style="--s-dark:#666666;--s-light:#999999;">: [</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    StoreModule</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">forRoot</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      user</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">userReducer</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }),</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    StoreDevtoolsModule</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">instrument</span><span style="--s-dark:#666666;--s-light:#999999;">(),</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // æ³¨å…¥</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    EffectsModule</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">forRoot</span><span style="--s-dark:#666666;--s-light:#999999;">([</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">UserEffect</span><span style="--s-dark:#666666;--s-light:#999999;">]),</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  ],</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">})</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> AppModule</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span></code></pre><p>ç„¶åæˆ‘ä»¬å›åˆ° <code>UI</code> ç»„ä»¶ä¸Šï¼Œç°åœ¨æˆ‘ä»¬çš„ <code>submit</code> æ–¹æ³•å°±éå¸¸ç®€å•äº†ï¼Œå‘å‡º <code>loginAction</code> å³å¯</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// ...</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> LoginView</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> fb</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">FormBuilder</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> private</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> store</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Store</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  submit</span><span style="--s-dark:#666666;--s-light:#999999;">()</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#666666;--s-light:#999999;">{</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;"> }</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">loginForm</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">getRawValue</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    if</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">username</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> &amp;&amp;</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> password</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">      // å‘ loginAction ï¼Œé™„å¸¦ä¸Š username å’Œ password å‚æ•°</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">      this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">store</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">dispatch</span><span style="--s-dark:#666666;--s-light:#999999;">(</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">        createLoginAction</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">          username</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">          password</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">        })</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">      );</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>ç„¶åæˆ‘ä»¬ç‚¹å‡»ç™»å½•ï¼Œå°±å¯ä»¥çœ‹åˆ° <code>Action</code> çš„å˜åŒ–äº†</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051713256.gif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/05/202207051713256.gif" alt=""></a></p>`,118)])))}};export{R as categories,F as date,j as default,x as key,w as meta,v as tags,E as title,b as updated,S as wordCount};
