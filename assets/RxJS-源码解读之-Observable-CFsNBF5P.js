import{createElementBlock as n,openBlock as l,createStaticVNode as p}from"vue";import{c as t}from"./app-C4XuqRXg.js";import"nprogress";import"pinia-plugin-persistedstate";import"vue-router";import"vue-router-better-scroller";import"@vueuse/core";import"@vueuse/components";import"@vueuse/router";import"octokit";import"pinia";import"date-fns";const e={class:"kan-doc"},f="RxJS æºç è§£è¯»ä¹‹ Observable",F=["RxJS","JavaScript"],C=["ç¼–ç¨‹"],m=1697450498,x="2023-10-16T18:01:38.000Z",S="2023-10-16T18:01:38.000Z",O=9569,T=[{property:"og:title",content:"RxJS æºç è§£è¯»ä¹‹ Observable"},{name:"twitter:title",content:"RxJS æºç è§£è¯»ä¹‹ Observable"}],_={__name:"RxJS-æºç è§£è¯»ä¹‹-Observable",setup(r,{expose:a}){return a({frontmatter:{title:"RxJS æºç è§£è¯»ä¹‹ Observable",tags:["RxJS","JavaScript"],categories:["ç¼–ç¨‹"],key:1697450498,date:"2023-10-16T18:01:38.000Z",updated:"2023-10-16T18:01:38.000Z",wordCount:9569,meta:[{property:"og:title",content:"RxJS æºç è§£è¯»ä¹‹ Observable"},{name:"twitter:title",content:"RxJS æºç è§£è¯»ä¹‹ Observable"}]}}),t({title:"RxJS æºç è§£è¯»ä¹‹ Observable",meta:[{property:"og:title",content:"RxJS æºç è§£è¯»ä¹‹ Observable"},{name:"twitter:title",content:"RxJS æºç è§£è¯»ä¹‹ Observable"}]}),(g,s)=>(l(),n("div",e,s[0]||(s[0]=[p(`<h1 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€">ğŸ”—</a></h1><p>RxJS æºç è§£è¯»ä¹‹ <code>Observable</code> ã€‚</p><p>ä¹‹å‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å†™è¿‡å‡ ç¯‡å…³äº RxJS åŸºæœ¬ä½¿ç”¨çš„æ–‡ç« ï¼š</p><ul><li><a href="/776cd3d8c7d9.html">RxJS çš„ä¸€äº›ä½¿ç”¨åŠç®€å•ç†è§£</a></li><li><a href="/b4d3483087f0.html">RxJS ä¸€äº›æœ‰è¶£çš„ operate æ“ä½œç¬¦</a></li><li><a href="/0d441631e194.html">RxJS ä½¿ç”¨ä¹‹ pipe ç®¡é“</a></li><li><a href="/93b17fcedd54.html">RxJS ä½¿ç”¨ä¹‹ Subject</a></li><li><a href="/dfd7127274b8.html">RxJS ä½¿ç”¨ä¹‹ Scheduler</a></li></ul><p>è¿™æ¬¡ï¼Œæˆ‘ä»¬æ¥å†™ä¸€äº›å…³äº RxJS çš„ä¸€äº›å†…éƒ¨å®ç°ã€‚</p><h1 id="æ­£æ–‡" tabindex="-1">æ­£æ–‡ <a class="header-anchor" href="#æ­£æ–‡">ğŸ”—</a></h1><h2 id="æ¦‚å¿µ" tabindex="-1">æ¦‚å¿µ <a class="header-anchor" href="#æ¦‚å¿µ">ğŸ”—</a></h2><p>RxJS ä¸­æœ€æ ¸å¿ƒçš„ç±»å°±æ˜¯ <code>Observable</code> äº†ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½æ˜¯é€šè¿‡ <code>Observable</code> æ´¾ç”Ÿå‡ºæ¥çš„ï¼Œæ¯”å¦‚ï¼š</p><ul><li>operator æ“ä½œç¬¦ ï¼Œ <code>of</code> ã€<code>fromEvent</code>ã€<code>interval</code> ç­‰ç­‰æ“ä½œç¬¦ã€‚</li><li>pipe ç®¡é“ï¼Œç®¡é“å†…éƒ¨éƒ½æ˜¯é€šè¿‡è¿”å›ä¸€ä¸ªæ–°çš„ <code>Observable</code> å¯¹è±¡æ¥å®ç°æ•°æ®çš„å¤„ç†ï¼Œè¿™ä¹Ÿè¡¨æ˜ç®¡é“çš„å®ç°å¹¶ä¸æ˜¯ä¸€ä¸ªé»‘ç›’ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹å†™è‡ªå®šä¹‰çš„ç®¡é“ã€‚</li><li><code>Subject</code> ä¸»é¢˜ï¼Œç»§æ‰¿è‡ª <code>Observable</code> ï¼Œå®ç°äº†å¤šæ’­ï¼Œä»¥åŠ <code>Subject</code> æœ¬èº«åˆæ´¾ç”Ÿå‡ºäº† <code>BehaviorSubject</code> ã€ <code>ReplySubject</code> ã€ <code>AsyncSubject</code> ç­‰ç‰¹æ®Šçš„ <code>Subject</code> ã€‚</li></ul><p>Observable åœ¨è‹±æ–‡é‡Œçš„æ„æ€ä¸ºå¯è§‚å¯Ÿçš„ï¼Œä½†å…¶å® <code>Observable</code> ç±»æœ¬èº«å¹¶ä¸æ‰¿è½½å…³äºâ€œè§‚å¯Ÿâ€æœ¬èº«è¯¦ç»†çš„é€»è¾‘ï¼Œæ›´å‡†ç¡®ç‚¹è®²å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡å‡ºæ¥çš„å®¹å™¨ï¼Œå®ƒèƒ½å¤Ÿæ¥æ”¶â€œè§‚å¯Ÿâ€é€»è¾‘ä»¥åŠâ€œè§‚å¯Ÿè€…â€ï¼Œç„¶ååœ¨åˆé€‚çš„æ—¶æœºå°±ä¼šè¿›è¡Œè®¢é˜…æ“ä½œã€‚</p><p>åœ¨å®˜ç½‘ä¸Šï¼Œä¹Ÿå­˜åœ¨ä¸€ä¸ªå¾ˆç»å…¸çš„è¡¨æ ¼ï¼š</p><table><thead><tr><th></th><th>SINGLE</th><th>MULTIPLE</th></tr></thead><tbody><tr><td><strong>PULL</strong></td><td><a href="https://developer.mozilla.org/en-US/docs/Glossary/Function" target="_blank" rel="noopener">Function</a></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols" target="_blank" rel="noopener">Iterator</a></td></tr><tr><td><strong>PUSH</strong></td><td><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener">Promise</a></td><td><a href="https://rxjs.dev/api/index/class/Observable" target="_blank" rel="noopener">Observable</a></td></tr></tbody></table><p>Single / Multiple è¿™ä¸ªç±»åˆ«è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œ <code>Function</code> å’Œ <code>Promise</code> éƒ½æ˜¯åªèƒ½â€œè¿”å›â€ä¸€æ¬¡ï¼Œ <code>Function</code> è‡ªç„¶ä¸ç”¨å¤šè¯´ï¼Œåœ¨ä¸€ä¸ªå‡½æ•°ä½“çš„å†…éƒ¨ï¼Œä½ åªèƒ½æœ‰ä¸€ä¸ª <code>return</code> è¯­å¥ç”Ÿæ•ˆï¼›å¯¹äº <code>Promise</code> ï¼Œå®ƒåªè¦è°ƒç”¨ <code>resolve</code> ä¹‹åï¼Œ <code>Promise</code> çš„çŠ¶æ€å°±ä» pending å˜ä¸º resolved äº†ï¼Œè¿™æ„å‘³ç€ä½ æ— æ³•å† <code>resolve</code> å€¼å‡ºå»äº†ã€‚è€Œå¯¹äº <code>Iterator</code> å’Œ <code>Observable</code> ï¼Œå®ƒä»¬å¯ä»¥äº§ç”Ÿå¤šä¸ªå€¼ï¼Œ <code>Iterator</code> ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°æ¥ç”Ÿæˆï¼Œåœ¨å‡½æ•°å†…éƒ¨å¯ä»¥é€šè¿‡ <code>yield</code> æ¥å¤šæ¬¡â€œè¿”å›â€å€¼ï¼Œ <code>Observable</code> åˆ™æ˜¯é€šè¿‡ä¼ å…¥çš„è§‚å¯Ÿè€…çš„ <code>next</code> å‡½æ•°æ¥å¤šæ¬¡å‘å‡ºå€¼ã€‚</p><p>è¿™é‡Œä½ å¯èƒ½ä¼šè¯¯è®¤ä¸º SINGLE æ˜¯è¿”å›ä¸€ä¸ªå€¼ï¼Œè€Œ MULTIPLE æ˜¯è¿”å›å¤šä¸ªå€¼ï¼Œå³è¯¯è®¤ä¸ºæ˜¯å®ƒä»¬çš„åŒºåˆ«æ˜¯è¿”å›æ•°æ®çš„ä¸ªæ•°ï¼Œå…¶å®ä¸ç„¶ï¼Œ <code>Function</code> å’Œ <code>Promise</code> éƒ½å¯ä»¥é€šè¿‡æ„å»ºå¯¹è±¡æ¥è¿”å›ä¸€ä¸ªåŒ…å«å·¨é‡ä¿¡æ¯çš„å€¼ï¼Œä½†æ˜¯å®ƒä»¬ä¿©å’Œåé¢ <code>Iterator</code> å’Œ <code>Observable</code> çš„æ ¸å¿ƒåŒºåˆ«å°±æ˜¯ï¼Œå®ƒä»¬ä¿©åªèƒ½â€œè¿”å›â€ä¸€æ¬¡ã€‚</p><p>Pull / Push ä¸¤è€…çš„åŒºåˆ«åœ¨å®˜ç½‘ä¸­ä¹Ÿæœ‰<a href="https://rxjs.dev/guide/observable#pull-versus-push" target="_blank" rel="noopener">ä¸“é—¨è®¨è®º</a>ã€‚</p><blockquote><p><strong>Pull</strong> and <strong>Push</strong> are two different protocols that describe how a data Producer can communicate with a data Consumer.</p></blockquote><p>Pull å’Œ Push æ˜¯æè¿°æ•°æ®ç”Ÿäº§è€…æ˜¯å¦‚ä½•å’Œæ•°æ®æ¶ˆè´¹è€…ä¹‹é—´æ˜¯å¦‚ä½•è”ç³»çš„ä¸¤ç§ä¸åŒçš„åè®®ã€‚ åœ¨ Pull æ¨¡å‹ä¸­ï¼Œæ¶ˆè´¹è€…å†³å®šäº†ä½•æ—¶ä»ç”Ÿäº§è€…è·å–å€¼ï¼Œè€Œåœ¨ Push æ¨¡å‹ä¸­ï¼Œæ˜¯ç”Ÿäº§è€…å†³å®šä½•æ—¶å‘æ¶ˆè´¹è€…æ¨é€å€¼ã€‚ Push æ¨¡å‹ç›¸æ¯” Pull æ¨¡å‹ï¼Œå…¶å®å°±å¯ä»¥è¯´æ˜¯ä¸€ç§æ§åˆ¶åè½¬ã€‚</p><p>å¦‚æœä¸æ‡‚çš„é—®é¢˜ä¸å¤§ï¼Œå…¶å®å†™å¤šäº†è‡ªç„¶å°±ä¼šç†è§£è¿™ä¸ªå…³ç³»äº†ï¼Œå¯¹äºä¸€äº›åŒæ­¥çš„æ“ä½œï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ç”¨çš„éƒ½æ˜¯ Pull æ¨¡å‹ï¼Œè€Œå¾ˆå¤šçš„å¼‚æ­¥æ“ä½œåˆ™è¾ƒå¤šæ—¶å€™ä¼šä½¿ç”¨ Push æ¨¡å‹ã€‚</p><h2 id="æºç " tabindex="-1">æºç  <a class="header-anchor" href="#æºç ">ğŸ”—</a></h2><p>è¿™æ¬¡æˆ‘ä»¬å…ˆæ¥ç§ä¸€ç§ <code>Observable</code> åœ¨å†…éƒ¨æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚</p><p>RxJS çš„ä»“åº“åœ°å€ï¼š<a href="https://github.com/ReactiveX/rxjs" target="_blank" rel="noopener">ç‚¹å‡»ç›´è¾¾</a>ã€‚</p><p>ä»£ç åº“ä¸­çš„æ ¸å¿ƒå®ç°éƒ½ä½äº <code>packages/rxjs/src/internal</code> ä¸‹ï¼Œå…¶ä»–çš„æ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚ <code>packages/rxjs/fetch</code> ï¼Œéƒ½æ˜¯å¯¼å‡º <code>packages/rxjs/src/internal</code> è¯¥æ–‡ä»¶å¤¹ä¸‹é¢çš„å®ç°çš„ã€‚</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2023/10/16/202310160949411.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2023/10/16/202310160949411.avif" alt=""></a></p><p>æœ¬æ–‡å…³äº <code>Observable</code> å®ç°çš„æ–‡ä»¶ä½ç½®åœ¨ <code>packages/rxjs/src/internal/Observable.ts</code> ã€‚</p><p>æ ¸å¿ƒçš„å®ç°åŒ…å«ä¸‹é¢è¿™å››ä¸ªæ–¹æ³•ï¼ˆ <code>pipe</code> ä¹‹åå†è®²ï¼‰ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> implements</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#80A665;--s-light:#59873A;">subscribe</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">?</span><span style="--s-dark:#666666;--s-light:#999999;">: (</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;, </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">TeardownLogic</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">?</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Partial</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Observer</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;&gt; | ((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">void</span><span style="--s-dark:#666666;--s-light:#999999;">) | </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">null</span><span style="--s-dark:#666666;--s-light:#999999;">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Subscription</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  protected</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _trySubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">sink</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> TeardownLogic</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  protected</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">_subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">any</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> TeardownLogic</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>RxJS å†…éƒ¨ä½¿ç”¨äº†å¾ˆå¤šçš„ç®€å•ç±»å‹æ¥è¿›è¡Œæ­å»ºï¼Œè¿™é‡Œæˆ‘ä»¬è¦å…ˆè®¤è¯†ä¸¤ä¸ªç±»å‹ <code>Subscribable</code> å’Œ <code>Unsubscribable</code> ï¼Œè¿™ä¿©çš„å®ç°å¦‚ä¸‹ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// packages/rxjs/src/internal/types.ts</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> interface</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Partial</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Observer</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;&gt;):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Unsubscribable</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> interface</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Unsubscribable</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">():</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> void</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>è¿™ä¿©ä¸ªç±»å‹å…¶å®å°±å®šä¹‰äº†å¦‚ä½•è®¢é˜…ä»¥åŠå¦‚ä½•å–æ¶ˆè®¢é˜…ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„ä¼ªä»£ç æ¥è¡¨ç¤ºï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> observer</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0;"> // ...</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> subscribable</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> new</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// è®¢é˜…</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> unsubscribable</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// å–æ¶ˆè®¢é˜…ï¼Œä¹Ÿå°±æ˜¯é‡Šæ”¾èµ„æº</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">unsubscribable</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span></code></pre><p>å› ä¸º <code>Observable</code> å®ç°äº† <code>Subscribable</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å†…éƒ¨ä¹Ÿæœ‰å®ç°äº† <code>subscribe</code> æ–¹æ³•ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> implements</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">?</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Partial</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Observer</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;&gt; | ((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">void</span><span style="--s-dark:#666666;--s-light:#999999;">) | </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">null</span><span style="--s-dark:#666666;--s-light:#999999;">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Subscription</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscriber</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> observerOrNext</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> instanceof </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Subscriber</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> ? </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> : new </span><span style="--s-dark:#80A665;--s-light:#59873A;">Subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">add</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">_trySubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">));</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>è¿™é‡Œçš„ <code>Observer</code> ç±»å‹éå¸¸ç®€å•ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// packages/rxjs/src/internal/types.ts</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> interface</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observer</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  next</span><span style="--s-dark:#666666;--s-light:#999999;">: (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">void</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  error</span><span style="--s-dark:#666666;--s-light:#999999;">: (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">err</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">any</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">void</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  complete</span><span style="--s-dark:#666666;--s-light:#999999;">: () =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">void</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>å…¶å®å°±æ˜¯ä¸€ä¸ªåŒ…å«äº† <code>next</code> ã€ <code>complete</code> ã€ <code>error</code> æ–¹æ³•çš„å¯¹è±¡ï¼Œç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  next</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">) {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  complete</span><span style="--s-dark:#666666;--s-light:#999999;">() {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">) {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>è¿™é‡Œæˆ‘ä»¬å…ˆä¸ç®¡ <code>new Subscriber(observerOrNext)</code> å†…éƒ¨å¹²äº†ä»€ä¹ˆï¼Œæˆ‘ä»¬åªè¦ç®€å•åœ°ç†è§£ä¸ºè§„èŒƒåŒ–ç”Ÿæˆäº†ä¸€ä¸ª <code>Observer</code> å¯¹è±¡ã€‚</p><p>è¿™é‡Œçš„ <code>Subscription</code> ç±»å‹æˆ‘ä»¬ä¹Ÿå…ˆä¸ç®¡ï¼Œåªè¦ç®€å•åœ°ç†è§£ä¸º <code>Subscription</code> å®ç°äº† <code>Unsubscribable</code> æ¥å£å³å¯ï¼Œå³è¿”å›äº†ä¸€ä¸ª <code>unsubscribe</code> çš„æ–¹æ³•ã€‚</p><p>æ¥ç€ <code>subscriber.add(this._trySubscribe(subscriber))</code> è¿™ä¸€å¥æˆ‘ä»¬ä¹Ÿä¸ç®¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ–¹æ³•ç®€å†™ä¸ºå¦‚ä¸‹ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> implements</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">?</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Partial</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Observer</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;&gt; | ((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">void</span><span style="--s-dark:#666666;--s-light:#999999;">) | </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">null</span><span style="--s-dark:#666666;--s-light:#999999;">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Subscription</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // è§„èŒƒåŒ– observer å¯¹è±¡ç»“æ„</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> normalizeObserver</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">    </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // å¾—åˆ°ä¸€ä¸ªå–æ¶ˆè®¢é˜…çš„å‡½æ•°</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">unsuscribeFn</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">_trySubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">    </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // è¿”å›ä¸€ä¸ª Unsubscribable ç±»å‹å¯¹è±¡</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">unsubscribeFn</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>ç»è¿‡ç®€å†™ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ <code>subscribe</code> å¹¶ä¸æ˜¯çœŸæ­£æ‰§è¡Œè®¢é˜…æ“ä½œçš„åœ°æ–¹ï¼Œè€Œæ˜¯é€šè¿‡ <code>_trySubscribe</code> æ–¹æ³•æ¥æ‰§è¡Œè®¢é˜…ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> implements</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  protected</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _trySubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> TeardownLogic</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    try</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">      return</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">_subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> catch</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">err</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      observer</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">err</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>è¿™ä¸ªé€»è¾‘å¾ˆç®€å•ï¼ŒæŠŠ <code>_subscribe</code> çš„æ‰§è¡ŒåŒ…åœ¨ <code>try-catch</code> ä¸­ ï¼Œå¦‚æœæŠ¥é”™å°±è°ƒç”¨ç›¸åº”çš„ <code>error</code> æ–¹æ³•é€šçŸ¥ï¼Œä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆè¯´æ‰§è¡Œäº† <code>_subscribe</code> å‡½æ•°å°±æ˜¯æ‰§è¡Œäº†è®¢é˜…äº†å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘ä»¬è¦çœ‹ <code>_subscribe</code> å‡½æ•°æœ¬èº«ä»¥åŠ <code>constructor</code> æ„é€ å‡½æ•°ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> implements</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#80A665;--s-light:#59873A;">subscribe</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">?</span><span style="--s-dark:#666666;--s-light:#999999;">: (</span><span style="--s-dark:#C99076;--s-light:#A65E2B;">this</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;, </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">TeardownLogic</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    if</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">      this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">_subscribe</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  protected</span><span style="--s-dark:#80A665;--s-light:#59873A;"> _subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">_subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">any</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> TeardownLogic</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p><code>_subscribe</code> é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªç©ºå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åšä»»ä½•çš„æ“ä½œï¼Œåœ¨ <code>constructor</code> æ„é€ å‡½æ•°ä¸­ï¼Œå¦‚æœä¼ å…¥äº† <code>subscribe</code> å‡½æ•°ï¼Œåˆ™ä¼šé‡å†™åˆ°è‡ªèº«çš„ <code>_subscribe</code> å‡½æ•°ã€‚</p><p>ç©ºå‡½æ•°æ„å‘³ç€æˆ‘ä»¬å®Œå…¨å¯ä»¥ä¸ä¼ å‚æ•°æ¥ <code>new Observable()</code> ï¼Œè€Œä¸ä¼šé€ æˆè°ƒç”¨æ—¶äº§ç”Ÿ undefined å¼‚å¸¸ã€‚</p><p>å³å¯ä»¥ç†è§£ä¸º <code>_subscribe</code> ä¿å­˜äº†å¤–éƒ¨ä¼ å…¥çš„ <code>subscribe</code> å‡½æ•°çš„ä¸€ä¸ª<strong>å¼•ç”¨</strong>ã€‚</p><p>è¿™é‡Œä½ å¯èƒ½å°±ä¼šæœ‰ç–‘é—®äº†ï¼Œä¸ºä»€ä¹ˆè¦å†æ‹†å‡ºä¸€ä¸ª <code>trySubscribe</code> å‡½æ•°å‘¢ï¼Ÿè¿™ä¸æ˜¯è„±è£¤å­æ”¾å±å—ï¼Ÿæˆ‘å®Œå…¨å¯ä»¥å†™æˆå¦‚ä¸‹å•Šï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">export</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> implements</span><span style="--s-dark:#80A665;--s-light:#59873A;"> Subscribable</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">  // ...</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#CB7676;--s-light:#AB5959;">?</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Partial</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">Observer</span><span style="--s-dark:#666666;--s-light:#999999;">&lt;</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">&gt;&gt; | ((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">T</span><span style="--s-dark:#666666;--s-light:#999999;">) =&gt; </span><span style="--s-dark:#5DA994;--s-light:#2E8F82;">void</span><span style="--s-dark:#666666;--s-light:#999999;">) | </span><span style="--s-dark:#CB7676;--s-light:#AB5959;">null</span><span style="--s-dark:#666666;--s-light:#999999;">):</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Subscription</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // è§„èŒƒåŒ– observer å¯¹è±¡ç»“æ„</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> normalizeObserver</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observerOrNext</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">    </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // å¾—åˆ°ä¸€ä¸ªå–æ¶ˆè®¢é˜…çš„å‡½æ•°</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    let </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">unsuscribeFn</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    try</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      unsuscribeFn</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">_subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> catch</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">err</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">err</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">    </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">    // è¿”å›ä¸€ä¸ª Unsubscribable ç±»å‹å¯¹è±¡</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418;">      unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">: </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">unsubscribeFn</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>è¿™é‡Œæ˜¯ç”±äºå…¶ä»–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ <code>Subject</code> å®ƒä¹Ÿä¼šç»§æ‰¿ <code>Observable</code> ï¼Œé€šè¿‡åˆ†ç¦»è§„èŒƒåŒ– <code>Observer</code> å¯¹è±¡æ“ä½œä»¥åŠçœŸæ­£çš„è®¢é˜…æ“ä½œï¼Œå¯ä»¥é‡å†™æ›´å°‘çš„èŒƒå›´ã€‚</p><p><code>Subject</code> å’Œ <code>Observable</code> éƒ½å¯¹å¤–æä¾›äº†ä¸€ä¸ª <code>subscribe</code> æ–¹æ³•ï¼Œç”¨æ¥æ‰§è¡Œå†…éƒ¨çš„ <code>_subscribe</code> æ–¹æ³•ï¼Œè¿™æ—¶ï¼Œè§„èŒƒåŒ– <code>Observer</code> å¯¹è±¡è¿™ä¸ªæ“ä½œå¯¹è¿™ä¸¤è€…æ¥è¯´æ˜¯ä¸ç”¨å˜åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è§„èŒƒåŒ–è¿™ä¸ªæ“ä½œæ˜¯ä¸è¿™ä¸¤è€…æ— å…³çš„ï¼Œåªè¦éœ€è¦â€œè®¢é˜…â€ï¼Œé‚£ä¹ˆå°±ä¸€å®šéœ€è¦â€œè§„èŒƒåŒ–â€å…¥å‚ã€‚è¿™é‡Œç­‰åˆ°åé¢è®²åˆ° <code>Subject</code> çš„æ—¶å€™å¤§æ¦‚å°±èƒ½ç†è§£äº†ï¼Œ <code>Subject</code> å†…éƒ¨ä¼šé‡å†™ <code>_subscribe</code> æ–¹æ³•æ¥å®ç° <code>Subject</code> æä¾›çš„åŠŸèƒ½ã€‚</p><h2 id="æ‰‹å†™ç®€å•å®ç°" tabindex="-1">æ‰‹å†™ç®€å•å®ç° <a class="header-anchor" href="#æ‰‹å†™ç®€å•å®ç°">ğŸ”—</a></h2><p>åˆ°è¿™é‡Œï¼Œ <code>Observable</code> çš„æ ¸å¿ƒå®ç°åŸºæœ¬å°±è§£é‡Šå®Œäº†ã€‚å¯èƒ½ä½ ä¼šè§‰å¾—ï¼šå§æ§½ï¼Œè¿™ TypeScript ç±»å‹çœ‹çš„æˆ‘å¤´ç–¼ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥æ‰‹æŠŠæ‰‹å†™ä¸€ä¸ªè¿·ä½ ç‰ˆçš„ <code>Observable</code> å®ç°ã€‚</p><p>æˆ‘ä»¬å°†ä¸å»æ ¡éªŒå…¥å‚ï¼Œä»¥åŠä¸åœ¨æ„ç±»å‹æŠ½è±¡ï¼Œæ¥é‡å†™ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª <code>Observable</code> ç±»ï¼Œé€šè¿‡æ„é€ å‡½æ•°æŠŠä¼ å…¥çš„ <code>subscribe</code> å‡½æ•°æŒ‚åˆ°è‡ªèº«ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">    this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">_subscribe</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> subscribe</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> ??</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> function</span><span style="--s-dark:#666666;--s-light:#999999;"> (){}</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬å®ç° <code>subscribe</code> æ–¹æ³•ï¼ŒæŠŠä¼ å…¥çš„ <code>observer</code> é€ä¼ ç»™ <code>_subscribe</code> å‡½æ•°å³å¯ã€‚åŒæ—¶åŒ…è£¹ <code>try-catch</code> æ¥æ•è·åŒæ­¥çš„é”™è¯¯ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">class</span><span style="--s-dark:#5DA994;--s-light:#2E8F82;"> Observable</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">  constructor</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#C99076;--s-light:#A65E2B;">    this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">_subscribe</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> subscribe</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> ??</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> function</span><span style="--s-dark:#666666;--s-light:#999999;"> (){}</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#DBD7CAEE;--s-light:#393A34;">  </span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">    let </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    try</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#C99076;--s-light:#A65E2B;"> this</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">_subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> ??</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> function</span><span style="--s-dark:#666666;--s-light:#999999;"> (){};</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F;"> catch</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      observer</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">    return</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">      unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">    };</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span></code></pre><p>è‡³æ­¤ï¼Œä¸€ä¸ªè¿·ä½ çš„ <code>Observable</code> å°±å®Œæˆäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ä¸€ä¸‹ï¼š</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observable$</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959;"> new </span><span style="--s-dark:#80A665;--s-light:#59873A;">Observable</span><span style="--s-dark:#666666;--s-light:#999999;">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">next</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">1</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">complete</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">  return</span><span style="--s-dark:#666666;--s-light:#999999;"> ()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">æ¸…ç†ä¸€ä¸‹</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscription</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48;"> observable$</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">({</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  next</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">) {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">next: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">, </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  complete</span><span style="--s-dark:#666666;--s-light:#999999;">() {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">complete</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">) {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscription</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span></code></pre><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2023/10/16/202310161139798.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2023/10/16/202310161139798.avif" alt=""></a></p><p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿™ä¸ªå®ç°è¿˜æœ‰å¾ˆå¤šçš„é—®é¢˜ï¼Œé™¤äº†å‰é¢æˆ‘ä»¬æ‰€è¯´çš„å…¥å‚ä»¥åŠæŠ½è±¡ï¼Œè¿˜æœ‰æ¯”å¦‚åœ¨æ‰§è¡Œ <code>complete</code> å‡½æ•°çš„æ—¶å€™åº”è¯¥åœ¨æ‰§è¡Œå®Œ <code>complete</code> é€»è¾‘ä¹‹åæ‰§è¡Œ <code>unsubscribe</code> å‡½æ•°è¿›è¡Œæ¸…ç†æ“ä½œã€‚</p><p>ä¸è¿‡è¿™ä¸ªè¿·ä½ ç‰ˆçš„å®ç°åŸºæœ¬ä¸Šå°±é“å‡ºäº† <code>Observable</code> çš„æ ¸å¿ƒã€‚</p><p>è¿›ä¸€æ­¥ç®€åŒ–çš„è¯ï¼Œæˆ‘ä»¬å…¶å®å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ä»¥åŠä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åæŠŠè¿™ä¸ªå¯¹è±¡ä¼ å…¥è¿™ä¸ªå‡½æ•°è€Œå·²ã€‚</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff;" tabindex="0"><code class="language-typescript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#80A665;--s-light:#59873A;">subscribe</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#666666;--s-light:#999999;"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">)</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">next</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A;">1</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">  subscriber</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">complete</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F;">  return</span><span style="--s-dark:#666666;--s-light:#999999;"> ()</span><span style="--s-dark:#666666;--s-light:#999999;"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">æ¸…ç†ä¸€ä¸‹</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#666666;--s-light:#999999;"> {</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  next</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">) {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">next: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">, </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">value</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  complete</span><span style="--s-dark:#666666;--s-light:#999999;">() {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">log</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#C98A7D;--s-light:#B56959;">complete</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977;">&quot;</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  },</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">  error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">) {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48;">    console</span><span style="--s-dark:#666666;--s-light:#999999;">.</span><span style="--s-dark:#80A665;--s-light:#59873A;">error</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">e</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// è®¢é˜…</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959;">const </span><span style="--s-dark:#BD976A;--s-light:#B07D48;">unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;"> =</span><span style="--s-dark:#80A665;--s-light:#59873A;"> subscribe</span><span style="--s-dark:#666666;--s-light:#999999;">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48;">observer</span><span style="--s-dark:#666666;--s-light:#999999;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0;">// å–æ¶ˆè®¢é˜…ï¼Œå³æ¸…ç†æ“ä½œ</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A;">unsubscribe</span><span style="--s-dark:#666666;--s-light:#999999;">();</span></span></code></pre><p>é€šè¿‡æŠ½è±¡å‡º <code>Observable</code> ç±»ï¼Œå¯ä»¥ä»¥é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥è¿›è¡Œè°ƒç”¨ï¼Œä»¥åŠæŠŠä¸€äº›é€»è¾‘éšè—åœ¨ç±»çš„å†…éƒ¨æ¥å®ç°æ›´å¤šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚ <code>Observable.prototype.pipe</code> å‡½æ•°ã€‚</p><h1 id="åè®°" tabindex="-1">åè®° <a class="header-anchor" href="#åè®°">ğŸ”—</a></h1><p>ä¸‹ä¸€ç¯‡æˆ‘ä»¬ä¼šè®² <code>Subscriber</code> ã€ <code>Subscription</code> è¿™ä¿©ç±»çš„å®ç°ï¼Œå®ƒä»¬çš„å®ç°å’Œ <code>Observable</code> çš„å…³ç³»è¿˜æ˜¯æ¯”è¾ƒæ·±çš„ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒåŸºç¡€çš„ç±»ã€‚</p>`,70)])))}};export{C as categories,x as date,_ as default,m as key,T as meta,F as tags,f as title,S as updated,O as wordCount};
