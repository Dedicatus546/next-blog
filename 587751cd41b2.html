<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><link rel="icon" type="image/svg+xml" href="/logo.svg"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ä½¿ç”¨ husky æ¥ä¸ºå¸–å­å¢åŠ æ›´æ–°æ—¶é—´</title><script type="importmap">{"imports":{"vue":"https://esm.sh/vue","vue-router":"https://esm.sh/vue-router","pinia":"https://esm.sh/pinia","@vueuse/core":"https://esm.sh/@vueuse/core","@vueuse/components":"https://esm.sh/@vueuse/components","@vueuse/router":"https://esm.sh/@vueuse/router","date-fns":"https://esm.sh/date-fns","nprogress":"https://esm.sh/nprogress","octokit":"https://esm.sh/octokit","pinia-plugin-persistedstate":"https://esm.sh/pinia-plugin-persistedstate","vue-router-better-scroller":"https://esm.sh/vue-router-better-scroller"}}</script><script type="module" async="" crossorigin="" src="/assets/app-kEKefLn2.js"></script><link rel="stylesheet" crossorigin="" href="/assets/app-DjlQYv3q.css"><link rel="modulepreload" crossorigin="" href="/assets/ä½¿ç”¨-husky-æ¥ä¸ºå¸–å­å¢åŠ æ›´æ–°æ—¶é—´-BVDOcumH.js"><meta property="og:title" content="ä½¿ç”¨ husky æ¥ä¸ºå¸–å­å¢åŠ æ›´æ–°æ—¶é—´"><meta name="twitter:title" content="ä½¿ç”¨ husky æ¥ä¸ºå¸–å­å¢åŠ æ›´æ–°æ—¶é—´"></head><body><div id="app" data-server-rendered="true"><div class="mujika" min-h="100vh" flex="~ col" bg="[--mygo-c-bg-alt]"><header class="mujika-header" flex="~ shrink-0" px-4="" h="70px" bg="[var(--mygo-c-bg)]" items-center="" justify-between="" data-v-c1947e25=""><a href="/" class="" flex="" gap-4="" items-center="" data-v-c1947e25=""><img w="40px" aspect-ratio-square="" src="/logo.svg" alt="æ‹ã®æ­Œçš„logo" data-v-c1947e25=""></a><div data-v-c1947e25=""><div p-1="" flex="" gap-1="" rounded="6px" bg="[var(--mygo-c-bg-alt)]" data-v-c1947e25=""><!--[--><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="bg-[var(--mygo-c-bg)]" title="è‡ªåŠ¨" data-v-c1947e25=""><!--[-->Auto<!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="æ—¥é—´" data-v-c1947e25=""><!--[--><i class="i-ri:sun-line" data-v-c1947e25=""></i><!--]--></div><div leading="[1]" px-2="" py-1="" cursor-pointer="" rounded="6px" class="" title="å¤œé—´" data-v-c1947e25=""><!--[--><i class="i-ri:moon-line" data-v-c1947e25=""></i><!--]--></div><!--]--></div></div></header><main class="mujika-home" flex="grow" mx="auto" min-h="0" p-2="" w-full="" un-2xl:w="[calc(96rem-var(--spacing)*2)]"><div flex="" gap-2="" items-start=""><div flex="~ col grow" gap-2="" min-w-0=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="~ col" mb-4="" gap-4=""><h1 break-all="" text="34px center">ä½¿ç”¨ husky æ¥ä¸ºå¸–å­å¢åŠ æ›´æ–°æ—¶é—´</h1></div><div flex="~ col" gap-3="" text="[var(--mygo-c-text-2)]"><div flex="~ wrap" gap-3="" justify-center=""><!----><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar"></i><span un-hidden="" lg:inline="">å‘è¡¨äº</span><span pl-1="">2022-07-28 09:38</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:calendar-check"></i><span un-hidden="" lg:inline="">æ›´æ–°äº</span><span pl-1="">2023-02-13 18:28</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:folder"></i><span un-hidden="" lg:inline="">åˆ†ç±»äº</span><!--[--><a pl-1="" href="/category/ç¼–ç¨‹">ç¼–ç¨‹</a><!--]--></div></div><div flex="~ wrap" gap-3="" justify-center=""><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:file-word"></i><span un-hidden="" lg:inline="">æ€»å­—æ•°</span><span pl-1="">5.2K</span></div><div flex="" gap-1="" items-center=""><i class="i-fa6-regular:clock"></i><span un-hidden="" lg:inline="">é˜…è¯»æ—¶é•¿ â‰ˆ</span><span pl-1="">19 åˆ†é’Ÿ</span></div></div></div><div class="mujika-doc-content"><!--[--><div class="kan-doc"><h1 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€">ğŸ”—</a></h1><p>ä½¿ç”¨ <code>husky</code> æ¥ä¸º <code>Hexo</code> å¸–å­å¢åŠ æ›´æ–°æ—¶é—´</p><p>æœ¬æ–‡éƒ½æ˜¯å»ºç«‹åœ¨ <code>Hexo</code> çš„ <code>Next</code> ä¸»é¢˜ä¸‹çš„ï¼Œå…¶ä»–çš„ä¸»é¢˜å¯èƒ½ä¼šä¸å…¼å®¹</p><p>åœ¨ <code>Next</code> ä¸»é¢˜ä¸‹ï¼Œå…¶å®æœ‰é…ç½®å¯ä»¥è®©æˆ‘ä»¬å¼€å¯å¸–å­æ›´æ–°æ—¶é—´çš„ï¼Œå¦‚ä¸‹ï¼š</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207280948585.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207280948585.avif" alt=""></a></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Next</code> åº”è¯¥æ˜¯ä¼šå»è¯»å–æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´æ¥ä½œä¸ºæ›´æ–°æ—¶é—´çš„</p><p>ä½†æ˜¯è¿™ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„ <code>Github Action</code> è‡ªåŠ¨éƒ¨ç½²çš„</p><p>æ¯æ¬¡éƒ½ä¼šé‡æ–°æ‹‰å–ä»“åº“ï¼Œè¿™æ ·å­æ¯ä¸ªæ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´éƒ½ä¼šå˜æˆåˆ›å»ºæ—¶é—´</p><h1 id="æ­£æ–‡" tabindex="-1">æ­£æ–‡ <a class="header-anchor" href="#æ­£æ–‡">ğŸ”—</a></h1><p>ä¸ºäº†è§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ï¼Œæœ‰ä¸¤ç§è§£å†³åŠæ³•</p><ul><li>ç›´æ¥å…³é—­æ›´æ–°æ—¶é—´ï¼Œçœ¼ä¸è§ä¸ºæ•¬ï¼ˆ<s>æ¨è</s></li><li>å¢åŠ  <code>updated</code> å­—æ®µæ‰‹åŠ¨æ›´æ–°å¸–å­æ›´æ–°æ—¶é—´</li></ul><p>è¿™é‡Œæˆ‘ä¸ªäººæ€è€ƒäº†ä¸‹ï¼Œå†³å®šè¿˜æ˜¯å¾—æ‰‹åŠ¨æ›´æ–°å¸–å­æ—¶é—´ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><ul><li>æˆ‘æƒ³å¼€å¯è¿™ä¸ªåŠŸèƒ½ä½†æˆ‘åˆæƒ³é€šè¿‡ <code>Github Action</code> éƒ¨ç½²</li><li>ä¸‡ä¸€æ¢ç”µè„‘äº†ï¼Œé‡æ–°æ‹‰å–ä»“åº“ï¼Œé‚£æ›´æ–°æ—¶é—´å°±å…¨ä¹±äº†</li><li><s>ä¸ºäº†å­¦ä¹ </s></li></ul><h2 id="æ·»åŠ -updated-å­—æ®µ" tabindex="-1">æ·»åŠ  updated å­—æ®µ <a class="header-anchor" href="#æ·»åŠ -updated-å­—æ®µ">ğŸ”—</a></h2><p>åœ¨æ¯ä¸ªå¸–å­ <code>md</code> æ–‡ä»¶çš„é¡¶éƒ¨ï¼Œ æˆ‘ä»¬å¯ä»¥é€šè¿‡å¢åŠ  <code>updated</code> å­—æ®µæ¥æŒ‡å®šæ›´æ–°æ—¶é—´</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207280958069.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207280958069.avif" alt=""></a></p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥æ›´æ”¹æ¨¡æ¿ï¼ŒåŠ ä¸Š <code>updated</code> ï¼Œè¿™æ ·æ¯ä¸€æ¬¡ <code>hexo new</code> å°±ä¼šå¸¦ä¸Š <code>updated</code> å­—æ®µäº†</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281000922.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281000922.avif" alt=""></a></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦ç»™ä¹‹å‰çš„å¸–å­åŠ ä¸Šæ›´æ–°æ—¶é—´</p><p>æˆ‘ä»¬ä¾ç„¶ä½¿ç”¨ <code>js</code> æ¥å†™ä¸ªè„šæœ¬æ¥æ‰¹é‡ä¿®æ”¹æ–‡ç« å†…å®¹</p><p>åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åšä¸ªè¡¨æ ¼æ¥ä¿å­˜å¸–å­çš„æœ€åä¿®æ”¹æ—¶é—´ï¼Œè‡³äºåŸå› ï¼Œåé¢ä¼šè®²</p><p>åœ¨ <code>Node</code> ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>fs.stat</code> æ¥è·å–æ–‡ä»¶çš„ä¿¡æ¯</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">fs/promises</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">path</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">dayjs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./source/_posts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> main</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filenameList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readdir</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileHandler</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">open</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./updated.json</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">w+</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filename</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filenameList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filename</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileStat</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">stat</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æŠŠ mtime è½¬æˆéœ€è¦çš„æ ¼å¼</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">fileStat</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">mtime</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#80A665;--s-light:#59873A">format</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">YYYY-MM-DD HH:mm:ss</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      updated</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // å†™å…¥æ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileHandler</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">write</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">JSON</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">stringify</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">infoList</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileHandler</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">close</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">main</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span></code></pre><p>æ‰§è¡Œä¹‹åæˆ‘ä»¬å°±èƒ½å‘ç°é¡¹ç›®æ ¹ç›®å½•ä¸‹æœ‰ä¸ª <code>updated.json</code> æ–‡ä»¶ï¼Œæ‰“å¼€å®ƒæ ¼å¼åŒ–ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281035982.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281035982.avif" alt=""></a></p><p>è¿™æ ·å­æˆ‘ä»¬å°±ä¿å­˜äº†æ–‡ä»¶çš„æ›´æ–°æ—¥æœŸ</p><p>æœ‰äººå¯èƒ½ç–‘é—®äº†ï¼Œä½ è¿™æ›´æ–°æ—¶é—´æ€ä¹ˆä¸€ä¸ªæ ·</p><p>å› ä¸ºä¹‹åçš„æ“ä½œä¼šå†™å…¥æ–‡ä»¶ï¼Œä¼šå¯¼è‡´ <code>mtime</code> å‘ç”Ÿæ”¹å˜ï¼Œè€Œæˆ‘å½“æ—¶åˆæ²¡æœ‰å¤‡ä»½ï¼Œç•™ä¸‹äº†æ‚”æ¨çš„æ³ªæ°´â€¦</p><p><code>ok</code> ï¼Œæœ‰äº†æ•°æ®å¤‡ä»½ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æŠ˜è…¾äº†ï¼Œå’Œä¹‹å‰å¤„ç† <code>CDN</code> å‰ç¼€ä¸€æ ·ï¼Œæˆ‘ä»¬ä¾ç„¶åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤</p><ul><li>è¯»å–å¸–å­åˆ—è¡¨</li><li>åŠ ä¸Š <code>updated</code> å­—æ®µ</li><li>æŠŠæ–°çš„å¸–å­å†…å®¹å†™å›æ–‡ä»¶</li></ul><p>ä»£ç å¦‚ä¸‹ï¼Œç”±äº <code>getPostList</code> å’Œ <code>writePostList</code> å’Œä¹‹å‰æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æŠ½æˆå…¬å…±å‡½æ•°å¼•å…¥äº†</p><p>ä¸æ¸…æ¥šå®ç°çš„å¯ä»¥å» {% post_link ä¸€ä¸ªæ›¿æ¢-cdn-å‰ç¼€çš„å°å·¥å…· ä¸€ä¸ªæ›¿æ¢ cdn å‰ç¼€çš„å°å·¥å…· %} è¿™ä¸ªå¸–å­æŸ¥çœ‹</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">getPostList</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> writePostList</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./util</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">fs/promises</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">dayjs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// éè´ªå©ª</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> REGEXP</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> /</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#666666;--s-light:#999999">(?&lt;</span><span style="--s-dark:#C98A7D;--s-light:#B56959">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">&gt;(</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\S</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\s</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">*?</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;string&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getFileLastModifyDate</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // é€šè¿‡ stat è·å–ä¿®æ”¹æ—¶é—´</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileStat</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">stat</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#80A665;--s-light:#59873A"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">fileStat</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">mtime</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#80A665;--s-light:#59873A">format</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">YYYY-MM-DD HH:mm:ss</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {Array&lt;{ filepath: string; fileContent: string }&gt;}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> addPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // è¿‡æ»¤æ‰ä¸ç¬¦åˆæ­£åˆ™çš„æ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">post</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">fileContent</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">test</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">fileContent</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> getFileLastModifyDate</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">match</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#BD976A;--s-light:#B07D48">groups</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> frontMatter</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\n</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">trim</span><span style="--s-dark:#666666;--s-light:#999999">());</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ‰¾ date å­—æ®µ</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dateInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">date</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ‰¾ updated å­—æ®µ</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // æœ‰ updated å­—æ®µå°±è·³è¿‡</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // åœ¨ date å­—æ®µåæ’å…¥ updated å­—æ®µ</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">splice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">dateInfoIndex</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ›¿æ¢å†…å®¹å¹¶ push åˆ°æ–°çš„ newPostList ä¸­ï¼Œç”¨äºå†™å›æ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    newPostList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">replace</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">join</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> main</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostList</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> addPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#80A665;--s-light:#59873A"> writePostList</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newPostList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">main</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span></code></pre><p>è¿™é‡Œä¾ç„¶ç”¨åˆ°äº†æˆ‘ä»¬çš„è€æœ‹å‹æ­£åˆ™ï¼Œä½¿ç”¨ <code>/---(?&lt;frontMatter&gt;(\S|\s)*?)---/</code> æ¥åŒ¹é…å¼€å¤´çš„å¸–å­å…ƒæ•°æ®</p><p>æ³¨æ„åˆ°è¿™é‡Œä½¿ç”¨äº†å…·åæ•è·ç»„ï¼Œè¿™æ ·æ–¹ä¾¿æˆ‘ä»¬æ‹¿åˆ°æ•°æ®ï¼Œä»¥åŠéè´ªå©ªåŒ¹é… <code>*?</code></p><p>é»˜è®¤è´ªå©ªåŒ¹é…çš„æƒ…å†µä¸‹ï¼Œæˆ‘å‘ç°æœ‰ç‚¹é—®é¢˜ï¼Œä¸»è¦æ˜¯è¡¨æ ¼çš„è¯­æ³•é‡Œé¢ä¹Ÿä¼šå‡ºç° <code>---</code> ä¸‰ä¸ªæ¨ªæ çš„æƒ…å†µï¼Œä¼šä¿®æ”¹åˆ°å…¶ä»–çš„åœ°æ–¹ï¼Œæ‰€ä»¥è¦ä½¿ç”¨éè´ªå©ª</p><p>ä»¥åŠä½¿ç”¨ <code>(\S|\s)*?</code> è€Œä¸æ˜¯ <code>.*?</code> ï¼Œå› ä¸º <code>.</code> ä¸åŒ¹é…æ¢è¡Œç¬¦å·</p><p><strong>é‡è¦ï¼šè¿™ä¸ªå·¥å…·åªæœ‰åœ¨ç¬¬ä¸€æ¬¡æ‰èƒ½è·å–æ­£ç¡®çš„ä¿®æ”¹æ—¶é—´ï¼Œå› ä¸ºå­˜åœ¨é‡æ–°å†™å…¥æ–‡ä»¶ï¼Œä¼šå¯¼è‡´ <code>mtime</code> å˜åŒ–ï¼ï¼</strong></p><p><strong>é‡è¦ï¼šè¿™ä¸ªå·¥å…·åªæœ‰åœ¨ç¬¬ä¸€æ¬¡æ‰èƒ½è·å–æ­£ç¡®çš„ä¿®æ”¹æ—¶é—´ï¼Œå› ä¸ºå­˜åœ¨é‡æ–°å†™å…¥æ–‡ä»¶ï¼Œä¼šå¯¼è‡´ <code>mtime</code> å˜åŒ–ï¼ï¼</strong></p><p><strong>é‡è¦ï¼šè¿™ä¸ªå·¥å…·åªæœ‰åœ¨ç¬¬ä¸€æ¬¡æ‰èƒ½è·å–æ­£ç¡®çš„ä¿®æ”¹æ—¶é—´ï¼Œå› ä¸ºå­˜åœ¨é‡æ–°å†™å…¥æ–‡ä»¶ï¼Œä¼šå¯¼è‡´ <code>mtime</code> å˜åŒ–ï¼ï¼</strong></p><p>å¦‚æœä¸å°å¿ƒæé”™äº†ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œå› ä¸ºå‰æ–‡æˆ‘ä»¬æå‰å­˜äº†ä¸ª <code>updated.json</code> ï¼Œè¯»å‡ºæ¥ï¼Œç„¶åä¸ç”¨ <code>fs.stat</code> äº†ï¼Œè€Œæ˜¯æ ¹æ® <code>json</code> æ–‡ä»¶é‡Œçš„æ˜ å°„ä¸€ä¸€å¯¹åº”é‡æ–° <code>patch</code> ä¸€ä¸‹å³å¯</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">getPostList</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> writePostList</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./util</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">fs/promises</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">dayjs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">path</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// éè´ªå©ª</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> REGEXP</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> /</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#666666;--s-light:#999999">(?&lt;</span><span style="--s-dark:#C98A7D;--s-light:#B56959">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">&gt;(</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\S</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\s</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">*?</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updatedMap</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getUpdatedJsonMap</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> string</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#4D9375;--s-light:#1E754F">await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./updated.json</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">))).</span><span style="--s-dark:#80A665;--s-light:#59873A">toString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">utf-8</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> array</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> JSON</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">parse</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">string</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æ ¹æ® json æ–‡ä»¶ç”Ÿæˆ map</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  updatedMap</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> array</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">reduce</span><span style="--s-dark:#666666;--s-light:#999999">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48">map</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    map</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updated</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> map</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  },</span><span style="--s-dark:#666666;--s-light:#999999"> {});</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {Array&lt;{ filepath: string; fileContent: string }&gt;}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> addPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">post</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">fileContent</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">test</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">fileContent</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // const updated = await getFileLastModifyDate(filepath);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ‹¿åˆ°å¯¹åº”æ–‡ä»¶çš„ updated å€¼</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updatedMap</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updated</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      continue</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">match</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#BD976A;--s-light:#B07D48">groups</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> frontMatter</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\n</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">trim</span><span style="--s-dark:#666666;--s-light:#999999">());</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dateInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">date</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // åŸåœ°æ›´æ–°</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      infoList</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // åœ¨ date å­—æ®µåæ’å…¥ updated å­—æ®µ</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">splice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">dateInfoIndex</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    newPostList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">replace</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">join</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> main</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostList</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#80A665;--s-light:#59873A"> getUpdatedJsonMap</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> addPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#80A665;--s-light:#59873A"> writePostList</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newPostList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">main</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span></code></pre><p>åˆ°è¿™é‡Œæˆ‘ä»¬å°±å®Œæˆäº†å¯¹æ‰€æœ‰çš„ <code>md</code> æ–‡ä»¶æ·»åŠ ä¸Š <code>updated</code> å­—æ®µäº†</p><p>ä½†æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œéš¾é“æˆ‘æ¯æ¬¡ä¿®æ”¹å¸–å­æäº¤ï¼Œæˆ‘éƒ½è¦è‡ªå·±å»æ”¹ <code>updated</code> å­—æ®µå—</p><p>è¿™ä¹Ÿå¤ªä¸ä¼˜é›…äº†ï¼Œä½œä¸ºä¸€ä¸ªçˆ±æäº‹çš„äººï¼Œç»ä¸ä¼šå»åšæ²¡æ„ä¹‰çš„äº‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®©å¸–å­è‡ªå·±æ›´æ–°</p><h2 id="ä½¿ç”¨-husky-æ¥è‡ªåŠ¨æ›´æ–°å¸–å­" tabindex="-1">ä½¿ç”¨ husky æ¥è‡ªåŠ¨æ›´æ–°å¸–å­ <a class="header-anchor" href="#ä½¿ç”¨-husky-æ¥è‡ªåŠ¨æ›´æ–°å¸–å­">ğŸ”—</a></h2><p>åˆšå¼€å§‹ä¹Ÿæœ‰åœ¨ç½‘ç»œä¸ŠæŸ¥æ‰¾ç›¸åº”çš„åŠæ³•ï¼Œä½†æ˜¯å…³äºè¿™ä¸ªé—®é¢˜è¿˜æ˜¯å¤ªå°‘è§£å†³æ–¹æ¡ˆäº†</p><p>æœ€åæˆ‘å†³å®šä½¿ç”¨ <code>husky</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><p><code>husky</code> æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨ <code>git</code> æ“ä½œä¸Š <code>hook</code> ä¸€äº›é€»è¾‘</p><p>æˆ‘ä»¬ä¸»è¦ä½¿ç”¨ <code>husky</code> åœ¨ <code>commit</code> å‰æ£€æµ‹ <code>add</code> çš„æ–‡ä»¶ä¸­æ˜¯å¦å«æœ‰å¸–å­ï¼Œå¦‚æœæœ‰ï¼Œè¯»å–è¿™ä¸ªå¸–å­ï¼ŒæŠŠ <code>updated</code> å­—æ®µç½®ä¸ºå½“å‰çš„æ—¶é—´ï¼Œç„¶åé‡æ–° <code>add</code> è¿›å»</p><p><code>husky</code> çš„å®˜ç½‘ <a href="https://typicode.github.io/husky/#/" target="_blank" rel="noopener">Husky - Git hooks</a></p><p>é¦–å…ˆæˆ‘ä»¬è¦å®‰è£… <code>husky</code> ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯ <code>pnpm</code>ï¼Œ å¦‚æœä½ ç”¨çš„æ˜¯ <code>npm</code> ï¼Œé‚£ä¹ˆä½¿ç”¨ <code>npm install husky --save-dev</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-text"><span class="line"><span>pnpm add husky -D</span></span></code></pre><p>å®‰è£…å®Œä¾èµ–ä¹‹åï¼Œæˆ‘ä»¬è¿˜è¦å¼€å¯ <code>git hooks</code> åŠŸèƒ½ï¼Œæ‰§è¡Œ</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-text"><span class="line"><span>pnpx husky install</span></span></code></pre><p>ç„¶åé¡¹ç›®æ ¹ç›®å½•ä¸‹å°±ä¼šå‡ºç°ä¸€ä¸ª <code>.husky</code> çš„æ–‡ä»¶å¤¹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281434119.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281434119.avif" alt=""></a></p><p>æ¥ç€æˆ‘ä»¬æ·»åŠ ä¸€ä¸ª <code>pre-commit</code> çš„ <code>hook</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-text"><span class="line"><span>pnpx husky add .husky/pre-commit "pnpm run flushPostUpdated"</span></span></code></pre><p>è¿™é‡Œè¿™ä¸ª <code>flushPostUpdated</code> å‘½ä»¤æˆ‘ä»¬è¦æ³¨å†Œåˆ° <code>package.json</code> ä¸­</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-json5"><span class="line"><span style="--s-dark:#666666;--s-light:#999999">{</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // ...</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977">  "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">scripts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">build</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">hexo generate</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">clean</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">hexo clean</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">deploy</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">hexo deploy</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">server</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">hexo server</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#C98A7D77;--s-light:#B5695977">    "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">flushPostUpdated</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">node flushPostUpdated.js</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#FDAEB7;--s-dark-font-style:italic;--s-light:#B31D28;--s-light-font-style:italic">  //</span><span style="--s-dark:#FDAEB7;--s-dark-font-style:italic;--s-light:#B31D28;--s-light-font-style:italic"> ...</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥åœ¨ <code>flushPostUpdated.js</code> é‡Œé¢å†™ä¸ª <code>hello world</code> ï¼Œç„¶åéšä¾¿ <code>add</code> ä¸€ä¸ªæ–‡ä»¶ <code>commit</code> ä¸€ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281443275.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281443275.avif" alt=""></a></p><p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶è¢«æ‰§è¡Œäº†ï¼Œæ‰“å°äº† <code>hello world</code></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åœ¨ <code>flushPostUpdated</code> è¿™ä¸ªæ–‡ä»¶å®ç°åŠŸèƒ½äº†</p><p>é¦–å…ˆæˆ‘ä»¬è¦è·å–å½“å‰ <code>git add</code> çš„æ–‡ä»¶åˆ—è¡¨</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>shelljs</code> é…ç½® <code>git status</code> å‘½ä»¤æ¥è¿›è¡Œè§£æ</p><p>ä¸€èˆ¬æˆ‘ä»¬éƒ½æ˜¯ç›´æ¥ä½¿ç”¨ <code>git status</code> æ¥æŸ¥çœ‹å½“å‰æ–‡ä»¶çš„è¿½è¸ªæƒ…å†µçš„ï¼Œå¦‚ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281521524.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281521524.avif" alt=""></a></p><p>ä½†æ˜¯è¿™ä¸ªæ ¼å¼ä¸åˆ©äºæˆ‘ä»¬åšè§£æï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é…åˆä¸€äº›å‚æ•°æ¥ç®€åŒ–è¿™äº›ä¿¡æ¯</p><p>æˆ‘ä»¬å¯ä»¥æ‰“å¼€ <a href="https://git-scm.com/docs/git-status" target="_blank" rel="noopener">Git - git-status Documentation</a> æŸ¥çœ‹æ–‡æ¡£</p><p>å…¶ä¸­ <code>--porcelain</code> ä»¥ä¾¿äºè§£æçš„æ ¼å¼è¾“å‡ºç›¸åº”çš„ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281529837.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281529837.avif" alt=""></a></p><p>è¿™ä¸ªæ ¼å¼æˆ‘ä»¬å°±éå¸¸å–œæ¬¢äº†ï¼Œåªè¦æŒ‰è¡Œå¤„ç†å³å¯</p><p>å½“ç„¶ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½æ¯ä¸ªæ–‡ä»¶ä¹‹å‰çš„ç¬¦å·ä»£è¡¨çš„æ„ä¹‰</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281530825.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281530825.avif" alt=""></a></p><p>æˆ‘ä»¬ä¾ç„¶æŸ¥çœ‹ä¸Šé¢çš„æ–‡æ¡£ï¼Œæ‹‰ä¸‹æ¥åœ¨ <code>Output</code> ä¸­ï¼Œè¯¦ç»†çš„ä¸ºæˆ‘ä»¬ä»‹ç»äº†ç¬¦å·çš„æ„ä¹‰</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281546317.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281546317.avif" alt=""></a></p><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ª <code>?</code> ä»£è¡¨æ–‡ä»¶æœªè¢«è·Ÿè¸ªï¼Œåˆ°æ—¶æˆ‘ä»¬è§£æå¯ä»¥ç›´æ¥è·³è¿‡è¿™äº›è¡Œ</p><p><code>M</code> ä»£è¡¨æ–‡ä»¶è¢«ä¿®æ”¹ï¼Œè€Œæ ¹æ®æˆ‘ä»¬è¾“å‡ºçš„å›¾æ¥çœ‹ï¼Œ <code>M</code> å¯èƒ½åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼ˆä¸Šå›¾ä¸­çš„ <code>X</code> ä½ç½®ï¼‰ï¼Œä¹Ÿå¯èƒ½åœ¨ç¬¬äºŒä¸ªå­—ç¬¦ï¼ˆä¸Šå›¾ä¸­çš„ <code>Y</code> ä½ç½®ï¼‰ï¼Œè¿™åˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢</p><p>è¿™é‡Œæˆ‘ä»¬è¦ææ˜ç™½ <code>X</code> å’Œ <code>Y</code> ä»£è¡¨çš„æ„æ€ï¼Œåœ¨è¿™æ®µæ–‡æ¡£çš„ä¸Šé¢ï¼Œè§£é‡Šäº† <code>X</code> å’Œ <code>Y</code> çš„æ„ä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥å…³æ³¨åœˆå‡ºæ¥çš„éƒ¨åˆ†</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281552526.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281552526.avif" alt=""></a></p><p><code>X</code> ä»£è¡¨äº† <code>index</code> ç´¢å¼•åŒºçš„æƒ…å†µï¼Œè€Œ <code>Y</code> ä»£è¡¨äº†å·¥ä½œåŒºçš„æƒ…å†µï¼Œæ¯å½“æˆ‘ä»¬æŠŠæ–‡ä»¶ <code>add</code> ä¹‹åï¼Œå®é™…ä¸Šæ˜¯æŠŠå·¥ä½œåŒºçš„æ–‡ä»¶å¤åˆ¶åˆ°ç´¢å¼•åŒº</p><p>æ ¹æ®æˆ‘ä»¬ä¸Šå›¾çš„è¾“å‡ºçš„ä¿¡æ¯ï¼Œæ­¤æ—¶ <code>package.json</code> æ–‡ä»¶åº”è¯¥æ˜¯åœ¨ <code>index</code> åŒºé‡Œé¢çš„ï¼Œæˆ‘ä»¬æŠŠå®ƒä» <code>index</code> åŒºåˆ é™¤å†è¾“å‡ºä¿¡æ¯çœ‹çœ‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281557231.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281557231.avif" alt=""></a></p><p>è¿™æ—¶ <code>M</code> æ ‡è®°åœ¨ <code>Y</code> ä½ç½®å±•ç¤ºäº†ï¼Œè¡¨ç¤ºå·¥ä½œåŒºå’Œç´¢å¼•åŒºçš„ <code>package.json</code> ä¸ä¸€è‡´ï¼Œè¢«æ ‡è®°ä¸ºä¿®æ”¹äº†</p><p>å…¶å®æ›´å®¹æ˜“çš„ç†è§£æ˜¯ï¼š <code>X</code> ä»£è¡¨äº† <code>index</code> åŒºå’Œå½“å‰ç‰ˆæœ¬åº“çš„å·®å¼‚ï¼Œè€Œ <code>Y</code> ä»£è¡¨äº†å·¥ä½œåŒºå’Œ <code>index</code> åŒºçš„å·®å¼‚</p><p>æˆ‘ä»¬å¯ä»¥é‡æ–°æ·»åŠ  <code>package.json</code> ï¼Œç„¶åå†ä¿®æ”¹ <code>package.json</code> çš„å†…å®¹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281601390.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281601390.avif" alt=""></a></p><p>è¿™æ—¶ä¼šå‡ºç°ä¸¤ä¸ª <code>M</code> ï¼Œæ„å‘³ç€ <code>index</code> åŒºå’Œå½“å‰çš„ç‰ˆæœ¬åº“æ–‡ä»¶ä¸ä¸€è‡´ï¼Œå·¥ä½œåŒºå’Œå½“å‰çš„ <code>index</code> åŒºæ–‡ä»¶ä¸ä¸€è‡´</p><p>ok ï¼Œæ˜ç™½äº†ä¹‹åï¼Œæˆ‘ä»¬å…¶å®è¦å¤„ç†çš„è¡Œå°±å¾ˆæ˜ç¡®äº†ï¼Œå³ <strong>X åˆ—ä¸º M çŠ¶æ€çš„å¸–å­æ–‡ä»¶</strong></p><p>æœ‰æ²¡æœ‰åŠæ³•ä¸è¾“å‡ºè¿™äº›æœªè¿½è¸ªçš„æ–‡ä»¶å‘¢ï¼Ÿ</p><p><code>git status</code> æä¾›äº† <code>--untracked-files[=&lt;mode&gt;]</code> æ¥è®©æˆ‘ä»¬èƒ½å¤Ÿé€‰æ‹©æ˜¯å¦è¾“å‡ºä¸ºè¿½è¸ªçš„æ–‡ä»¶ï¼Œå…¶ä¸­ <code>mode</code> ä¸º <code>no</code> çš„æƒ…å†µä¸‹å³å¯ä¸è¾“å‡ºæœªè¿½è¸ªçš„æ–‡ä»¶</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281611407.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281611407.avif" alt=""></a></p><p>è¿™æ ·å­å°±éå¸¸ nice äº†ï¼Œéå¸¸å¥½æ“ä½œï¼Œä½†æ˜¯è¿™ä¸ªå¸–å­çš„ä¸­æ–‡è¢«è½¬ä¹‰äº†ï¼Œè€Œä¸”è¿˜å‡ºç°äº†å¼•å·ï¼Œæœ‰ç‚¹ä¸é€‚</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281739808.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281739808.avif" alt=""></a></p><p>ä½¿ç”¨ <code>git config --global core.quotepath false</code> å…³æ‰ <code>git</code> çš„è‡ªåŠ¨è½¬ä¹‰åŠŸèƒ½ï¼Œè®°å¾—æ§åˆ¶å°ä¿æŒ <code>utf-8</code> ç¼–ç ï¼Œä¸ç„¶ä¼šä¹±ç </p><p>å†è¾“å‡ºä¸€æ¬¡å‘½ä»¤çœ‹çœ‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281741025.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/28/202207281741025.avif" alt=""></a></p><p>ç°åœ¨ä¸­æ–‡ç›´æ¥æ˜¾ç¤ºï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾ˆå¥½çš„è§£æäº†</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•ä½¿ç”¨ <code>shelljs</code> æ¥è§£æ</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">shelljs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">path</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">fs/promises</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./source/_posts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> CODE</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  SUCCESS</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  FAILURE</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 101</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">};</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string[]</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getMdFilepathList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">exec</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">git status --porcelain --untracked-files=no</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ§åˆ¶å°ä¸è¾“å‡º</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    silent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> CODE</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">SUCCESS</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    throw</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stderr</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stdout</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\n</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // ä»¥ M å¼€å¤´</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">line</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> line</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">M</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">))</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æå–æ–‡ä»¶è·¯å¾„</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">map</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">line</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">line</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">substring</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">3</span><span style="--s-dark:#666666;--s-light:#999999">)))</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // è¿‡æ»¤éç›®æ ‡ä¸‹æ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">))</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // è¿‡æ»¤é md åç¼€æ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">extname</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">.md</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#80A665;--s-light:#59873A">getMdFilepathList</span><span style="--s-dark:#666666;--s-light:#999999">());</span></span></code></pre><p>æ‰§è¡Œä¹‹åï¼Œå°±å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„æ–‡ä»¶åˆ—è¡¨äº†</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207290932798.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207290932798.avif" alt=""></a></p><p>å¾—åˆ°æ–‡ä»¶è·¯å¾„åˆ—è¡¨ä¹‹åï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯å’Œä¹‹å‰è„šæœ¬å¢åŠ  <code>updated</code> å­—æ®µçš„é€»è¾‘</p><p>é¦–å…ˆæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªå½“å‰çš„ <code>updated</code></p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">dayjs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> createCurrentUpdated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#80A665;--s-light:#59873A"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999">().</span><span style="--s-dark:#80A665;--s-light:#59873A">format</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">YYYY-MM-DD HH:mm:ss</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>ä½¿ç”¨å®ƒï¼Œå°±èƒ½è·å– <code>commit</code> æ—¶çš„æ—¶é—´å­—ç¬¦ä¸²äº†ï¼ŒæŠŠå®ƒ <code>patch</code> åˆ° <code>updated</code> å­—æ®µå³å¯</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207290936429.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207290936429.avif" alt=""></a></p><p>æ¥ç€æˆ‘ä»¬æ ¹æ®å‰é¢è·å–çš„ <code>mdFilepathList</code> æ¥è·å–æ–‡ä»¶å†…å®¹</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string[]}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> buffer</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    postList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> buffer</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">toString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">utf-8</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>è¿™ä¸ªå‡½æ•°å’Œä¹‹å‰çš„ <code>getPostList</code> é€»è¾‘æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡æˆ‘ä»¬ä½¿ç”¨äº†å‚æ•°æ¥è·å–ç‰¹å®šçš„æ–‡ä»¶</p><p>æ¥ç€æˆ‘ä»¬ä¾ç„¶ä½¿ç”¨æ­£åˆ™æ¥æ›¿æ¢ <code>updated</code> å­—æ®µ</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> REGEXP</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> /</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#666666;--s-light:#999999">(?&lt;</span><span style="--s-dark:#C98A7D;--s-light:#B56959">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">&gt;(</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\S</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\s</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">*?</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {Array&lt;{ filepath: string; fileContent: string }&gt;}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> flushPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> createCurrentUpdated</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">match</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#BD976A;--s-light:#B07D48">groups</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> frontMatter</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\n</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">trim</span><span style="--s-dark:#666666;--s-light:#999999">());</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dateInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">date</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // åŸåœ°æ›´æ–°</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      infoList</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // åœ¨ date å­—æ®µåæ’å…¥ updated å­—æ®µ</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">splice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">dateInfoIndex</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    newPostList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">replace</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\r\n</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">join</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\r\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\r\n</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p><code>patch</code> å®Œæˆä¹‹åæˆ‘ä»¬ä½¿ç”¨ä¹‹å‰çš„ <code>writePostList</code> é‡æ–°å†™å›å»</p><p>ç„¶åæˆ‘ä»¬è¦é‡æ–°æŠŠè¿™äº›æ–‡ä»¶ <code>add</code> è¿› <code>index</code> åŒº</p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string[]}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> reGitAdd</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> ((</span><span style="--s-dark:#BD976A;--s-light:#B07D48">result</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">exec</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">git add </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">filepath</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">)).</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> CODE</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">SUCCESS</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      throw</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stderr</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><p>è¿™æ ·å­æˆ‘ä»¬å°±å®Œæˆäº†æ•´ä¸ªé€»è¾‘çš„ç¼–å†™</p><p>ç„¶åæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹æ•ˆæœï¼Œæˆ‘ä»¬å…ˆæŠŠæ–‡ä»¶çš„ <code>updated</code> å­—æ®µæ”¹æˆ <code>1999-01-01 00:00:00</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291012738.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291012738.avif" alt=""></a></p><p>æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆä¸ä½¿ç”¨ <code>pre-commit</code> é’©å­ï¼Œå¯ä»¥å…ˆæ³¨é‡Šæ‰ï¼Œå¦‚ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291037819.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291037819.avif" alt=""></a></p><p>ç„¶åæˆ‘ä»¬ <code>add</code> è¿›å»ï¼Œç„¶åæäº¤ä¸€ä¸ª <code>commit</code> ï¼Œç¡®ä¿æˆ‘ä»¬çš„ç‰ˆæœ¬åº“é‡Œé¢çš„æ—¥æœŸæ˜¯ <code>1999-01-01 00:00:00</code></p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291040787.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291040787.avif" alt=""></a></p><p>ç„¶åæˆ‘ä»¬æ‰“å¼€ <code>pre-commit</code> é’©å­ï¼Œéšä¾¿æ›´æ”¹ä¸€ä¸‹å†…å®¹ï¼Œå†æ¬¡æäº¤</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291042325.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291042325.avif" alt=""></a></p><p>æˆåŠŸçš„å˜ä¸ºå½“å‰çš„æ—¶é—´ï¼Œå¹¶ä¸”æ­¤æ—¶æ˜¯å·²ç» <code>commit</code> çš„äº†</p><hr><p>åˆ°è¿™é‡Œæˆ‘ä»¬åŸºæœ¬å®Œæˆäº†æ•´ä¸ªæµç¨‹ï¼Œç°åœ¨æˆ‘ä»¬åªç®¡æ›´æ–°æ–‡ç« çš„å†…å®¹ï¼Œæ›´æ–° <code>updated</code> å­—æ®µäº¤ç»™äº†è„šæœ¬</p><p>å¤§å¤§åœ°å‡å°‘äº†å¿ƒæ™ºè´Ÿæ‹…ï¼Œåˆå¯ä»¥æ„‰å¿«åœ°å†™å¸–å­äº†</p><p>ä½†æ˜¯åˆ°è¿™é‡Œå°±ç»“æŸäº†å—ï¼Œä¸ä¸€å®š</p><h2 id="extra" tabindex="-1">extra <a class="header-anchor" href="#extra">ğŸ”—</a></h2><p>å½“ç„¶ä»¥ä¸‹éƒ¨åˆ†ä¸ºæ‰©å±•éƒ¨åˆ†ï¼Œæˆ‘è§‰å¾—å¤§éƒ¨åˆ†äººç”¨ä¸Šé¢çš„æ–¹å¼å³å¯ï¼Œæ²¡å¿…è¦æå¤ªå¤æ‚</p><p>ç°åœ¨æˆ‘ä»¬æ¥å¤ç°ä¸€ä¸‹ä¸€ä¸ªåœºæ™¯</p><p>å°æ—æ­£åœ¨å†™ä¸€ç¯‡å¸–å­ï¼Œå¸–å­åä¸º <code>ä½¿ç”¨ husky æ¥ä¸ºå¸–å­å¢åŠ æ›´æ–°æ—¶é—´</code></p><p>å†™å®Œäº†å¸–å­ï¼Œå°æ—å¼€å¿ƒçš„æŠŠå¸–å­ <code>add</code> åˆ° <code>index</code> åŒºï¼Œå‡†å¤‡ <code>commit</code> ç„¶å <code>push</code> åˆ° <code>Github</code> ä¸Š</p><p>è¿™æ—¶å€™å°æ—çš„è€å¦ˆå¤§å–Šäº†ä¸€å£°ï¼šâ€œå­©å„¿ï¼Œå»æŠŠæ´—å¥½çš„è¡£æœå‡‰ä¸€ä¸‹â€</p><p>å°æ—æƒ³ç€ï¼Œæ—¢ç„¶ <code>add</code> äº†ï¼Œæ™šç‚¹ <code>commit</code> ä¹Ÿæ²¡äº‹ï¼Œå°±å»æ™¾è¡£æœäº†</p><p>å›æ¥çš„æ—¶å€™ï¼Œå°æ—æŠŠä¸€äº›é¢å¤–çš„éƒ¨åˆ†å†™è¿›äº†å¸–å­ï¼Œè¿˜æ²¡å†™å®Œçªç„¶æƒ³èµ·ä¹‹å‰çš„ç‰ˆæœ¬å¿˜è®°äº† <code>commit</code></p><p>è¯•é—®ï¼šå¦‚æœè¿™ä¸ªæ—¶å€™ <code>commit</code> ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µ</p><p>æ²¡é”™ï¼Œè¿˜æ²¡ <code>add</code> è¿› <code>index</code> åŒºçš„éƒ¨åˆ†ä¼šè¢«ä¸€åŒæäº¤åˆ°ç‰ˆæœ¬åº“</p><p>å› ä¸ºåœ¨é’©å­ä¸­ï¼Œæˆ‘ä»¬çš„é€»è¾‘å°±æ˜¯ <code>patch</code> å¤´éƒ¨çš„ <code>updated</code> å­—æ®µï¼Œç„¶åé‡æ–° <code>git add</code></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ­¤æ—¶æ–‡ä»¶çš„ <code>X</code> å’Œ <code>Y</code> éƒ½æ˜¯ <code>M</code> æ ‡å¿—çš„è¯ï¼Œä¼šå‡ºç°ä¸€äº›çŸ›ç›¾</p><p>å³æˆ‘ä»¬ <code>git add</code> çš„æ–‡ä»¶æ˜¯å½“å‰å·¥ä½œåŒºçš„æ–‡ä»¶ï¼Œè€Œå·¥ä½œåŒºçš„æ–‡ä»¶å­˜åœ¨å¦å¤–çš„æ›´æ–°</p><p>é‚£æˆ‘ä»¬æ”¹å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><p>åˆšå¼€å§‹çš„æ—¶å€™æˆ‘æ˜¯æƒ³åƒ <code>VSCode</code> é‚£æ ·ï¼Œé€‰ä¸­æŸäº›è¡Œæ¥è¿›è¡Œå±€éƒ¨ <code>add</code> çš„ï¼Œä½†æ˜¯å®åœ¨æ˜¯æ²¡ææ‡‚</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291531076.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291531076.avif" alt=""></a></p><p>ä¹‹åï¼Œæˆ‘å°±æƒ³äº†ä¸€ä¸ªæ¯”è¾ƒç¬¨çš„åŠæ³•ï¼Œè¿™ä¸ªç¬¨æ–¹æ³•çš„æ­¥éª¤æ˜¯ï¼š</p><ul><li>æŠŠå½“å‰å·¥ä½œåŒºçš„æ–‡ä»¶å¤‡ä»½</li><li>å¯¹å½“å‰å·¥ä½œåŒºçš„å¤‡ä»½æ–‡ä»¶ <code>patch</code> å®ƒçš„ <code>updated</code> å­—æ®µ</li><li>æŠŠ <code>index</code> åŒºçš„æ–‡ä»¶å†™å›å·¥ä½œåŒº</li><li>å¯¹å½“å‰å·¥ä½œåŒºçš„æ–‡ä»¶ <code>patch</code> å®ƒçš„ <code>updated</code> å­—æ®µ</li><li><code>git add</code> å½“å‰å·¥ä½œåŒºçš„æ–‡ä»¶</li><li>æŠŠå¤‡ä»½æ–‡ä»¶å†™å›åŸæ¥çš„ä½ç½®</li><li>åˆ é™¤å¤‡ä»½æ–‡ä»¶</li></ul><p>å…¶ä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æ­¥éª¤æ˜¯ï¼š<strong>æŠŠ <code>index</code> åŒºçš„æ–‡ä»¶å†™å›å·¥ä½œåŒº</strong></p><p>è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»çŸ¥é“å½“å‰åœ¨ <code>index</code> åŒºçš„æ–‡ä»¶é•¿ä»€ä¹ˆæ ·</p><p>è¿™é‡Œå¯ä»¥ä½¿ç”¨ <code>git show ":æ–‡ä»¶å"</code> è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹ï¼ˆ<s>åˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„ï¼Œæˆ‘ç™¾åº¦çš„</s></p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ <code>shelljs</code> æ‰§è¡Œç„¶åè·å–å†…å®¹äº†</p><p>å…¶ä»–çš„æ­¥éª¤å…¶å®å¾ˆç®€å•ï¼Œæ–‡ä»¶æ‹·æ¥æ‹·å»è€Œå·²</p><p>è¿™é‡Œæ”¾ä¸‹å®Œæ•´çš„ä»£ç </p><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// flushPostUpdated.js</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">shelljs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">path</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">fs/promises</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  writePostList</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34"> </span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  gitAdd</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34"> </span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  createCurrentUpdated</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34"> </span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  POST_META_REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34"> </span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#DBD7CAEE;--s-light:#393A34"> </span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  SHELLJS_CODE</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./util</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * æ ¹æ® index åŒºçš„ä¿¡æ¯è§£æéœ€è¦å¤„ç†çš„æ–‡ä»¶åˆ—è¡¨</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Array&lt;{ X: string, Y: string; path: string; filepath: string }&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getMdFilepathList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">exec</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">git status --porcelain --untracked-files=no</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ§åˆ¶å°ä¸è¾“å‡º</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">    silent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  });</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> SHELLJS_CODE</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">SUCCESS</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    throw</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stderr</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stdout</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\n</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">line</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> line</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">M</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">))</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">map</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">line</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> ({</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      X</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> line</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">0</span><span style="--s-dark:#666666;--s-light:#999999">],</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      Y</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> line</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">],</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      path</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> line</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">substring</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">3</span><span style="--s-dark:#666666;--s-light:#999999">),</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">line</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">substring</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">3</span><span style="--s-dark:#666666;--s-light:#999999">))</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }))</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(({</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">})</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">))</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(({</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">})</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">extname</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">.md</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * è·å–åœ¨ index åŒºæŒ‡å®šè·¯å¾„çš„æ–‡ä»¶åˆ—è¡¨</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string[]}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostListInIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">exec</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">git show ":</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">filepath</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">"</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      silent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> SHELLJS_CODE</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">SUCCESS</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      throw</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stderr</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    postList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stdout</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * è·å–å·¥ä½œåŒºåŒºæŒ‡å®šè·¯å¾„çš„æ–‡ä»¶åˆ—è¡¨</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string[]}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> buffer</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    postList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> buffer</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">toString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">utf-8</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">),</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * æ‹·è´æ–‡ä»¶åˆ—è¡¨ï¼Œè¿”å›æ‹·è´åçš„æ–‡ä»¶ååˆ—è¡¨</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> mdFilepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {Array&lt;{filepath: string}&gt;}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;string&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> backupMdFile</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">mdFilepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> list</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> mdFilepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dir</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">dirname</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> destFilename</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">basename</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">.pre-commit</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">extname</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> destFilepath</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">dir</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> destFilename</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">copyFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> destFilepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">backup md, source file: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">filepath</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D;--s-light:#B56959">, backup file: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">destFilepath</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    list</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">destFilepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> list</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * æ›´æ–°å¸–å­å…ƒæ•°æ®åŒºåŸŸçš„ updated å­—æ®µï¼Œ updated å€¼ä¸ºå½“å‰æ—¶é—´ï¼Œä¸»è¦ç”¨äº pre-commit é’©å­</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {Array&lt;{ filepath: string; fileContent: string }&gt;}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> flushPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> createCurrentUpdated</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">patching filepath: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">filepath</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">match</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_META_REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#BD976A;--s-light:#B07D48">groups</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> frontMatter</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">split</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\n</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\r\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">      .</span><span style="--s-dark:#80A665;--s-light:#59873A">filter</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !!</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">trim</span><span style="--s-dark:#666666;--s-light:#999999">());</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dateInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">date</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">findIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">startsWith</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999"> &gt;</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> -</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">1</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // åŸåœ°æ›´æ–°</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      infoList</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updatedInfoIndex</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> else</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">      // åœ¨ date å­—æ®µåæ’å…¥ updated å­—æ®µ</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">splice</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">dateInfoIndex</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 1</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated: </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">updated</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    newPostList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">replace</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_META_REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> `</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">join</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C99076;--s-light:#A65E2B">\n</span><span style="--s-dark:#C98A7D;--s-light:#B56959">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * å¤‡ä»½çš„æ–‡ä»¶è¦†ç›–åˆ°åŸæ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string[]}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;void&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> recoveryMdList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dir</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">dirname</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> backupFilepath</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">dir</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">basename</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> '</span><span style="--s-dark:#C98A7D;--s-light:#B56959">.pre-commit</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> +</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">extname</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> sourceFilepath</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">copyFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">backupFilepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> sourceFilepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * åˆ é™¤å¤‡ä»½æ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string[]}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;void&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> deleteBackupMdList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">rm</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> main</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> mdFileList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> getMdFilepathList</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  if</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">mdFileList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> ===</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">no md file need to patch.</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">will patch count: </span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> mdFileList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">length</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æ‹·è´ä¸€ä»½å¤‡ä»½æ–‡ä»¶ï¼Œpatch å¤´éƒ¨çš„ updated å­—æ®µ</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> backupMdList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> backupMdFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">mdFileList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> backupPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostList</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">backupMdList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newBackupPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> flushPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">backupPostList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#80A665;--s-light:#59873A"> writePostList</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newBackupPostList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">backup success.</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // æå–ç´¢å¼•åŒºå†…çš„æ–‡ä»¶ï¼Œpatch å¤´éƒ¨çš„ updatedï¼Œå†™å›å·¥ä½œåŒºï¼Œç„¶å add</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostListInIndex</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">mdFileList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">map</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">file</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> file</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">path</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> newPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#80A665;--s-light:#59873A"> flushPostUpdated</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#80A665;--s-light:#59873A"> writePostList</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newPostList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">  gitAdd</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newPostList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">map</span><span style="--s-dark:#666666;--s-light:#999999">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48">post</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">patch success.</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">  // add ä¹‹åï¼ŒæŠŠå¤‡ä»½æ–‡ä»¶é‡æ–°æ”¾åˆ°å·¥ä½œåŒºä¸­</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#80A665;--s-light:#59873A"> recoveryMdList</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">newPostList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">map</span><span style="--s-dark:#666666;--s-light:#999999">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48">post</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">))</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">recovery md success.</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#80A665;--s-light:#59873A"> deleteBackupMdList</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">backupMdList</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  console</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">log</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">delete backup success.</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#80A665;--s-light:#59873A">main</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span></code></pre><pre class="shiki shiki-themes vitesse-dark vitesse-light" style="--s-dark:#dbd7caee;--s-light:#393a34;--s-dark-bg:#121212;--s-light-bg:#ffffff" tabindex="0"><code class="language-javascript"><span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">// util.js</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">shelljs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">fs/promises</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">path</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> require</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">dayjs</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * å¸–å­å­˜æ”¾æ–‡ä»¶å¤¹è·¯å¾„</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">type</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./source/_posts</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * å¸–å­é¡¶éƒ¨å…ƒæ•°æ®åŒºåŸŸæ­£åˆ™</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">type</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">RegExp</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> POST_META_REGEXP</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> /</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#666666;--s-light:#999999">(?&lt;</span><span style="--s-dark:#C98A7D;--s-light:#B56959">frontMatter</span><span style="--s-dark:#666666;--s-light:#999999">&gt;(</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\S</span><span style="--s-dark:#CB7676;--s-light:#AB5959">|</span><span style="--s-dark:#6872AB;--s-light:#5A6AA6">\s</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#4C9A91;--s-light:#2F798A">*?</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#C4704F;--s-light:#AB5E3F">---</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">/</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * shelljs è¿”å›ç </span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">type</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">{SUCCESS: number, FAILURE: number}</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> SHELLJS_CODE</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  SUCCESS</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 0</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">  FAILURE</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4C9A91;--s-light:#2F798A"> 101</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">};</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * è¯»å–å¸–å­åˆ—è¡¨</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;Array&lt;{ filepath: string; fileContent: string }&gt;&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getPostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filenameList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readdir</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filename</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filenameList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">join</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filename</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> buffer</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    postList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#B8A965;--s-light:#998418"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> buffer</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">toString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">utf-8</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">)</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * å†™å…¥å¸–å­åˆ—è¡¨</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {Array&lt;{ filepath: string; fileContent: string }&gt;}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;void&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> writePostList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> postList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">}</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> post</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">writeFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileContent</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * å¾—åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ updated.json ï¼Œè½¬ä¸º map(filepath -&gt; updated)</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;{[filepath: string]: string}&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> getUpdatedJsonMap</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./updated.json</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  try</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">access</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> catch</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">e</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">    // æ–‡ä»¶ä¸å­˜åœ¨</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#666666;--s-light:#999999"> {};</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> string</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#4D9375;--s-light:#1E754F">await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readFile</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">)).</span><span style="--s-dark:#80A665;--s-light:#59873A">toString</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">utf-8</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> array</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> JSON</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">parse</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">string</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> array</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">reduce</span><span style="--s-dark:#666666;--s-light:#999999">((</span><span style="--s-dark:#BD976A;--s-light:#B07D48">map</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    map</span><span style="--s-dark:#666666;--s-light:#999999">[</span><span style="--s-dark:#BD976A;--s-light:#B07D48">item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">]</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> item</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">updated</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    return</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> map</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  },</span><span style="--s-dark:#666666;--s-light:#999999"> {});</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * ä¿å­˜å¸–å­çš„æœ€åä¸€æ¬¡ä¿®æ”¹æ—¥æœŸåˆ°é¡¹ç›®æ ¹ç›®å½•çš„ updated.json æ–‡ä»¶</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">Promise&lt;void&gt;</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> saveUpdatedJson</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> async</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filenameList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">readdir</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileHandler</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">open</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">./updated.json</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977"> "</span><span style="--s-dark:#C98A7D;--s-light:#B56959">w+</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">  const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> infoList</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> [];</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filename</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filenameList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> path</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">resolve</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filename</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileStat</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fsPromise</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">stat</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepath</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#80A665;--s-light:#59873A"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">fileStat</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">mtime</span><span style="--s-dark:#666666;--s-light:#999999">).</span><span style="--s-dark:#80A665;--s-light:#59873A">format</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#C98A7D;--s-light:#B56959">YYYY-MM-DD HH:mm:ss</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">"</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">    infoList</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">push</span><span style="--s-dark:#666666;--s-light:#999999">({</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">      filepath</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> updated</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    });</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileHandler</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">write</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">JSON</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">stringify</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#BD976A;--s-light:#B07D48">infoList</span><span style="--s-dark:#666666;--s-light:#999999">));</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  await</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> fileHandler</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">close</span><span style="--s-dark:#666666;--s-light:#999999">();</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">param</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> {string[]}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> gitAdd</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#BD976A;--s-light:#B07D48">filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  for</span><span style="--s-dark:#666666;--s-light:#999999"> (</span><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepath</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> of</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> filepathList</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">    let</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">    if</span><span style="--s-dark:#666666;--s-light:#999999"> ((</span><span style="--s-dark:#BD976A;--s-light:#B07D48">result</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> shelljs</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#80A665;--s-light:#59873A">exec</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#C98A7D;--s-light:#B56959">git add </span><span style="--s-dark:#4D9375;--s-light:#1E754F">${</span><span style="--s-dark:#C98A7D;--s-light:#B56959">filepath</span><span style="--s-dark:#4D9375;--s-light:#1E754F">}</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">`</span><span style="--s-dark:#666666;--s-light:#999999">,</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">      silent</span><span style="--s-dark:#666666;--s-light:#999999">:</span><span style="--s-dark:#4D9375;--s-light:#1E754F"> true</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    })).</span><span style="--s-dark:#BD976A;--s-light:#B07D48">code</span><span style="--s-dark:#CB7676;--s-light:#AB5959"> !==</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> SHELLJS_CODE</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">SUCCESS</span><span style="--s-dark:#666666;--s-light:#999999">)</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">      throw</span><span style="--s-dark:#BD976A;--s-light:#B07D48"> result</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#BD976A;--s-light:#B07D48">stderr</span><span style="--s-dark:#666666;--s-light:#999999">;</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">    }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">  }</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0">/**</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * åˆ›å»ºä¸€ä¸ªå½“å‰æ—¶é—´çš„ updated å€¼</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> * </span><span style="--s-dark:#666666;--s-light:#999999">@</span><span style="--s-dark:#4D9375;--s-light:#1E754F">returns</span><span style="--s-dark:#666666;--s-light:#999999"> {</span><span style="--s-dark:#5DA994;--s-light:#2E8F82">string</span><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"><span style="--s-dark:#758575DD;--s-light:#A0ADA0"> */</span></span>
<span class="line"><span style="--s-dark:#CB7676;--s-light:#AB5959">const</span><span style="--s-dark:#80A665;--s-light:#59873A"> createCurrentUpdated</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> ()</span><span style="--s-dark:#666666;--s-light:#999999"> =&gt;</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#4D9375;--s-light:#1E754F">  return</span><span style="--s-dark:#80A665;--s-light:#59873A"> dayjs</span><span style="--s-dark:#666666;--s-light:#999999">().</span><span style="--s-dark:#80A665;--s-light:#59873A">format</span><span style="--s-dark:#666666;--s-light:#999999">(</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#C98A7D;--s-light:#B56959">YYYY-MM-DD HH:mm:ss</span><span style="--s-dark:#C98A7D77;--s-light:#B5695977">'</span><span style="--s-dark:#666666;--s-light:#999999">);</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span>
<span class="line"></span>
<span class="line"><span style="--s-dark:#B8A965;--s-light:#998418">module</span><span style="--s-dark:#666666;--s-light:#999999">.</span><span style="--s-dark:#B8A965;--s-light:#998418">exports</span><span style="--s-dark:#666666;--s-light:#999999"> =</span><span style="--s-dark:#666666;--s-light:#999999"> {</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  getPostList</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  writePostList</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  getUpdatedJsonMap</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  gitAdd</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  createCurrentUpdated</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  saveUpdatedJson</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  POST_META_REGEXP</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  POST_LIST_DIR</span><span style="--s-dark:#666666;--s-light:#999999">,</span></span>
<span class="line"><span style="--s-dark:#BD976A;--s-light:#B07D48">  SHELLJS_CODE</span></span>
<span class="line"><span style="--s-dark:#666666;--s-light:#999999">}</span></span></code></pre><h1 id="åè®°" tabindex="-1">åè®° <a class="header-anchor" href="#åè®°">ğŸ”—</a></h1><p>è™½ç„¶è¿‡ç¨‹æ›²æŠ˜ï¼Œä½†ç»ˆç©¶å®ç°äº†è‡ªåŠ¨æ›´æ–°å¸–å­ <code>updated</code> å­—æ®µçš„åŠŸèƒ½ï¼Œå•å•ä¾é æ–‡ä»¶çš„ä¿¡æ¯ç¡®å®ä¸æ˜¯å¾ˆå‡†ç¡®</p><p>æƒ³äº†ä¸‹ï¼Œåšå¤‡ä»½çš„è¯ï¼Œæ„Ÿè§‰å¯ä»¥ç”¨ <code>stash</code> æ¥æï¼Œéƒ¨åˆ†æ–‡ä»¶ <code>stash push</code> ï¼Œç„¶åéƒ¨åˆ†æ–‡ä»¶ <code>stash pop</code></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>git</code> æ“ä½œæŒ‡å®šæ’¤é”€ <code>index</code> åŒºçš„æ–‡ä»¶ï¼Œå¦‚ä¸‹</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291601767.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291601767.avif" alt=""></a></p><p>è¿™æ ·çœ‹èµ·æ¥ä¼¼ä¹æ›´ç®€å•ä¸€ç‚¹</p><p>è¿˜æœ‰ä¼˜åŒ–ç©ºé—´ï¼Œä½†æ˜¯â€¦</p><p><a data-fancybox="doc-gallery" href="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291609686.avif" target="_blank" rel="noopener noreferrer"><img src="https://fastly.jsdelivr.net/gh/Dedicatus546/image@main/2022/07/29/202207291609686.avif" alt=""></a></p><p>è™½ç„¶è§£å†³äº†é—®é¢˜ï¼Œå¯æ˜¯æˆ‘ä¹‹å‰å¸–å­çš„æ›´æ–°æ—¶é—´éƒ½ä¸è§äº†ï¼Œæˆ‘ TM â€¦</p></div><!--]--></div><div flex="~ wrap" text="[var(--mygo-c-text-2)]" mt-8="" gap-4="" justify-center=""><!--[--><div>#Hexo</div><div>#Next</div><div>#Nodejs</div><div>#JavaScript</div><div>#Husky</div><div>#Git</div><!--]--></div><!--]--></div></div><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="~ wrap" gap-4=""><a href="/992fb248bc26" class="" truncate="" title="2022å¹´7æœˆæ–°ç•ªä¸ªäººæ¨è"><i class="i-mi:chevron-left" mr-1=""></i><span>2022å¹´7æœˆæ–°ç•ªä¸ªäººæ¨è</span></a><a href="/da3fa0a6f13c" class="" ml-auto="" truncate="" title="ä¸€ä¸ªæ›¿æ¢ cdn å‰ç¼€çš„å°å·¥å…·"><span>ä¸€ä¸ªæ›¿æ¢ cdn å‰ç¼€çš„å°å·¥å…·</span><i class="i-mi:chevron-right" ml-1=""></i></a></div><!--]--></div></div><!--[--><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" data-v-f3312cf8="" data-v-7ac4adc5=""><div class="p-4 lg:p-8" data-v-7ac4adc5=""><!--[--><div flex="" gap-4="" items-start="" data-v-f3312cf8=""><div flex="~ shrink-0" bg="[var(--mygo-c-bg-alt)]" rounded-6px="" w-60px="" aspect-ratio-square="" items-center="" justify-center="" data-v-f3312cf8=""><i text-40px="" text="[#999]" class="i-fa6-regular:user" data-v-f3312cf8=""></i></div><div flex="~ col grow" gap-2="" lg:gap-4="" data-v-f3312cf8=""><textarea disabled="" placeholder="ä¸‡æ°´åƒå±±æ€»æ˜¯æƒ…ï¼Œç•™ä¸‹è¯„è®ºè¡Œä¸è¡Œ" class="mujika-git-talk-textarea" un-disabled:cursor-not-allowed="" p-2="" outline-0="" lg:p-4="" data-v-f3312cf8=""></textarea><div flex="" items-start="" data-v-f3312cf8=""><a target="_blank" href="https://guides.github.com/features/mastering-markdown/" data-v-f3312cf8="">æ”¯æŒ Markdown è¯­æ³•</a><div ml-auto="" data-v-f3312cf8=""></div><!----><button class="mujika-button" data-v-f3312cf8="" data-v-15330f5f=""><!--[--><!--]--><!--[-->ç‚¹å‡»ç™»å½•<!--]--></button></div></div></div><!--]--></div></div><!----><!--]--></div><aside class="mujika-aside" w="280px" flex="~ col shrink-0" top-2="" sticky="" max-h="[calc(100vh-var(--spacing)*4)]" un-hidden="" lg:block=""><div class="mujika-card mujika-card--hover mujika-card--border" w-full="" overflow-auto="" flex="~ col" gap-4="" data-v-7ac4adc5=""><!--[--><div p="4 b-0" flex-shrink-0="">æ–‡ç« ç›®å½•</div><div p="4 t-0" flex-grow="" min-h-0="" overflow-y-auto=""><!----></div><!--]--></div></aside><!--teleport start--><!--teleport end--></div></main><footer class="mujika-footer" px-4="" py-6="" bg="[var(--mygo-c-bg)]" flex="~ col shrink-0" gap-2="" items-center="" data-v-d1d7a153=""><div flex="" items-center="" data-v-d1d7a153=""><span data-v-d1d7a153="">Power by&nbsp;</span><i class="i-logos:vue" data-v-d1d7a153=""></i><span data-v-d1d7a153="">&nbsp;+&nbsp;</span><i class="i-logos:vitejs" data-v-d1d7a153=""></i></div><div text-center="" data-v-d1d7a153=""><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" data-v-d1d7a153="">CC BY-NC-SA 4.0 </a>2021 - PRESENT Â© Dedicatus545</div><div text="[var(--mygo-c-text-2)]" text-center="" data-v-d1d7a153="">å¦‚æœæˆ‘å’Œç‹—ä¸€æ ·æœ‰å°¾å·´çš„è¯ï¼Œä¸€å®šä¼šè—ä¸ä½è¿™ä»½å–œæ‚¦ï¼Œè€Œå°¾å·´ä¸€ç›´æ‘‡ä¸ªä¸åœå§ã€‚</div></footer></div></div></body></html>